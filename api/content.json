{
    "code": 10000,
    "data": {
        "home": "laravel-repository\n==================\n\n![Progress](http:\/\/progressed.io\/bar\/100?title=completed) \n[![Latest Stable Version](https:\/\/poser.pugx.org\/littlebug\/laravel-repository\/v\/stable)](https:\/\/packagist.org\/packages\/littlebug\/laravel-repository)[![Total Downloads](https:\/\/poser.pugx.org\/littlebug\/laravel-repository\/downloads)](https:\/\/packagist.org\/packages\/littlebug\/laravel-repository)[![Latest Unstable Version](https:\/\/poser.pugx.org\/littlebug\/laravel-repository\/v\/unstable)](https:\/\/packagist.org\/packages\/littlebug\/laravel-repository)[![License](https:\/\/poser.pugx.org\/littlebug\/laravel-repository\/license)](https:\/\/packagist.org\/packages\/littlebug\/laravel-repository)[![GitHub stars](https:\/\/img.shields.io\/github\/stars\/Wanchaochao\/laravel-repository.svg)](https:\/\/github.com\/Wanchaochao\/laravel-repository\/stargazers)[![GitHub issues](https:\/\/img.shields.io\/github\/issues\/Wanchaochao\/laravel-repository.svg)](https:\/\/github.com\/Wanchaochao\/laravel-repository\/issues)[![GitHub forks](https:\/\/img.shields.io\/github\/forks\/Wanchaochao\/laravel-repository.svg)](https:\/\/github.com\/Wanchaochao\/laravel-repository\/network)[![Laravel](https:\/\/img.shields.io\/badge\/Laravel%20%5E5.5-support-brightgreen.svg)](https:\/\/github.com\/laravel\/laravel)\n\n## Introduction\n\n`laravel-repository` provides the basic `repository` class for [laravel](https:\/\/laravel.com\/)[model](https:\/\/learnku.com\/docs\/laravel\/5.5\/eloquent\/1332) The package was made to provide more\nMore external methods, and more friendly editor prompts; layering the code, `repository` is \nresponsible for external business logic processing, `model` is only responsible for the definition \nof the fields, attributes, query conditions, and return values of the data table. It does not \nparticipate in specific logical operations, and does not serve the control layer.\n\n\n### Relative to the direct use of `model` advantages:\n\n- Solve the problem that `model` does not automatically handle extra fields when adding or modifying\n- Optimize chained calls for `model` queries, query directly using arrays\n- Automatically process corresponding associated data queries through query conditions and query fields\n- Provides a more friendly editor prompt\n\n## Install\n\n### Installation requirements\n\n- PHP >= 7.0.0\n- Laravel >= 5.5.0\n\n### 1.1 Install package\n\n```bash\ncomposer require littlebug\/laravel-repository:2.0.*\n```\nor add this to require section in your composer.json file:\n\n```bash\n\"littlebug\/laravel-repository\": \"2.0.*\"\n```\nthen run composer update\n\n### 1.2 Use the command to generate `model` and `repository`\n\nSuppose you have users in your database, or you replace users with the table names in your database.\n\n```bash\nphp artisan core:model --table=users --name=User\n```\nThe command will be at:\n\n- Generate `User` file under `app\/Models\/` file\n- Generate `UserRepository` file under `app\/Repositories\/` file\n\n### 1.3 Using `repository` in the controller\n\n```php\n<?php\n\nuse Illuminate\\Routing\\Controller;\nuse Littlebug\\Repository\\Tests\\Stubs\\UserRepository;\n\nclass UsersController extends Controller \n{\n    \/**\n     * @var UserRepository\n     *\/\n    private $userRepository;\n    \n    public function __construct(UserRepository $userRepository)\n    {\n        $this->userRepository = $userRepository;\n    }\n    \n    public function index()\n    {\n        \/\/ Paging queries, returning paging objects\n        $paginate = $this->userRepository->paginate([\n            'name:like' => 'test', \n            'status'    => [1, 2], \/\/ Automatically converts to an in query\n        ]);\n        \n        return view('users.index', compact('paginate'));\n    }\n    \n    public function create()\n    {\n        \/\/ Add data and return an array\n        $user = $this->userRepository->create(request()->all());\n        dump($user);\n    }\n    \n    public function update()\n    {\n        \/\/ Modify the data and return the number of modified rows\n        $row = $this->userRepository->update(request()->input('id'), request()->all());\n        dump($row);\n    }\n    \n    public function delete()\n    {\n        \/\/ Deletes data and returns the number of rows deleted\n        $row = $this->userRepository->delete(request()->input('id'));\n        dump($row);\n    }\n}\n\n```\n\nIn addition to the injection method invocation described above, you can also use static method invocation; As follows:\n\n```php\nuse Littlebug\\Repository\\Tests\\Stubs\\UserRepository;\n\n$paginate = UserRepository::instance()->paginate(['status' => 1]);\n\n\/\/ Query a piece of data and return an array\n$user = UserRepository::instance()->find(['status' => 1, 'id:gt' => 2]);\n```\n### 1.4 Other common methods\n\n#### Retrieve the data\n\n| method name | return value | description|\n|-------------|------|------------------|\n| `find($conditions, $columns = ['*'])` | `null\\|array`|Querying individual data|\n| `findBy($conditions, $column)` | `null\\|mixed`|Query a single field for a single piece of data|\n| `findAll($conditions, $columns = ['*])` | `array`|Query multiple data|\n| `findAllBy($conditions, $column)` | `array`|Querying a single field array of multiple data|\n| `first($conditions, $column)` | `null\\|model`|Retrieve a single model|\n| `get($conditions, $column)` | `Collection`|Retrieve the collection|\n\n#### Statistical query\n\n| method name | return value | description|\n|-------------|------|------------------|\n| `count($conditions, $column = '*')` | `int`|The number of statistical|\n| `max($conditions, $column)` | `mixed`|The maximum|\n| `min($conditions, $column)` | `mixed`|The minimum value|\n| `avg($conditions, $column)` | `mixed`|The average|\n| `sum($conditions, $column)` | `mixed`|sum|\n\n#### Create or modify data\n\n| method name | return value | description|\n|-------------|------|------------------|\n| `increment($conditions, $column, $amount = 1, $extra = [])` | `int` | Since the increase|\n| `decrement($conditions, $column, $amount = 1, $extra = [])` | `int` | Since the reduction of|\n| `firstOrCreate(array $attributes, array $value = [])` | `model` |The query does not exist so create|\n| `updateOrCreate(array $attributes, array $value = [])` | `model` |Modifications do not exist so create|\n\n### 1.5 More documentation\n\n[Please check more about `repository`](https:\/\/wanchaochao.github.io\/laravel-repository\/?page=repository)\n\n## More code generation commands\n\n> Commands support specifying database connections such as --table=dev.users\n\n1. `core:model` generates `model` class files and `repository` class files by querying database table information.\n\n    ```bash\n    php artisan core:model --table=users --name=User\n    ```\n\n2. `core:repository` generates the `repository` class file\n\n    ```bash\n    php artisan core:repository --model=User --name=UserRepository\n    ```\n\n3. `core:request` generates `request` verification class file by querying database table information\n\n    ```bash\n    php artisan core:request --table=users --path=Users\n    ```\n\n### Command Parameter Details\n\n![commands of generate code](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/commands-en.png 'core of commands')\n\n#### thanks for [jinxing.liu](https:\/\/mylovegy.github.io\/blog\/) and seven ğŸ’ğŸŒ¹\n\n#### if my repository is helpful to you, give me a star to encourage me~ âœ¨, I will continue to maintain this project.",
        "home.zh-CN": "laravel-repository\n==================\n\n![Progress](http:\/\/progressed.io\/bar\/100?title=completed) \n[![Latest Stable Version](https:\/\/poser.pugx.org\/littlebug\/laravel-repository\/v\/stable)](https:\/\/packagist.org\/packages\/littlebug\/laravel-repository)[![Total Downloads](https:\/\/poser.pugx.org\/littlebug\/laravel-repository\/downloads)](https:\/\/packagist.org\/packages\/littlebug\/laravel-repository)[![Latest Unstable Version](https:\/\/poser.pugx.org\/littlebug\/laravel-repository\/v\/unstable)](https:\/\/packagist.org\/packages\/littlebug\/laravel-repository)[![License](https:\/\/poser.pugx.org\/littlebug\/laravel-repository\/license)](https:\/\/packagist.org\/packages\/littlebug\/laravel-repository)[![GitHub stars](https:\/\/img.shields.io\/github\/stars\/Wanchaochao\/laravel-repository.svg)](https:\/\/github.com\/Wanchaochao\/laravel-repository\/stargazers)[![GitHub issues](https:\/\/img.shields.io\/github\/issues\/Wanchaochao\/laravel-repository.svg)](https:\/\/github.com\/Wanchaochao\/laravel-repository\/issues)[![GitHub forks](https:\/\/img.shields.io\/github\/forks\/Wanchaochao\/laravel-repository.svg)](https:\/\/github.com\/Wanchaochao\/laravel-repository\/network)[![Laravel](https:\/\/img.shields.io\/badge\/Laravel%20%5E5.5-support-brightgreen.svg)](https:\/\/github.com\/laravel\/laravel)\n\n[English](.\/README.md) | [Usage of Repository](https:\/\/wanchaochao.github.io\/laravel-repository\/?page=repository)\n\n## ç®€ä»‹\n\n`laravel-repository` æä¾›äº†åŸºç¡€çš„ `repository` ç±», å¯¹[laravel](https:\/\/laravel.com\/) çš„ \n[model](https:\/\/learnku.com\/docs\/laravel\/5.5\/eloquent\/1332) è¿›è¡Œäº†çš„å°è£…ï¼Œæä¾›æ›´\nå¤šçš„å¯¹å¤–çš„æ–¹æ³•ï¼Œä»¥åŠæ›´å‹å¥½çš„ç¼–è¾‘å™¨æç¤ºï¼›å¯¹ä»£ç è¿›è¡Œäº†çš„åˆ†å±‚ï¼Œ`repository` è´Ÿè´£å¯¹å¤–çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œ\n`model` åªè´Ÿè´£å¯¹æ•°æ®è¡¨çš„å­—æ®µã€å±æ€§ã€æŸ¥è¯¢æ¡ä»¶ã€è¿”å›å€¼çš„å®šä¹‰ï¼Œä¸å‚ä¸å…·ä½“çš„é€»è¾‘è¿ç®—ï¼Œä¸å¯¹æ§åˆ¶å±‚æœåŠ¡\n\n### ç›¸å¯¹äºç›´æ¥ä½¿ç”¨`model`ä¼˜åŠ¿ï¼š\n\n- è§£å†³`model`åœ¨æ–°å¢ã€ä¿®æ”¹æ—¶ä¸è‡ªåŠ¨å¤„ç†å¤šä½™å­—æ®µé—®é¢˜\n- ä¼˜åŒ–`model`æŸ¥è¯¢æ—¶çš„é“¾å¼è°ƒç”¨ï¼Œç›´æ¥ä½¿ç”¨æ•°ç»„çš„æ–¹å¼è¿›è¡ŒæŸ¥è¯¢\n- é€šè¿‡æŸ¥è¯¢æ¡ä»¶å’ŒæŸ¥è¯¢å­—æ®µï¼Œè‡ªåŠ¨å¤„ç†å¯¹åº”çš„å…³è”æ•°æ®æŸ¥è¯¢\n- æä¾›äº†æ›´å‹å¥½çš„ç¼–è¾‘å™¨æç¤º\n\n## å®‰è£…\n\n### å®‰è£…è¦æ±‚\n\n- PHP >= 7.0.0\n- Laravel >= 5.5.0\n\n### 1.1 å®‰è£…åŒ…æ–‡ä»¶\n\n```bash\ncomposer require littlebug\/laravel-repository:2.0.*\n```\næˆ–è€…åœ¨ä½ çš„é¡¹ç›® composer.json æ–‡ä»¶ä¸­æ·»åŠ :\n\n```bash\n\"littlebug\/laravel-repository\": \"2.0.*\"\n```\nç„¶åæ‰§è¡Œ composer update\n\n### 1.2 ä½¿ç”¨å‘½ä»¤è¡Œç”Ÿæˆ `model` å’Œ `repository`\n\nå‡è®¾ä½ çš„æ•°æ®åº“ä¸­å­˜åœ¨ users, æˆ–è€…ä½ å°† users æ›¿æ¢ä¸ºä½ æ•°æ®åº“ä¸­çš„è¡¨åç§°\n\n```bash\nphp artisan core:model --table=users --name=User\n```\n\nè¯¥å‘½ä»¤ä¼šåœ¨:\n\n- `app\/Models\/` æ–‡ä»¶ä¸‹ç”Ÿæˆ `User` æ–‡ä»¶\n- `app\/Repositories\/` æ–‡ä»¶ä¸‹ç”Ÿæˆ `UserRepository`  æ–‡ä»¶ \n\n### 1.3 åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨ `repository` \n\n```php\n<?php\n\nuse Illuminate\\Routing\\Controller;\nuse Littlebug\\Repository\\Tests\\Stubs\\UserRepository;\n\nclass UsersController extends Controller \n{\n    \/**\n     * @var UserRepository\n     *\/\n    private $userRepository;\n    \n    public function __construct(UserRepository $userRepository)\n    {\n        $this->userRepository = $userRepository;\n    }\n    \n    public function index()\n    {\n        \/\/ åˆ†é¡µæŸ¥è¯¢ã€è¿”å›åˆ†é¡µå¯¹è±¡\n        $paginate = $this->userRepository->paginate([\n            'name:like' => 'test', \n            'status'    => [1, 2], \/\/ è‡ªåŠ¨è½¬æ¢ä¸º in æŸ¥è¯¢\n        ]);\n        \n        return view('users.index', compact('paginate'));\n    }\n    \n    public function create()\n    {\n        \/\/ æ·»åŠ æ•°æ®ã€è¿”å› model->toArray()\n        $user = $this->userRepository->create(request()->all());\n        dump($user);\n    }\n    \n    public function update()\n    {\n        \/\/ ä¿®æ”¹æ•°æ®ã€è¿”å›å—å½±å“çš„è¡Œæ•°\n        $row = $this->userRepository->update(request()->input('id'), request()->all());\n        dump($row);\n    }\n    \n    public function delete()\n    {\n        \/\/ åˆ é™¤æ•°æ®ã€è¿”å›å—å½±å“çš„è¡Œæ•°\n        $row = $this->userRepository->delete(request()->input('id'));\n        dump($row);\n    }\n}\n\n```\n\nå¦‚æœä¸æƒ³ä½¿ç”¨æ³¨å…¥å¯¹è±¡çš„æ–¹å¼è°ƒç”¨çš„è¯ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ `Repository` å¯¹è±¡é™æ€æ–¹æ³• `instance()` è°ƒç”¨, å¦‚ä¸‹:\n\n```php\nuse Littlebug\\Repository\\Tests\\Stubs\\UserRepository;\n\n\/\/ åˆ†é¡µæŸ¥è¯¢\n$paginate = UserRepository::instance()->paginate(['status' => 1]);\n\n\/\/ æŸ¥è¯¢ä¸€æ¡æ•°æ®\n$user = UserRepository::instance()->find(['status' => 1, 'id:gt' => 2]);\n```\n### 1.4 å…¶ä»–çš„æ–¹æ³•\n\n#### æŸ¥è¯¢æ•°æ®\n\n| æ–¹æ³•åç§° | è¿”å›å€¼ | è¯´æ˜ |\n|-------------|------|------------------|\n| `find($conditions, $columns = ['*'])` | `null\\|array`|æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n| `findBy($conditions, $column)` | `null\\|mixed`|æŸ¥è¯¢ä¸€æ¡æ•°æ®çš„å•ä¸ªå­—æ®µ|\n| `findAll($conditions, $columns = ['*])` | `array`|æŸ¥è¯¢å¤šæ¡æ•°æ®|\n| `findAllBy($conditions, $column)` | `array`|æŸ¥è¯¢å¤šæ¡æ•°æ®çš„å•ä¸ªå­—æ®µæ•°ç»„|\n| `first($conditions, $column)` | `null\\|model`|æ£€ç´¢å¯¹è±¡|\n| `get($conditions, $column)` | `Collection`|æ£€ç´¢é›†åˆ|\n\n#### ç»Ÿè®¡æŸ¥è¯¢\n\n| æ–¹æ³•åç§° | è¿”å›å€¼ | è¯´æ˜ |\n|-------------|------|------------------|\n| `count($conditions, $column = '*')` | `int`|ç»Ÿè®¡æ•°é‡|\n| `max($conditions, $column)` | `mixed`|æœ€å¤§å€¼|\n| `min($conditions, $column)` | `mixed`|æœ€å°å€¼|\n| `avg($conditions, $column)` | `mixed`|å¹³å‡å€¼|\n| `sum($conditions, $column)` | `mixed`|æ±‚å’Œ|\n\n#### åˆ›å»ºæˆ–è€…ä¿®æ”¹\n\n| æ–¹æ³•åç§° | è¿”å›å€¼ | è¯´æ˜ |\n|-------------|------|------------------|\n| `increment($conditions, $column, $amount = 1, $extra = [])` | `int` | é€’å¢|\n| `decrement($conditions, $column, $amount = 1, $extra = [])` | `int` | é€’å‡|\n| `firstOrCreate(array $attributes, array $value = [])` | `model` |æ£€ç´¢å¯¹è±¡ä¸å­˜åœ¨åˆ›å»º|\n| `updateOrCreate(array $attributes, array $value = [])` | `model` |ä¿®æ”¹æ•°æ®ä¸å­˜åœ¨åˆ›å»º|\n\n### 1.5 æ›´å¤šæ–‡æ¡£å‚è€ƒ\n\n[è¯·æŸ¥çœ‹æ›´å¤šå…³äº `repository`](https:\/\/wanchaochao.github.io\/laravel-repository\/?page=repository)\n\n## å‘½ä»¤è¡Œå·¥å…·è¯´æ˜\n\n> å¦‚æœéœ€è¦æŒ‡å®šæ•°æ®åº“è¿æ¥çš„åç§°ï¼Œåªéœ€è¦åœ¨è¡¨åç§°å‰é¢æ·»åŠ æ•°æ®åº“è¿æ¥åç§°.å°±å¥½ ä¾‹å¦‚ï¼š --table=dev.users\n\n1. `core:model` ç”Ÿæˆ `model` ç±»æ–‡ä»¶å’Œ `repository` ç±»æ–‡ä»¶\n\n    ```bash\n    php artisan core:model --table=users --name=User\n    ```\n\n2. `core:repository` å•ç‹¬ç”Ÿæˆ `repository` ç±»æ–‡ä»¶\n\n    ```bash\n    php artisan core:repository --model=User --name=UserRepository\n    ```\n\n3. `core:request` ç”Ÿæˆ `request` éªŒè¯ç±»æ–‡ä»¶ï¼Œä¼šé€šè¿‡è¡¨ç»“æ„ä¿¡æ¯ç”Ÿæˆå¯¹åº”çš„éªŒè¯\n\n    ```bash\n    php artisan core:request --table=users --path=Users\n    ```\n\n### å‘½ä»¤è¡Œå‚æ•°è¯¦æƒ…\n\n![commands of generate code](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/commands-zh-cn.png 'core of commands')\n\n",
        "repository": "### Usage Instructions for Repository\n\n[TOC]\n\n[home](\/?page=home)|[åˆ‡æ¢ä¸­æ–‡](\/?page=repository.zh-cn)\n\n---\n\n#### CURD\n\n```php\n# create\n\n\/**\n * About the res\n * @param boolean $ok   true: successful, false: failed\n * @param string  $msg  about the message\n * @param array   $data the data, it`s null when failed \n *\/\n$this-repository->create([\n    'user_name' => 'Tony',\n    'age'       => 18,\n    'sex'       => 1,\n    'address    => 'America'\n]);\n```\n\n```php\n# delete\n\/**\n * About the res\n * @param boolean $ok   true: successful, false: failed\n * @param string  $msg  the message of res\n * @param int     $rows the number of data were deleted\n *\/\n$this->repository->delete(1); \/\/pk = 1\n$this->repository->delete(['id:gt' => 10]); \/\/ delete id > 10\n``` \n\n```php\n# update\n\/**\n * About the res\n * @param boolean $ok   true: successful, false: failed\n * @param string  $msg  the message of res\n * @param int     $rows the number of data were updated\n *\/\n$this->repository->update(['name:like' => '%555'], [\n    'type' => 3,\n    'money' => 9999\n]);\n```\n\n```php\n# query\n# A column of a piece of data\n$id = $this->repository->findBy(1, 'name'); \/\/ æŸ¥æŸä¸ªå­—æ®µ\n# A piece of data\n$this-repository->find(1); \/\/ PK was 1\n# Multiple data\n$this-repository->findAll(['user_id' => 10])\n# All values of a field in the result set\n$this-repository->findAllBy(['user_id' => 10], 'name');\n\n``` \n\n#### page data\n\nRepository->paginate($conditions = [], $fields = [], $pageSize = 10, $currentPage = null)\n\n```php\n$list = $this->repository->paginate(['status' => 1], ['id', 'name', ...]);\n```\n\n#### use expression to query data\n\n> The following methods support expression queries\n\n1. find\n2. findBy\n3. findAll\n4. findAllBy\n5. paginate\n6. update\n7. delete\n8. filterFind\n9. filterFindAll\n10. getFilterModel\n11. findCondition\n\n> usage\n\n'column:expression' => 'value'\n\n```php\n\n$items = $this->repository->findAll([\n    'id:neq'    => 1,\n    'name:like' => '%test%'\n]);\n\n\/\/ result condition : `id` != 1 and `name` like '%test%' \n```\n\n#### the expressions we support\n\n| expression |    meaning   |      desc     |\n|:------     |:-------------|:--------------|\n| eq         |       =      |               |\n| neq        |      !=      |               |\n| ne         |      !=      |               |\n| gt         |      >       |               |\n| egt        |      >=      |               |\n| gte        |      >=      |               |\n| ge         |      >=      |               |\n| lt         |      <       |               |\n| le         |      <=      |               |\n| lte        |      <=      |               |\n| elt        |      <=      |               |\n| in         |      IN      | need an array | \n| not in     |    NOT IN    | need an array | \n| not_in     |    NOT IN    | need an array | \n| between    |    between   | need an array | \n| not_between| not between  | need an array | \n| not between| not between  | need an array | \n| like       |     like     | need a string | \n| not_like   |    not like  | need a string | \n| not like   |    not like  | need a string | \n| rlike      |     rlike    |               | \n| <>         |      <>      |               | \n| auto_like  |     like     |   auto add %  |\n\n#### about auto_like \n\n```php\n\/\/ if there is no '%' at your conditionï¼ŒRepository will auto add '%' ('%test%')\n$this->repository->findAll(['username:auto_like' => 'test']); \n\n\/\/ if you write '%'ï¼ŒRepository won`t add any '%' to your condition\n$this->repository->findAll(['username:auto_like' => 'test%']);\n\n```\n\n```php\n\/\/ you can use the expression like this:\n# find the data where id > 10\n$this->repository->findAll(['id:gt' => 10]);\n\n# find the data where id != 10\n$this->repository->findAll(['id:neq' => 10]);\n\n# find the data where id in 1,2,3,4,5\n$this->repository->findAll(['id:in' => [1,2,3,4,5]);\n\n# find the data where created_at is between \n# 2019-01-01 00:00:00 and 2020-01-01 00:00:00\n$this->repository->findAll(['created_at:between' => \n    [\n        '2019-01-01 00:00:00', \n        '2020-01-01 00:00:00\n    ]\n]);\n\n# stop the account end with @@@\n$this->repository->update(['name:like' => '%@@@'], ['status' => 0]);\n\n``` \n\n\n#### Advanced usage\n\n```php\n# Example 1:\n# For example, you have an users table, \n# the user`s extension info saved in user_ext table\n# maybe you want to find the users and its extension info \n# at the same time\n\n# step 1.Determining model relationships at Users.php(model)\n\n\/**\n * @return \\Illuminate\\Database\\Eloquent\\Relations\\HasOne\n *\/\npublic function extInfo()\n{\n    # if foreignKey == localKey, you could only write the first user_id \n    # that`s enough\n    return $this->hasOne(UsersExt::class, 'user_id');\n}\n\n# step 2.do like this\n$this->userRepository->findAll(\n    ['status' => 1],  \/\/ filters\n    [\n        '*', \/\/ users columns\n        'extInfo' => [\n            \/\/ user_ext columns\n            'address', \n            'sex', \n            'hobby', \n            'phone'\n        ] \n    ]\/\/ fields\n);\n```\n\n```php\n# Example 2:\n# the same tables, users and user_ext\n# maybe you want to find the users who user_id > 10 and address is NewYork\n\n# step 1.\n# define scope in users model like this\n\n\/**\n * @param $query\n * @param $address\n * @return mixed\n *\/\npublic function scopeAddress($query, $address)\n{\n    return $query->leftJoin('user_ext', function ($join) use ($address) {\n        $join->on('user_ext.user_id', '=', 'users.user_id');\n    })->where('user_ext.address', '=', $address);\n}\n\n# step 2.\n# use it like this\n\n$users = $this->userRepository->findAll(\n    ['user_id:gt' => 10, 'address' => 'NewYork']\n);\n\n```\n\n[home](\/?page=home)|[åˆ‡æ¢ä¸­æ–‡](\/?page=repository.zh-cn)\n\nIs it very simple? ^_^ ğŸ˜œ\n\nTo be continued\n",
        "repository.zh-CN": "Repository åŸºæœ¬ä½¿ç”¨\n==================\n\n[TOC]\n\n## ä¸€ å¢åˆ æ”¹æŸ¥\n\n### 1.1 æ–°å¢æ•°æ® `create(array $data)`\n\n```php\n\/**\n * è¿”å›å€¼è¯´æ˜\n * @param boolean $ok   true è¡¨ç¤ºæˆåŠŸ\n * @param string  $msg  æ“ä½œçš„æç¤ºä¿¡æ¯\n * @param array   $data æ–°å¢æˆåŠŸåè°ƒç”¨ model->toArray() è¿”å›çš„æ•°æ®ï¼Œ å¤±è´¥ä¸ºnull \n *\/\nlist($ok, $msg, $data) = $this->repository->create([\n    'user_name' => 'Tony',\n    'age'       => 18,\n    'sex'       => 1,\n    'address    => 'America'\n]);\n\n```\n\n### 1.2 ç¼–è¾‘æ•°æ® `update($conditions, array $data)`\n\n```php\n\/**\n * è¿”å›å€¼è¯´æ˜\n * @param boolean $ok   true è¡¨ç¤ºæˆåŠŸ\n * @param string  $msg  æ“ä½œçš„æç¤ºä¿¡æ¯\n * @param int     $rows è¡¨ç¤ºä¿®æ”¹æ•°æ®æ¡æ•°\n *\/\nlist($ok, $msg, $rows) = $this->repository->update(1, ['type' => 3, 'money' => 9999]); \/\/ ä¸»é”®ä¿®æ”¹ pk = 1\n\n\/\/ $this->repository->update(['id:gt' => 10], ['type' => 3, 'money' => 9999]);  \/\/ æ¡ä»¶ä¿®æ”¹ id > 10\n\n\/\/ $this->repository->update([1, 2, 3, 4], ['type' => 3, 'money' => 9999]); \/\/ ä¸»é”®ä¿®æ”¹ pk in (1, 2, 3, 4)\n```\n\n#### ä½¿ç”¨çš„æ˜¯æ‰¹é‡åˆ é™¤ï¼Œæ¨¡å‹çš„äº‹ä»¶æ˜¯ä¸ä¼šè§¦å‘çš„ï¼›ä½†æ˜¯ä¿®æ”¹æ•°æ®èƒ½å¤Ÿä½¿ç”¨ä¸Šæ¨¡å‹çš„ä¿®æ”¹å™¨\n\n### 1.3 åˆ é™¤æ•°æ® `delete($conditions)`\n\n```php\n\/**\n * è¿”å›å€¼è¯´æ˜\n * @param boolean $ok   true è¡¨ç¤ºæˆåŠŸ\n * @param string  $msg  æ“ä½œçš„æç¤ºä¿¡æ¯\n * @param int     $rows è¡¨ç¤ºåˆ é™¤æ•°æ®æ¡æ•°\n *\/\nlist($ok, $msg, $rows) = $this->repository->delete(1); \/\/ ä¸»é”®åˆ é™¤ pk = 1\n\n\/\/ $this->repository->delete(['id:gt' => 10]);  \/\/ æ¡ä»¶åˆ é™¤ id > 10\n\n\/\/ $this->>repository->delete([1, 2, 3, 4, 5]); \/\/ ä¸»é”®åˆ é™¤ pk in (1, 2, 3, 4)\n``` \n\n### 1.4 æŸ¥è¯¢æ•°æ®\n\n#### 1.4.1 æŸ¥è¯¢å•æ¡æ•°æ®\n\n1. æŸ¥è¯¢å•æ¡æ•°æ® find($conditions, $columns = [])\n\n    ```php\n    $item = $this->repository->find(1);  \/\/ ä¸»é”®æŸ¥è¯¢ pk = 1\n    ```\n\n2. æŸ¥è¯¢å•ä¸ªå­—æ®µ findBy($conditions, $column)\n\n    ```php\n    $name = $this->repository->findBy(1, 'name'); \/\/ æŸ¥æŸä¸ªå­—æ®µ\n    ```\n\n#### 1.4.2 æŸ¥è¯¢å¤šæ¡æ•°æ®\n\n1. æŸ¥è¯¢å¤šæ¡æ•°æ® findAll($conditions, $columns = [])\n\n    ```php\n    $items = $this->repository->findAll([1, 2, 3, 4]); \/\/ ä¸»é”®æŸ¥è¯¢ pk in (1, 2, 3, 4)\n    ```\n\n2. æŸ¥è¯¢å¤šæ¡æ•°æ®çš„å•ä¸ªå­—æ®µ findAllBy($conditions, $column)\n\n    ```php\n    $usernames = $this->repository->findAllBy([1, 2, 3], 'username'); \/\/ æŸ¥è¯¢æŸä¸ªå­—æ®µçš„æ‰€æœ‰å€¼\n    ```\n\n#### 1.4.3 åˆ†é¡µæŸ¥è¯¢\n\nåˆ†é¡µæŸ¥è¯¢ paginate($conditions = [], $columns = [], $size = 10, $current = null)\n\n```php\n$list = $this->repository->paginate(['status' => 1], ['id', 'name', ...]);\n```\n\n#### 1.4.4 ä½¿ç”¨`findWhere(array $where, array $columns = [])`æ„å»ºå¤æ‚çš„æŸ¥è¯¢\n\n```php\n    $users = $this->userRepository->findWhere([\n        'and',\n        ['or', ['username:auto_like' => 'test'], ['nick_name', 'like', '%test%']],\n        ['level' => 5],\n        ['status', '=', 1],\n    ])->get();\n```\n\nä¸Šé¢æŸ¥è¯¢ç”Ÿæˆçš„SQl\n\n```sql\nselect * from `users` where (\n    (`users`.`username` like '%test%' or `users`.`nick_name` like '%test%') \n    and `users`.`level` = 5 \n    and `users`.`status` = 1\n)\n```\n\n##### 1.4.4.1 ä½¿ç”¨è¯´æ˜\n- åªèƒ½ä½¿ç”¨æ•°ç»„æŸ¥è¯¢\n- æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç¡®å®šæ•°ç»„ä¸­å…¶ä»–æŸ¥è¯¢æ¡ä»¶çš„è¿æ¥æ–¹å¼ `and` æˆ– `or`ï¼› `and`å¯ä»¥å¿½æ‚ ä¸å†™\n\n    ```php\n    $where = [\n        \/\/ ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ˜¯ and æŸ¥è¯¢ï¼Œå¯ä»¥ä¸ç”¨å†™\n        ['level' => 5],\n        ['status' => 1],\n        [\n            \/\/ or è¡¨ç¤º æ•°ç»„ä¸­ï¼Œä¸‹é¢æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ or è¿æ¥ \n            'or', \n            ['username' => 'test'], \n            ['name' => 'test123']\n        ],\n    ];\n    ```\n- æ•°ç»„ä¸­çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¿…é¡»ä½¿ç”¨æ•°ç»„æ–¹å¼ \n    - `['å­—æ®µ', 'è¡¨è¾¾å¼', 'æŸ¥è¯¢å€¼']` \n    - `['å­—æ®µ:è¡¨è¾¾å¼' => 'æŸ¥è¯¢å€¼']` \n    - `['å­—æ®µ' => 'æŸ¥è¯¢å€¼']`\n    \n    >å»ºè®®ä½¿ç”¨`['å­—æ®µ', 'è¡¨è¾¾å¼', 'æŸ¥è¯¢å€¼']` æ¯”è¾ƒç›´è§‚\n    \n### 1.5 æŸ¥è¯¢è¿›é˜¶ä½¿ç”¨\n\n#### 1.5.1 ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢\n\n> ä½¿ç”¨æ–¹å¼\n\n`å­—æ®µ`:`è¡¨è¾¾å¼` => `å¯¹åº”æŸ¥è¯¢çš„å€¼`\n\nä¾‹å¦‚:\n\n```php\n\n$items = $this->repository->findAll([\n    'id:neq'    => 1,\n    'name:like' => '%test%'\n]);\n\n\/\/ å¯¹åº”ç”Ÿæˆçš„sql: `id` != 1 and `name` like '%test%' \n```\n\n##### 1.5.1.1  ç›®å‰æ”¯æŒçš„è¡¨è¾¾å¼\n\n| è¡¨è¾¾å¼ | å«ä¹‰ | ç‰¹åˆ«è¯´æ˜ |\n|:------|:--------------|:-----|\n| eq    | ç­‰äº(=)      | |\n| neq   | ä¸ç­‰äº(!=)   | |\n| ne    | ä¸ç­‰äº(!=)   | |\n| gt    | å¤§äº(>)      | |\n| egt    | å¤§äºç­‰äº(>=) | |\n| gte    | å¤§äºç­‰äº(>=) | |\n| ge     | å¤§äºç­‰äº(>=) | |\n| lt     | å°äº(<)      | |\n| le     | å°äºç­‰äº(<=)  | |\n| lte    | å°äºç­‰äº(<=)  | |\n| elt    | å°äºç­‰äº(<=)  | |\n| in     | IN æŸ¥è¯¢      | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not in | NOT IN æŸ¥è¯¢  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not_in | NOT IN æŸ¥è¯¢  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| between| åŒºé—´æŸ¥è¯¢(between)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not_between| ä¸åœ¨åŒºé—´æŸ¥è¯¢(not between)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not between| ä¸åœ¨åŒºé—´æŸ¥è¯¢(not between)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| like   | æ¨¡ç³ŠæŸ¥è¯¢åŒ…å«(like)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºå­—ç¬¦ä¸² | \n| not_like   | æ¨¡ç³ŠæŸ¥è¯¢ä¸åŒ…å«(not like)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºå­—ç¬¦ä¸² | \n| not like   | æ¨¡ç³ŠæŸ¥è¯¢ä¸åŒ…å«(not like)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºå­—ç¬¦ä¸² | \n| rlike      | æ¨¡ç³ŠæŸ¥è¯¢åŒ…å«(rlike)   |  | \n| <>         | ä¸ç­‰äº(<>)            |  | \n| auto_like  | æ¨¡ç³ŠæŸ¥è¯¢(like)        | ä¼šè‡ªåŠ¨åˆ¤æ–­æ·»åŠ  % æ¨¡ç³ŠæŸ¥è¯¢\n\n##### 1.5.1.2 å…³äº `auto_like` æŸ¥è¯¢è¯´æ˜\n\n```php\n\/\/ æ²¡æœ‰æ·»åŠ å‰åæ¨¡ç³ŠæŸ¥è¯¢ï¼Œä¼šè‡ªåŠ¨åŠ ä¸Š username like '%test%'\n$this->repository->findAll(['username:auto_like' => 'test']); \n\n\/\/ æ·»åŠ äº†å‰ç¼€æˆ–è€…åç¼€æ¨¡ç³ŠæŸ¥è¯¢ï¼Œé‚£ä¹ˆä¸å¤„ç† username like 'test%'\n$this->repository->findAll(['username:auto_like' => 'test%']);\n\n```\n\n##### 1.5.1.3 ä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨è¡¨è¾¾å¼:\n\n```php\n\/\/ æŸ¥è¯¢å¤§äº10çš„è´¦å·\n$this->repository->findAll(['id:gt' => 10]);\n\n\/\/ æŸ¥è¯¢ä¸ç­‰äº10çš„è´¦å·\n$this->repository->findAll(['id:neq' => 10]);\n\n\/\/ æŸ¥è¯¢idæ˜¯1,2,3,4,5çš„è¿™äº›æ•°æ®\n$this->repository->findAll(['id:in' => [1, 2, 3, 4, 5]);\n\/\/ or\n$this->repository->findAll(['id' => [1, 2, 3, 4, 5]])\n\n\/\/ æŸ¥è¯¢åˆ›å»ºæ—¶é—´åœ¨2019å¹´çš„æ•°æ®\n$this->repository->findAll(['created_at:between' => \n    [\n        '2019-01-01 00:00:00', \n        '2020-01-01 00:00:00',\n    ]\n]);\n``` \n\n##### 1.5.1.4 å¦‚æœä½ è®°ä¸ä½è¡¨è¾¾å¼,é‚£ä¹ˆä½ åŒæ ·å¯ä»¥ç›´æ¥ä½¿ç”¨æ“ä½œç¬¦æŸ¥è¯¢ä¹Ÿæ˜¯ä¸€æ ·çš„\n\n```php\n$item = $this->repository->findAll([\n    'id:!='         => 2,\n    'username:like' => '%test%',\n    'status:>='     => 4,\n])\n```\n\n**åŒæ ·æ˜¯ æŸ¥è¯¢å­—æ®µ:æ“ä½œç¬¦ => 'æŸ¥è¯¢çš„å€¼'**\n\n##### 1.5.1.5 å…¶ä»–è¯´æ˜\n\n`update` å’Œ `create` æ–¹æ³•åŒæ ·æ”¯æŒè¡¨è¾¾å¼æŸ¥è¯¢ï¼Œéƒ½æ˜¯ä½¿ç”¨`findCondition($condiitons)` æ–¹æ³•å¤„ç†\n\n1. [update çš„ä½¿ç”¨è¯´æ˜](#12-ç¼–è¾‘æ•°æ®-updateconditions-array-data)\n2. [delete çš„ä½¿ç”¨è¯´æ˜](#13-åˆ é™¤æ•°æ®-deleteconditions)\n\n#### 1.5.2 ä½¿ç”¨ `model` çš„ `scope` æŸ¥è¯¢\n\n>ä¸¾ä¸ªğŸŒ°æ —å­,ä½ æœ‰ä¸€å¼ ç”¨æˆ·è¡¨ users, ç”¨æˆ·è¡¨çš„æ‰©å±•ä¿¡æ¯å­˜åœ¨ user_ext é‡Œ;\nç°åœ¨ä½ æƒ³æŸ¥è¯¢ç”¨æˆ·åœ°å€åœ¨æŒ‡å®šä½ç½®ä¿¡æ¯çš„æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯, é‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨`scope` æŸ¥è¯¢äº†\n\nè¦æ±‚modelå®šä¹‰äº†`scope`æŸ¥è¯¢\n\n##### 1. model \n\n```php\n\nclass User extends Model\n{\n    protected $table      = 'users';\n    protected $primaryKey = 'user_id';\n    public    $columns    = [\n        'user_id',\n        'username',\n        \/\/...\n        'created_at',\n        'updated_at',\n    ];\n \n  \n    \/**\n     * å®šä¹‰å…³è”æ‰©å±•ä¿¡æ¯\n     * \n     * return Illuminate\\Database\\Eloquent\\Relations\\HasOne\n     *\/\n    public function extInfo()\n    {\n      return $this->hasOne(UserExt::class, 'user_id', 'user_id');\n    }\n \n\n    \/**\n     * æ ¹æ®åœ°å€æŸ¥è¯¢\n     *\n     * @param \\Illuminate\\Database\\Eloquent\\Builder $query   æŸ¥è¯¢å¯¹è±¡\n     * @param string                                $address åœ°å€ä¿¡æ¯\n     * @return \\Illuminate\\Database\\Eloquent\\Builder\n     *\/\n    public function scopeAddress($query, $address)\n    {\n        return $query->leftJoin('user_ext', 'user_ext.user_id', '=', 'users.user_id')\n            ->where('user_ext.address', '=', $address);\n    }\n}   \n\n```\n\n##### 2. ä½¿ç”¨ `repository` æŸ¥è¯¢\n\n```php\n\n$this->userRepositoy->findAll([\n    'status'  => 1,\n    'address' => 'åŒ—äº¬'\n]);\n\n```\n\n##### 3. æŸ¥è¯¢çš„SQL\n\n```sql\n\nselect \n    * \nfrom \n    `users` \nleft join \n    `user_ext` on (`user_ext`.`user_id` = `users`.`user_id`) \nwhere \n    `users.status` = 1 and `user_ext`.`address` = 'åŒ—äº¬'\n    \n```\n##### 4 ä½¿ç”¨è¯´æ˜\n\nä»ä¸Šé¢çš„SQLå’Œå®¹æ˜“å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œæ²¡æœ‰æŒ‡å®šæŸ¥è¯¢å­—æ®µï¼Œé»˜è®¤æŸ¥è¯¢çš„ `*` æ‰€æœ‰å­—æ®µï¼Œå¦‚æœ`users`è¡¨å’Œ`user_ext`\nè¡¨çš„å­—æ®µæ²¡æœ‰å†²çªï¼Œé‚£ä¹ˆæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æœæœ‰å†²çªï¼Œé‚£ä¹ˆæŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¯èƒ½å’Œä½ æƒ³è±¡çš„ä¸ä¸€æ ·ï¼Œç‰¹åˆ«åœ¨è¿˜æœ‰\nå…³è”æŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿™ä¸ªé—®é¢˜æ›´å®¹æ˜“å‡¸æ˜¾å‡ºæ¥ï¼Œæ‰€ä»¥å»ºè®®åœ¨æœ‰è¿è¡¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œæœ€å¥½æœ‰åŠ ä¸Šä½ éœ€è¦æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯\n\n```php\n$this->userRepository->findAll([\n    'status'  => 1,\n    'address' => 'åŒ—äº¬',\n], ['users.*'])\n```\n\n#### 1.5.4 è·å– `model` çš„ `relation` å…³è”æ•°æ®ä¿¡æ¯\n\nå½“æˆ‘ä»¬æŸ¥è¯¢æ•°æ®æ—¶å€™ï¼Œä¹Ÿæƒ³æŠŠå…³è”æ•°æ®æŸ¥è¯¢å‡ºæ¥çš„æ—¶å€™ï¼Œå°±ä¼šç”¨åˆ°å…³è”æŸ¥è¯¢\n\nä½¿ç”¨çš„æ˜¯`model`çš„`with`æ–¹æ³•\n\n>ä¸¾ä¸ªğŸŒ°æ —å­,ä½ æœ‰ä¸€å¼ ç”¨æˆ·è¡¨users,ç”¨æˆ·è¡¨çš„æ‰©å±•ä¿¡æ¯å­˜åœ¨user_exté‡Œ \nä¹Ÿè®¸ä½ æƒ³æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™åŒæ—¶æŸ¥å‡ºç”¨æˆ·çš„æ‰©å±•ä¿¡æ¯\n\nè¦æ±‚`model`å®šä¹‰äº†å…³è”\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\n1. ä½¿ç”¨ `repository` è·å–å…³è”æ•°æ®ä¿¡æ¯, é€šè¿‡æŸ¥è¯¢å­—æ®µï¼Œè‡ªåŠ¨å¤„ç†å…³è”\n\n    æŸ¥è¯¢å­—æ®µä¸­æ·»åŠ  `å…³è”å…³ç³»` => [`å…³è”æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯`]\n    \n    ```php\n        $users = $this->repository->findAll(['status' => 1], ['*', 'extInfo' => ['*']]);\n    ```\n\n2. æŸ¥è¯¢SQL \n\n    [è¿™é‡Œä½¿ç”¨é¢„åŠ è½½æ•°æ®](https:\/\/learnku.com\/docs\/laravel\/5.5\/eloquent-relationships\/1333#012e7e), é¿å…N+1é—®é¢˜\n\n    ```sql\n    select * from `users` where `users`.`status` = 1\n    \n    select * from `user_ext` where `user_id` in (1, 2, 3, 4)\n    ```\n\n3. æ•°æ®ä¿¡æ¯\n\n    ![å…³è”çš„æ•°æ®](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/relation.png 'å…³è”çš„æ•°æ®')\n\n##### 1.5.4.1\n    \n1. ä¸Šé¢æœ‰ä¸ªå°çš„é—®é¢˜ï¼Œ`model`å®šä¹‰çš„å…³è”åç§°ä¸º`extInfo`, ä½†æ˜¯å‡ºæ¥æ•°ç»„å¯¹åº”çš„å­—æ®µä¿¡æ¯ä¸º\n `ext_info` , å¹¶ä¸”æŸ¥è¯¢æŒ‡å®šå­—æ®µä¿¡æ¯ä¹Ÿæ˜¯ä¸º`extInfo` (`'extInfo' => ['*']`), æŸ¥è¯¢\n å‡ºæ¥çš„æ•°æ®æ˜¯`laravel` `model` çš„ `toArray()` æ–¹æ³•å¤„ç†çš„ç»“æœ,ä¼šå°†`å°é©¼å³°`å‘½åçš„\n å…³è”ä¿¡æ¯è½¬ä¸º`è›‡å½¢`å‘½åå­—æ®µï¼Œ`repository`æŸ¥è¯¢å­—æ®µæ”¯æŒ`å°é©¼å³°`å’Œ`è›‡å½¢`å‘½åï¼Œä¾‹å¦‚ï¼š\n     \n     ```php\n        $users = $this->repository->findAll(['status' => 1], ['*', 'ext_info' => ['*]])\n     ``` \n       \n     å’Œä¸Šé¢çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä¸ºäº†æ›´å¥½çš„ä¸€è‡´æ€§ï¼Œå»ºè®®`model`åœ¨å®šä¹‰è”æŸ¥è¯¢å‘½åçš„æ—¶å€™ï¼Œä½¿ç”¨å•ä¸ªå•è¯çš„å•å¤æ•°å½¢å¼æ¯”è¾ƒå¥½\n\n2. åœ¨æŸ¥è¯¢æ—¶å€™æŒ‡å®šå­—æ®µï¼Œå¹¶ä¸”æŒ‡å®šæŸ¥è¯¢å…³è”æŸ¥è¯¢å­—æ®µ\n\n    ```php\n    $users = $this->userRepository->findAll(['status' => 1], ['username', 'extInfo' => ['address']]);\n    ```    \n   \n   ä¸Šé¢æŸ¥è¯¢æŒ‡å®šäº†æŸ¥è¯¢çš„å­—æ®µï¼Œä½†æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ²¡æœ‰æŒ‡å®šå‡ºå…³è”è¡¨æŸ¥è¯¢éœ€è¦çš„å­—æ®µ `user_id` å­—æ®µä¿¡æ¯ï¼Œä¼šå¯¼è‡´å…³è”ä¿¡æ¯å…³è”ä¸ä¸Šçš„é—®é¢˜\n   **ä½†`repository`è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¼šè‡ªåŠ¨åŠ ä¸Šå…³è”æŸ¥è¯¢éœ€è¦çš„å­—æ®µä¿¡æ¯**ï¼Œæ‰€ä»¥æœ€ç»ˆæŸ¥è¯¢çš„SQLå’Œæ•°æ®å¦‚ä¸‹:\n   \n   ![å…³è”çš„æ•°æ®](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/relation-1.png 'å…³è”çš„æ•°æ®')\n   \n   >è¿™å¯èƒ½ä¼šè®©äººè®¤ä¸ºæˆ‘æ˜æ˜åªæŸ¥è¯¢äº†`username`å­—æ®µï¼Œæ€ä¹ˆè¿˜æŸ¥å‡ºäº†å…¶ä»–å­—æ®µä¿¡æ¯\n   \n   **åªæœ‰åœ¨å…³è”æŸ¥è¯¢çš„æ—¶å€™ï¼Œæ²¡æœ‰æŒ‡å®šæŸ¥è¯¢å…³è”å­—æ®µï¼Œæ‰ä¼šè‡ªåŠ¨åŠ ä¸Šå…³è”å­—æ®µ**\n   \n#### 1.5.5 è·å– `model` çš„ `relation` å…³è”ç»Ÿè®¡æ•°æ®ä¿¡æ¯\n\nè¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒé€‚åˆä¸€å¯¹å¤šçš„æ—¶å€™ï¼Œæˆ‘æƒ³çŸ¥é“å…³è”çš„å…¶ä»–ä¿¡æ¯æœ‰å¤šå°‘\n\nåªè¦å®šä¹‰äº†`model`çš„å…³è”ä¿¡æ¯ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ï¼Œå…¶å®å°±æ˜¯ `model` çš„ `withCount`\n\n>`model`å®šä¹‰çš„`å…³è”æ–¹æ³•åç§°_count`\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\n```php\n$user = $this->repositoy->find(['status' => 1], ['id', 'username', 'extInfo_count']);\n```\n\næ‰§è¡ŒSQLä»¥åŠæ•°æ®\n\n![å…³è”çš„æ•°æ®](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/relation-2.png 'å…³è”çš„æ•°æ®')\n\n#### 1.5.6 ç»™ `model` çš„ `relation` å…³è”æŸ¥è¯¢åŠ¨æ€æ·»åŠ æŸ¥è¯¢æ¡ä»¶\n\næŸ¥è¯¢æ¡ä»¶ä¸­æ·»åŠ  `modelå®šä¹‰å…³è”æ–¹æ³•åç§°.å­—æ®µ` => 'æŸ¥è¯¢çš„å€¼'\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\nä¾‹å¦‚ï¼š\n\n```php\n\n$users = $this->repository->findAll([\n    'status'                => 1,\n    'extInfo.address'       => 'åŒ—äº¬',\n    'extInfo.created_at:gt' => '2019-02-01 00:00:00', \/\/ åŒæ ·æ”¯æŒè¡¨è¾¾å¼æŸ¥è¯¢\n], ['extInfo' => ['*']])\n\n```\næ‰§è¡Œçš„SQLï¼š\n```sql\nselect * from `users` where `users`.`status` = 1\n\nselect * from `user_ext` where \n    `user_ext`.`address` = 'åŒ—äº¬' and \n    `user_ext`.`created_at` > '2019-02-01 00:00:00' and \n    `user_ext`.`user_id` in (1, 2, 3, 4)\n```\n\n##### 1.5.6.1 model ä¹Ÿå¯ä»¥å®šä¹‰é»˜è®¤å…³è”çš„æŸ¥è¯¢æ¡ä»¶\n\néœ€è¦åœ¨`model`é‡Œé¢å®šä¹‰ `å…³è”æ–¹æ³•åç§°Filters` çš„å±æ€§ä¿¡æ¯\n\n```php\n    class User extends Model\n    {\n        protected $table      = 'users';\n        protected $primaryKey = 'user_id';\n        public    $columns    = [\n            'user_id',\n            'username',\n            \/\/...\n            'created_at',\n            'updated_at',\n        ];\n        \n        \/**\n         * ä¸ºå…³è”å®šä¹‰é»˜è®¤æŸ¥è¯¢æ¡ä»¶\n         *\n         * @var array\n         *\/\n        public $extInfoFilters = [\n            'address' => 'åŒ—äº¬', \n            \/\/ 'ddress:like' => 'åŒ—äº¬', \/\/ å…è®¸ä½¿ç”¨è¡¨è¾¾å¼æ–¹å¼\n        ];\n     \n        \/**\n         * å®šä¹‰å…³è”æ‰©å±•ä¿¡æ¯\n         * \n         * return Illuminate\\Database\\Eloquent\\Relations\\HasOne\n         *\/\n        public function extInfo()\n        {\n          return $this->hasOne(UserExt::class, 'user_id', 'user_id');\n        }\n     \n    \n        \/**\n         * æ ¹æ®åœ°å€æŸ¥è¯¢\n         *\n         * @param \\Illuminate\\Database\\Eloquent\\Builder $query   æŸ¥è¯¢å¯¹è±¡\n         * @param string                                $address åœ°å€ä¿¡æ¯\n         * @return \\Illuminate\\Database\\Eloquent\\Builder\n         *\/\n        public function scopeAddress($query, $address)\n        {\n            return $query->leftJoin('user_ext', 'user_ext.user_id', '=', 'users.user_id')\n                ->where('user_ext.address', '=', $address);\n        }\n    }   \n```\n  \nè¯´æ˜ï¼š å…³è”æŸ¥è¯¢ã€ç»Ÿè®¡æŸ¥è¯¢éƒ½ä¼šæ·»åŠ é»˜è®¤å…³è”æŸ¥è¯¢æ¡ä»¶\n\nä½¿ç”¨å®šä¹‰äº†é»˜è®¤å…³è”æŸ¥è¯¢æ¡ä»¶è¿›è¡ŒæŸ¥è¯¢\n\n```php\n$users = $this->repository->findAll(['status' => 1], ['extInfo' => ['*']])\n```\n\næ‰§è¡Œçš„SQLï¼š\n\n```sql\nselect * from `users` where `users`.`status` = 1\n\nselect * from `user_ext` where \n    `user_ext`.`address` = 'åŒ—äº¬' \n    `user_ext`.`user_id` in (1, 2, 3, 4)\n```\n\n**é»˜è®¤å…³è”æŸ¥è¯¢æ¡ä»¶å’ŒåŠ¨æ€å…³è”æŸ¥è¯¢æ¡ä»¶æ˜¯å åŠ çš„**\n\n#### 1.5.7 è¿‡æ»¤ç©ºå€¼æŸ¥è¯¢\n\n**ç©ºå­—ç¬¦ä¸²ã€ç©ºæ•°ç»„ã€nullä¼šè¢«è®¤ä¸ºç©ºå€¼**\n\n1. æŸ¥è¯¢å•ä¸ª filterFind($conditions, $columns = [])\n\n    ```php\n    $item = $this->repositpry->filterFind([\n        'username:like' => request()->input('username'),\n        'status'        => request()->input('status')\n    ]);\n    ```\n\n2. æŸ¥è¯¢å¤šä¸ª filterFindAll($conditions, $columns = [])\n\n    ```php\n    $items = $this->repositpry->filterFindAll([\n        'username:like' => request()->input('username'),\n        'status'        => request()->input('status')\n    ]);\n    ```\n3. è·å–è¿‡æ»¤ç©ºå€¼æŸ¥è¯¢çš„model getFilterModel($conditions, $columns = [])\n\n    ```php\n    $model = $this->repositpry->getFilterModel([\n        'username:like' => request()->input('username'),\n        'status'        => request()->input('status')\n    ]);\n    ```\n    \n>è¿™å‡ ä¸ªæ–¹æ³•ï¼Œç›¸å½“äº [when æ¡ä»¶æŸ¥è¯¢](https:\/\/learnku.com\/docs\/laravel\/5.5\/queries\/1327#conditional-clauses)\nåœ¨å’Œå‰ç«¯äº¤äº’æ—¶ï¼Œä¸ç¡®å®šå‰ç«¯æ˜¯å¦ä¼ é€’å€¼æ¥è¿›è¡ŒæŸ¥è¯¢æ—¶å€™ï¼Œæ¯”è¾ƒæ–¹ä¾¿\n\n```php\n\/\/ å¹³æ—¶å†™æ³•\n$conditions = [];\n\nif ($username = request()->input('username')) {\n    $conditions['username:like'] = $username;\n}\n\nif ($status = request()->input('status')) {\n    $conditions['status'] = $status;\n}\n\n$items = $this->repository->findAll($conditions);\n\n\/\/ ä½¿ç”¨ filter è¿‡æ»¤æŸ¥è¯¢\n$items = $this->repositpry->filterFindAll([\n    'username:like' => request()->input('username'),\n    'status'        => request()->input('status')\n]);\n```\n\n#### 1.5.8 ä½¿ç”¨ `findWhere` æ„å»ºå¤æ‚æŸ¥è¯¢\n\n> `findWhere(array $where, $array $columns = [])`\n\n```php\n$this->userRespository->findWhere([\n    'and',\n    ['username' => 1, 'name:like' => '%test%'],\n    ['or', ['level' => 10, 'level:eq' => 5]],\n    ['and', ['status' => 1, 'age' => 1]],   \n])->get();\n\n```\n\næ‰§è¡Œçš„SQL\n\n```sql\nselect * from `users` where \n    (`username` = 1 and `name` like '%test%') and \n    (`level` = 10 or `level` = 5) and \n    (`status` = 1 and `age` = 1)\n```\n\n`where`æŸ¥è¯¢æ¡ä»¶è¯´æ˜\n\næ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ å®šä¹‰æŸ¥è¯¢æ¡ä»¶è¿æ¥æ–¹å¼(åé¢æ•°ç»„çš„æŸ¥è¯¢æ¡ä»¶æ€ä¹ˆè¿æ¥`or` æˆ–è€… `and`)ï¼Œå¦‚æœæ˜¯`and`è¿æ¥\nå¯ä»¥å¿½ç•¥ä¸å†™,ä¸€å®šè¦æ˜¯å¤šç»´æ•°ç»„\n\nç¬¬ä¸€ä¸ª`and`å¿½ç•¥ä¸å†™\n```php\n$where = [\n['status' => 1]ï¼Œ\n['name' => 2]\n];\n\n\/\/ where `status` = 1 and `name` = 2 \n```\n\nä½¿ç”¨ `or` è¿æ¥\n```php\n$where = [\n    \/\/ or å®šä¹‰ åé¢çš„æŸ¥è¯¢æ¡ä»¶ é€šè¿‡ or è¿æ¥\n    'or',\n    ['status' => 1],\n    ['age' => 1],\n    \n    \/\/ and å®šä¹‰æ•°ç»„é‡Œé¢åé¢çš„æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ and è¿æ¥\n    ['and', ['name', '=', 123], ['username', 'like', 'test']],\n];\n\n\/\/ where `status` = 1 or `age` = 1 or (`name` = 123 and `username` like 'test')\n```\n\n#### 1.5.9 ä½¿ç”¨ `join` æŸ¥è¯¢\n\n>`leftJoin` å’Œ `rightJoin` å’Œ `join` ä½¿ç”¨ä¸€è‡´\n\n##### 1. ç®€å•`join`\n\n```php\n$this->repository->findAll([\n    'join' => ['users', 'users.school_id', '=', 'school.id']\n]);\n\n```\n\n```sql\nselect `school`.* from `school` inner join `users` on (`users`.`school_id` = `school`.`id`)\n```\n\n##### 2. ä¸€æ¬¡å¤šä¸ª`join`\n```php\n$this->repository->findAll([\n    'join' => [\n        ['users', 'users.school_id', '=', 'school.id'],\n        ['school as s1', 's1.parent_id', '=', 'school.id']\n    ]\n]);\n\n```\n\n```sql\nselect \n    `school`.* \nfrom \n    `school` \ninner join `users` on (`users`.`school_id` = `school`.`id`) \ninner join `school` as `s1` on (`s1`.`parent_id` = `school`.`id`)\n```\n\n##### 3. ä½¿ç”¨å…³è”å…³ç³»å¯¹åº”join\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\n```php\n$users = $this->repository->findAll(['status' => 1, 'joinWith' => 'extInfo']);\n```\n\n```sql\nselect \n    `users`.* \nfrom \n    `users` \ninner join `user_ext` on `user_ext`.`user_id` = `users`.`user_id`\nwhere `users`.`status` = 1\n```\n\n##### 4. ä½¿ç”¨å…³è”å…³ç³»å¯¹åº”joinå¹¶è®¾ç½®åˆ«å\n\n>['åˆ«å' => 'å…³è”æ–¹æ³•åç§°']\n\n```php\n$users = $this->repository->findAll(['status' => 1, 'joinWith' => ['ext' => 'extInfo']]);\n```\n\n```sql\nselect \n    `users`.* \nfrom \n    `users` \ninner join `user_ext` as `ext` on `ext`.`user_id` = `users`.`user_id` \nwhere `users`.`status` = 1\n```\n\n##### 5. ä¸º`join`æ·»åŠ æŸ¥è¯¢æ¡ä»¶\n\n>é€šè¿‡ ['__joinè¡¨åç§°.å­—æ®µ' => 'å¯¹åº”çš„å€¼'], ç›®å‰æ²¡æœ‰æ¯”è¾ƒç›´è§‚çš„æ–¹å¼å¤„ç†ã€å› ä¸º `order.user_id` æ–¹å¼è¢«å…³è”å…³ç³»çš„é™„åŠ æ¡ä»¶å ç”¨äº†\n\n```php\n$users = $this->repository->findAll([\n    'status'        => 1, \n    'joinWith'      => ['ext' => 'extInfo']ï¼Œ\n    '__ext.user_id' => 1,\n]);\n```\n\n```sql\nselect \n    `users`.* \nfrom \n    `users` \ninner join `user_ext` as `ext` on `ext`.`user_id` = `users`.`user_id`\nwhere `users`.`status` = 1 and `ext`.`user_id` = 1\n```\n\n## äºŒ å…³äºæŸ¥è¯¢ä¸­çš„`$conditions`å’Œ`$columns`ä¿¡æ¯è¯´æ˜\n\n>`$conditions`ä¸º`sql`æŸ¥è¯¢å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼Œ`$columns`ä¸º`sql`çš„`select`æ·»åŠ æŒ‡å®šçš„æŸ¥è¯¢å­—æ®µ\n\n### 2.1 `$conditions` æŸ¥è¯¢æ¡ä»¶\n\n1. æ”¯æŒå­—æ®µç²¾å‡†æŸ¥è¯¢(è¡¨ä¸­å­—æ®µçš„æŸ¥è¯¢)\n2. é¢„å®šæœ‰å­—æ®µæŸ¥è¯¢[å‚è€ƒ](#211-é¢„å®šä¹‰çš„å­—æ®µ)\n3. æ”¯æŒè¡¨è¾¾å¼æŸ¥è¯¢[å‚è€ƒ](#15-æŸ¥è¯¢è¿›é˜¶ä½¿ç”¨)\n4. æ”¯æŒå…³è”æ¡ä»¶æŸ¥è¯¢[å‚è€ƒ](#156-ç»™-model-çš„-relation-å…³è”æŸ¥è¯¢åŠ¨æ€æ·»åŠ æŸ¥è¯¢æ¡ä»¶)\n5. æ”¯æŒ`model`çš„`scope`[å‚è€ƒ](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\nä¾‹å¦‚ï¼š\n\n```php\n$conditions = [\n    \/\/ è¡¨ä¸­å­—æ®µç²¾å‡†æŸ¥è¯¢\n    'status' => 1,\n    'id'     => [1, 2, 3, 4], \/\/ å€¼ä¸ºæ•°ç»„ä¼šè‡ªåŠ¨è½¬ä¸ºinæŸ¥è¯¢ `id` in (1, 2, 3, 4)\n    \n    \/\/ é¢„å®šä¹‰å­—æ®µæŸ¥è¯¢\n    'order' => 'id desc' \/\/ æŒ‡å®šæ’åºå­—æ®µå’Œæ–¹å¼\n    'limit' => 10,       \/\/ é™åˆ¶æŸ¥è¯¢æ¡ä»¶\n    'group' => 'id',     \/\/ æŒ‡å®šåˆ†ç»„æ¡ä»¶\n    'force' => 'name',   \/\/ æŒ‡å®šä½¿ç”¨çš„ç´¢å¼•\n  \n    \/\/ join å…³è”æŸ¥è¯¢\n    'join'     => ['users', 'users.user_id', '=', 'orders.user_id'],\n    'leftJoin' => [\n        \/\/ å¤šä¸ªleftJoin\n        ['users as u1', 'u1.user_id', '=', 'orders.user_id'],\n        ['user_image', 'users_image.user_id', '=', 'users.user_id'],\n    ],\n\n    \/\/ è¡¨è¾¾å¼æŸ¥è¯¢\n    'username:like'      => 'test',                                         \/\/ æ¨¡ç³ŠæŸ¥è¯¢\n    'created_at:between' => ['2019-01-02 00:00:00', '2019-01-03 23:59:59'], \/\/ åŒºé—´æŸ¥è¯¢\n    'id:ge'              => 12, \/\/ id > 12\n    ...\n    \n    \/\/ relation å…³è”æŸ¥è¯¢,æŸ¥è¯¢æ¡ä»¶åªå¯¹å½“å‰relationå…³è”æŸ¥è¯¢é™åˆ¶\n    'extInfo.address:like'   => 'åŒ—äº¬',\n    'extInfo.created_at:gte' => '2019-01-01 00:00:00',\n    \n    \/\/ é€šè¿‡ relation å…³è”å…³ç³»ï¼Œæ·»åŠ join æŸ¥è¯¢\n    'joinWith'     => ['extInfo'],\n    \/\/ å…³è”è¡¨å®šä¹‰åˆ«å alias, å¦‚æœæ²¡æœ‰åˆ«åï¼Œå…³è”è¡¨å’Œä¸»è¡¨åŒåï¼Œä½¿ç”¨è‡ªå®šä¹‰åˆ«å `t1`, å¤šä¸ªåŒåä»¥æ­¤åœ°å€ `t2`ã€`t3`\n    'leftJoinWith' => ['alias' => 'children'], \n    \n    \/\/ scope è‡ªå®šä¹‰æŸ¥è¯¢\n    'address'  => 'åŒ—äº¬',     \/\/ æŸ¥æ‰¾`scopeAddress($query, $address)`æ–¹æ³•\n    'children' => [1, 2, 3],  \/\/ æŸ¥æ‰¾`scopeChildren($query, $childrenIds)`æ–¹æ³•\n];\n```\n\n#### 2.1.1 é¢„å®šä¹‰çš„å­—æ®µ\n\n|å­—æ®µåç§°|å­—æ®µå€¼ç±»å‹|è¯´æ˜|\n|-------|---------|----|\n|`force`|`string`|å¼ºåˆ¶èµ°æŒ‡å®šç´¢å¼•|\n|`order`|`string or array`|æŒ‡å®šæ’åºæ¡ä»¶|\n|`limit`|`int`|æŒ‡å®šæŸ¥è¯¢æ¡æ•°|\n|`offset`|`int`|æŒ‡å®šè·³è½¬ä½ç½®|\n|`group`|`string`|æŒ‡å®šåˆ†ç»„å­—æ®µ|\n|`join`|`array`|æŸ¥è¯¢joinçš„å‚æ•°ï¼Œå¤šä¸ªäºŒç»´æ•°ç»„|\n|`leftJoin`|`array`|æŸ¥è¯¢`leftJoin`çš„å‚æ•°ã€å¤šä¸ªäºŒç»´æ•°ç»„|\n|`rightJoin`|`array`|æŸ¥è¯¢`rightJoin`çš„å‚æ•°ã€å¤šä¸ªäºŒç»´æ•°ç»„|\n|`joinWith`|`string or array`| é€šè¿‡å…³è”å…³ç³»å¯¹åº”joinæŸ¥è¯¢|\n|`leftJoinWith`|`string or array`| é€šè¿‡å…³è”å…³ç³»å¯¹åº”leftJoinæŸ¥è¯¢|\n|`rightJoinWith`|`string or array`| é€šè¿‡å…³è”å…³ç³»å¯¹åº”rightJoinæŸ¥è¯¢|\n\n### 2.2 `$columns` æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯\n\n1. æ”¯æŒæœ¬è¡¨å­—æ®µæŸ¥è¯¢\n2. æ”¯æŒå…³è”ç»Ÿè®¡å­—æ®µæŸ¥è¯¢\n3. æ”¯æŒå…³è”æ•°æ®å­—æ®µæŸ¥è¯¢\n\n```php\n$columns = [\n\n    \/\/ æœ¬è¡¨çš„å­—æ®µæŸ¥è¯¢\n    'id',\n    'username',\n\n    \/\/ å…³è”è¡¨çš„å­—æ®µæŸ¥è¯¢\n    'users.username',\n    'users.age',\n    \n    \/\/ ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢\n    DB::raw('SUM(`users`.`age`) AS `sum_age`'),\n    \n    \/\/ å…³è”ç»Ÿè®¡å­—æ®µæŸ¥è¯¢\n    'extInfo_count',  \/\/ å¯¹åº”`model`å®šä¹‰çš„ extInfo å…³è”\n    'children_count', \/\/ å¯¹åº”`model`å®šä¹‰çš„ children å…³è”\n    \n    \/\/ å…³è”è¡¨å­—æ®µæŸ¥è¯¢\n    'extInfo'  => ['*'], \/\/ å¯¹åº”`model`å®šä¹‰çš„ extInfo å…³è”\n    'children' => ['*'], \/\/ å¯¹åº”`model`å®šä¹‰çš„ children å…³è”\n];\n```\n\n## ä¸‰ æ–¹æ³•åˆ—è¡¨\n\n### 3.1 æ–¹æ³•åˆ—è¡¨\n\n>repositoryæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¯¹å¤–çš„ï¼Œè¿™é‡Œåªåˆ—å‡ºå¸¸ç”¨æ–¹æ³•\n\n|æ–¹æ³•åç§°|è¿”å›å€¼|æ–¹æ³•è¯´æ˜|\n|-------|-----|-------|\n|`find($conditions, $columns = [])`|`array or false`|æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n|`findBy($conditions, $column)`|`mixed`|æŸ¥è¯¢å•æ¡æ•°æ®çš„å•ä¸ªå­—æ®µ|\n|`findAll($conditions, $columns = [])`|`array`|æŸ¥è¯¢å¤šæ¡æ•°æ®|\n|`findAllBy($conditions, $column)`|`array`|æŸ¥è¯¢å¤šæ¡æ•°ç»„çš„å•ä¸ªå­—æ®µæ•°ç»„|\n|`filterFind($conditions, $columns = [])`|`array or false`|è¿‡æ»¤æŸ¥è¯¢æ¡ä»¶ä¸­çš„ç©ºå€¼æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n|`filterFindAll($condtions, $columns = [])`|`array`|è¿‡æ»¤æŸ¥è¯¢æ¡ä»¶ä¸­çš„ç©ºå€¼æŸ¥è¯¢å¤šæ¡æ•°æ®|\n|`paginate($conditions = [], $columns = [], $size = 10, $current = null)`|`array`|åˆ†é¡µæŸ¥è¯¢æ•°æ®|\n|`filterPaginate($conditions = [], $columns = [], $size = 10, $current = null)`|`array`|è¿‡æ»¤æŸ¥è¯¢æ¡ä»¶ä¸­çš„ç©ºå€¼åˆ†é¡µæŸ¥è¯¢æ•°æ®|\n|`getFilterModel($conditions, $columns = [])`|`Illuminate\\Database\\Eloquent\\Model`|è·å–å·²ç»è¿‡æ»¤å¤„ç†æŸ¥è¯¢æ¡ä»¶çš„`model`|\n|`findCondition($conditions = [], $columns = [])`|`Illuminate\\Database\\Eloquent\\Model`|è·å–å·²ç»å¤„ç†æŸ¥è¯¢æ¡ä»¶çš„`model`(**ä¸Šé¢æ‰€æœ‰æŸ¥è¯¢æ–¹æ³•éƒ½åŸºäºè¿™ä¸ªæ–¹æ³•**)|\n|`create(array $data)`|`array`|æ·»åŠ æ•°æ®|\n|`update($conditions, array $data)`|`array`|ä¿®æ”¹æ•°æ®(ä½¿ç”¨çš„æ˜¯æ‰¹é‡ä¿®æ”¹)|\n|`delete($conditions)`|`array`|åˆ é™¤æ•°æ®(ä½¿ç”¨çš„æ˜¯æ‰¹é‡åˆ é™¤)|\n|`findWhere(array $where, $columns = [])`|`Illuminate\\Database\\Eloquent\\Model`|è·å–é€šè¿‡æ•°ç»„æŸ¥è¯¢çš„`model`\n\n#### å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array or string or int`|æŸ¥è¯¢æ¡ä»¶(`string or int or ç´¢å¼•æ•°ç»„[1, 2, 3, 4]`ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºä¸»é”®æŸ¥è¯¢)|\n|`$columns`|`array`|æŸ¥è¯¢çš„å­—æ®µæ•°ç»„|\n|`$column`|`string`|æŸ¥è¯¢çš„å­—æ®µåç§°|\n|`$data`|`array`|åˆ›å»ºæˆ–è€…ä¿®æ”¹çš„æ•°ç»„æ•°æ®ä¿¡æ¯|\n|`$where`|`array`|æŸ¥è¯¢æ¡ä»¶|\n\n### 3.2 æ”¯æŒ`model`è‡ªå¸¦æ–¹æ³•\n\n|æ–¹æ³•åç§°    |è¿”å›å€¼| æ–¹æ³•è¯´æ˜ |\n|---------------|-------------|----------|\n|`getConnection()`|`Illuminate\\Database\\Connection`|è·å–è¿æ¥ä¿¡æ¯|\n|`insert(array $values)`|`boolean`|æ–°å¢æ•°æ®(æ”¯æŒæ‰¹é‡æ–°å¢)|\n|`insertGetId(array $values)`|`int`|æ–°å¢æ•°æ®å¹¶è·å–æ–°å¢ID|\n|`firstOrCreate(array $attributes, array $value = [])`|`Illuminate\\Database\\Eloquent\\Model`|æŸ¥è¯¢æ•°æ®ï¼Œä¸å­˜åœ¨é‚£ä¹ˆæ–°å¢ä¸€æ¡æ•°æ®|\n|`firstOrNew(array $attributes, array $value = [])`|`Illuminate\\Database\\Eloquent\\Model`|æŸ¥è¯¢æ•°æ®ã€ä¸å­˜åœ¨é‚£ä¹ˆ`new`å‡ºæ¥|\n|`updateOrCreate(array $attributes, array $value = [])`|`Illuminate\\Database\\Eloquent\\Model`|ä¿®æ”¹æ•°æ®ï¼Œä¸å­˜åœ¨é‚£ä¹ˆæ–°å¢ä¸€æ¡æ•°æ®|\n|`findOrFail($id, $columns = ['*'])`|`Illuminate\\Database\\Eloquent\\Model`|é€šè¿‡ä¸»é”®æŸ¥è¯¢æ•°æ®ï¼Œä¸å­˜åœ¨æŠ›å‡ºé”™è¯¯|\n|`findOrNew($id, $columns = ['*'])` |`Illuminate\\Database\\Eloquent\\Model`|é€šè¿‡ä¸»é”®æŸ¥è¯¢æ•°æ®ï¼Œä¸å­˜åœ¨`new`å‡ºæ¥|\n|`findMany($ids, $columns = ['*'])`|`\\Illuminate\\Database\\Eloquent\\Collection`|é€šè¿‡ä¸»é”®æ•°ç»„æŸ¥è¯¢å¤šæ¡æ•°æ®|\n\n#### å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$attributes`|`array`|`model`çš„å­—æ®µä¿¡æ¯(æŸ¥è¯¢æ¡ä»¶)|\n|`$value`|`array or null`|`model`çš„å…¶ä»–å­—æ®µä¿¡æ¯(ä¸å‚ä¸æŸ¥è¯¢ã€å‚ä¸æ–°å¢å’Œ`new`)\n|`$values`|`array`|æ–°å¢æ•°æ®éœ€è¦çš„å­—æ®µ => å€¼ æ•°ç»„ä¿¡æ¯\n|`$id`|`int or string`|ä¸»é”®IDå€¼|\n|`$ids`|`array`|ä¸»é”®IDæ•°ç»„|\n|`$columns`|`array`|æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯|\n\n### 3.3 é€šè¿‡`findCondition($conditions)`æŸ¥è¯¢åè½¬æ¢ä¸º`model`æŸ¥è¯¢æ–¹æ³•\n\n|æ–¹æ³•åç§°|è¿”å›å€¼|æ–¹æ³•è¯´æ˜|\n|---------------|-------------|----------|\n|`first($conditions, $columns = ['*'])`|`Illuminate\\Database\\Eloquent\\Model or null`|æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n|`get($conditions, $columns = ['*'])`|`Illuminate\\Database\\Eloquent\\Collection`|æŸ¥è¯¢å¤šæ¡æ•°æ®|\n|`pluck($conditions, $column, $key = null)`|`Illuminate\\Support\\Collection`|æŸ¥è¯¢å•ä¸ªå­—æ®µä¿¡æ¯|\n|`firstOrFail($conditions)`|`Illuminate\\Database\\Eloquent\\Model`|æŸ¥è¯¢ä¸€æ¡æ•°æ®ã€æ²¡æœ‰é‚£ä¹ˆæŠ›å‡ºé”™è¯¯|\n|`count($conditions = [])`|`int`|ç»Ÿè®¡æŸ¥è¯¢|\n|`max($conditions, $column)`|`int or mixed`|æœ€å¤§å€¼æŸ¥è¯¢|\n|`min($conditions, $column)`|`int or mixed`|æœ€å°å€¼æŸ¥è¯¢|\n|`avg($conditions, $column)`|`int or mixed`|å¹³å‡å€¼æŸ¥è¯¢|\n|`sum($conditions, $column)`|`int or mixed`|æ±‚å’ŒæŸ¥è¯¢|\n|`toSql($conditions)`|`string`|è·å–æ‰§è¡Œçš„`SQL`|\n|`getBindings($conditions = [])`|`array or mixed`|è·å–æŸ¥è¯¢ç»‘å®šçš„å‚æ•°|\n|`increment($conditions, $column, $amount = 1)`|`int`|æŒ‡å®šå­—æ®µç´¯åŠ |\n|`decrement($conditions, $column, $amount = 1)`|`int`|æŒ‡å®šå­—æ®µç´¯å‡|\n\n#### å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array or string or int`|æŸ¥è¯¢æ¡ä»¶(`string or int or ç´¢å¼•æ•°ç»„[1, 2, 3, 4]`ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºä¸»é”®æŸ¥è¯¢)|\n|`$columns`|`array`|æŸ¥è¯¢çš„å­—æ®µæ•°ç»„|\n|`$column`|`string`|æŸ¥è¯¢çš„å­—æ®µåç§°|\n|`$key`|`string or null`|æŸ¥è¯¢å•ä¸ªå­—æ®µç»„æˆæ•°ç»„çš„`key`(ç´¢å¼•ä¸‹æ ‡ä½¿ç”¨å­—æ®µ)|\n\n## å›› å¢åˆ æ”¹çš„äº‹ä»¶æ–¹æ³•\n\n>å­ç±»å®šä¹‰äº†è¿™äº›æ–¹æ³•ï¼Œæ‰ä¼šæ‰§è¡Œï¼Œå¦‚æœæƒ³é˜»æ­¢ä¸»æ–¹æ³•æ‰§è¡Œï¼Œå¹¶èƒ½è®©ä¸»æ–¹æ³•è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œç›´æ¥æŠ›å‡ºé”™è¯¯å°±å¯ä»¥\n\n### 4.1 æ–°å¢çš„äº‹ä»¶ åœ¨`create($data)` æ‰§è¡Œçš„æ—¶å€™è§¦å‘\n\n1. `beforeCreate($data)` æ–°å¢ä¹‹å‰\n\n2. `afterCreate($data, $news)`  æ–°å¢ä¹‹å\n\n#### 4.1.1 å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$data`|`array`|è¿‡æ»¤æ‰å¹²æ‰°æ•°æ®(éè¡¨ä¸­å­—æ®µçš„æ•°æ®)çš„æ•°ç»„|\n|`$news`|`array`|æ–°å¢æˆåŠŸè°ƒç”¨ `model->toArray()` æ•°ç»„|\n\n### 4.2 ä¿®æ”¹çš„äº‹ä»¶ åœ¨`update($conditions, array $data)` æ‰§è¡Œçš„æ—¶å€™è§¦å‘\n\n1. `beforeUpdate($conditions, $data)` ä¿®æ”¹ä¹‹å‰\n \n2. `afterUpdate($conditions, $data, $row)` ä¿®æ”¹ä¹‹å\n\n#### 4.2.1 å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array`|å¤„ç†äº†ä¸»é”®æŸ¥è¯¢åçš„æŸ¥è¯¢æ¡ä»¶æ•°ç»„|\n|`$data`|`array`|è¿‡æ»¤æ‰å¹²æ‰°æ•°æ®(éè¡¨ä¸­å­—æ®µçš„æ•°æ®)çš„æ•°ç»„|\n|`$row`|`int`|ä¿®æ”¹å—å½±å“çš„è¡Œæ•°|\n\n### 4.3 åˆ é™¤çš„äº‹ä»¶ åœ¨`delete($conditions)` æ‰§è¡Œçš„æ—¶å€™è§¦å‘\n\n1. `beforeDelete($conditions)` åˆ é™¤ä¹‹å‰\n\n2. `afterDelete($conditions, $row)` åˆ é™¤ä¹‹å\n\n#### 4.3.1 å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array`|å¤„ç†äº†ä¸»é”®æŸ¥è¯¢åçš„æŸ¥è¯¢æ¡ä»¶æ•°ç»„|\n|`$row`       |`int`  |åˆ é™¤å—å½±å“çš„è¡Œæ•°|\n\n### 4.4 å…³äº`$conditions` å¤„ç†ä¸ºä¸»é”®æŸ¥è¯¢\n\nä¸ä¸ºç©ºçš„ å­—ç¬¦ä¸²ã€æ•´æ•°ã€æµ®ç‚¹æ•°ã€ç´¢å¼•æ•°ç»„ éƒ½ä¼šè¢«è½¬ä¸ºä¸»é”®æŸ¥è¯¢\n\n```php\n\/\/ å‡è®¾è¡¨çš„ä¸»é”®ä¸ºid\n\n$conditions = 1;            \/\/ ä¼šè¢«è½¬ä¸º ['id' => 1]\n$conditions = '1';          \/\/ ä¼šè¢«è½¬ä¸º ['id' => '1']\n$conditions = [1, 2, 3];    \/\/ ä¼šè¢«è½¬ä¸º ['id' => [1, 2, 3, 4]]\n\n\/\/ å…³è”æ•°ç»„ä¸­ï¼Œåªè¦æœ‰ä¸€ä¸ªå…ƒç´ ä¸ºç´¢å¼•ä¸‹æ ‡çš„ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯ ç´¢å¼•æ•°ç»„\n\n$conditions = ['id' => 1, 'name' => '123', '789']\n\nåŒæ ·ä¼šè¢«è®¤ä¸ºæ˜¯ç´¢å¼•æ•°ç»„ï¼Œä¼šè½¬ä¸º\n\n$conditions = ['id' => [1, '123', '789']]\n\n```\n\n## äº” å…¶ä»–è¯´æ˜\n\n### 5.1 å…³äº`repository`çš„`create`ã€`update`ã€`delete` çš„è¿”å›\n\nè¿™ä¸‰ä¸ªå‡½æ•°ä¸ç®¡å¤„ç†æˆåŠŸå’Œå¤±è´¥ï¼Œè¿”å›çš„éƒ½æ˜¯æ•°ç»„ä¿¡æ¯ã€‚å› ä¸º`php`ä¸èƒ½åƒ`golang`é‚£æ ·,\nå¯ä»¥å¤šè¿”å›ï¼Œè€Œåœ¨æˆ‘ä»¬é€»è¾‘ä¸­ï¼Œç»å¸¸éœ€è¦çŸ¥é“æ‰§è¡Œé”™è¯¯äº†ï¼Œæ˜¯ä»€ä¹ˆæ ·çš„é”™è¯¯ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œ\néƒ½æ˜¯é€šè¿‡æ•°ç»„çš„æ–¹å¼è¿”å›ï¼Œè¿™æ ·å°±è§£å†³å¤šå€¼è¿”å›é—®é¢˜ã€‚è¿™ä¹Ÿæ˜¯å—`golang`çš„å½±å“ï¼ä¸è¿‡\n`laravel`å…¶å®æ›´æ¨èæ˜¯é€šè¿‡æŠ›å‡ºé”™è¯¯æ–¹å¼ï¼Œå»ç»Ÿä¸€ç®¡ç†æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯ã€‚æ‰€ä»¥å¦‚æœä¸å–œæ¬¢\nç°åœ¨æ•°ç»„çš„è¿”å›æ–¹å¼çš„è¯ï¼Œåªéœ€è¦é‡å†™ `success($data, $message === 'ok')` \nå’Œ `error($message, $data = [])` è¿™ä¸¤ä¸ªæ–¹æ³•å°±å¥½äº†\n\n### 5.2 `repository` æŸ¥è¯¢ `find`, `findAll` æŸ¥è¯¢ç»“æœéƒ½æ˜¯ `model->toArray()` çš„æ•°ç»„ï¼Œå¹¶ä¸æ˜¯ `model` å¯¹è±¡\n\n### 5.3 å¯¹äº`model`çš„è¦æ±‚\n\n1. `create` å’Œ `update` éƒ½æ˜¯æ‰¹é‡èµ‹å€¼ï¼Œéœ€è¦`model`å®šä¹‰æ‰¹é‡èµ‹å€¼çš„ç™½åå•`$fillable` æˆ–è€… é»‘åå• `$guarded`\n2. éœ€è¦å®šä¹‰ `$columns` å­—æ®µä¿¡æ¯ï¼Œè¡¨ç¤ºè¡¨ä¸­éƒ½æœ‰å“ªäº›å­—æ®µ\n\n    ```php\n    public $columns = ['id', 'title', 'content', 'created_at', 'updated_at'];\n    ```\n    \n    >è™½ç„¶è¿™ä¸€æ­¥æ˜¯éå¿…é¡»çš„ï¼Œä½†å®šä¹‰äº†`$columns`ä¼šå‡å°‘ä¸€æ¬¡`SQL`æŸ¥è¯¢çš„ä»£ä»·\n\næ˜¯ä¸æ˜¯éå¸¸ç®€æ´æ–¹ä¾¿ ^_^ ğŸ˜‹\nåé¢ä¼šç»§ç»­è¡¥å……",
        "v1.0.*": "Repository åŸºæœ¬ä½¿ç”¨\n==================\n\n[TOC]\n\n## ä¸€ å¢åˆ æ”¹æŸ¥\n\n### 1.1 æ–°å¢æ•°æ® `create(array $data)`\n\n```php\n\/**\n * è¿”å›å€¼è¯´æ˜\n * @param boolean $ok   true è¡¨ç¤ºæˆåŠŸ\n * @param string  $msg  æ“ä½œçš„æç¤ºä¿¡æ¯\n * @param array   $data æ–°å¢æˆåŠŸåè°ƒç”¨ model->toArray() è¿”å›çš„æ•°æ®ï¼Œ å¤±è´¥ä¸ºnull \n *\/\nlist($ok, $msg, $data) = $this->repository->create([\n    'user_name' => 'Tony',\n    'age'       => 18,\n    'sex'       => 1,\n    'address    => 'America'\n]);\n\n```\n\n### 1.2 ç¼–è¾‘æ•°æ® `update($conditions, array $data)`\n\n```php\n\/**\n * è¿”å›å€¼è¯´æ˜\n * @param boolean $ok   true è¡¨ç¤ºæˆåŠŸ\n * @param string  $msg  æ“ä½œçš„æç¤ºä¿¡æ¯\n * @param int     $rows è¡¨ç¤ºä¿®æ”¹æ•°æ®æ¡æ•°\n *\/\nlist($ok, $msg, $rows) = $this->repository->update(1, ['type' => 3, 'money' => 9999]); \/\/ ä¸»é”®ä¿®æ”¹ pk = 1\n\n\/\/ $this->repository->update(['id:gt' => 10], ['type' => 3, 'money' => 9999]);  \/\/ æ¡ä»¶ä¿®æ”¹ id > 10\n\n\/\/ $this->repository->update([1, 2, 3, 4], ['type' => 3, 'money' => 9999]); \/\/ ä¸»é”®ä¿®æ”¹ pk in (1, 2, 3, 4)\n```\n\n#### ä½¿ç”¨çš„æ˜¯æ‰¹é‡åˆ é™¤ï¼Œæ¨¡å‹çš„äº‹ä»¶æ˜¯ä¸ä¼šè§¦å‘çš„ï¼›ä½†æ˜¯ä¿®æ”¹æ•°æ®èƒ½å¤Ÿä½¿ç”¨ä¸Šæ¨¡å‹çš„ä¿®æ”¹å™¨\n\n### 1.3 åˆ é™¤æ•°æ® `delete($conditions)`\n\n```php\n\/**\n * è¿”å›å€¼è¯´æ˜\n * @param boolean $ok   true è¡¨ç¤ºæˆåŠŸ\n * @param string  $msg  æ“ä½œçš„æç¤ºä¿¡æ¯\n * @param int     $rows è¡¨ç¤ºåˆ é™¤æ•°æ®æ¡æ•°\n *\/\nlist($ok, $msg, $rows) = $this->repository->delete(1); \/\/ ä¸»é”®åˆ é™¤ pk = 1\n\n\/\/ $this->repository->delete(['id:gt' => 10]);  \/\/ æ¡ä»¶åˆ é™¤ id > 10\n\n\/\/ $this->>repository->delete([1, 2, 3, 4, 5]); \/\/ ä¸»é”®åˆ é™¤ pk in (1, 2, 3, 4)\n``` \n\n### 1.4 æŸ¥è¯¢æ•°æ®\n\n#### 1.4.1 æŸ¥è¯¢å•æ¡æ•°æ®\n\n1. æŸ¥è¯¢å•æ¡æ•°æ® find($conditions, $columns = [])\n\n    ```php\n    $item = $this->repository->find(1);  \/\/ ä¸»é”®æŸ¥è¯¢ pk = 1\n    ```\n\n2. æŸ¥è¯¢å•ä¸ªå­—æ®µ findBy($conditions, $column)\n\n    ```php\n    $name = $this->repository->findBy(1, 'name'); \/\/ æŸ¥æŸä¸ªå­—æ®µ\n    ```\n\n#### 1.4.2 æŸ¥è¯¢å¤šæ¡æ•°æ®\n\n1. æŸ¥è¯¢å¤šæ¡æ•°æ® findAll($conditions, $columns = [])\n\n    ```php\n    $items = $this->repository->findAll([1, 2, 3, 4]); \/\/ ä¸»é”®æŸ¥è¯¢ pk in (1, 2, 3, 4)\n    ```\n\n2. æŸ¥è¯¢å¤šæ¡æ•°æ®çš„å•ä¸ªå­—æ®µ findAllBy($conditions, $column)\n\n    ```php\n    $usernames = $this->repository->findAllBy([1, 2, 3], 'username'); \/\/ æŸ¥è¯¢æŸä¸ªå­—æ®µçš„æ‰€æœ‰å€¼\n    ```\n\n#### 1.4.3 åˆ†é¡µæŸ¥è¯¢\n\nåˆ†é¡µæŸ¥è¯¢ paginate($conditions = [], $columns = [], $size = 10, $current = null)\n\n```php\n$list = $this->repository->paginate(['status' => 1], ['id', 'name', ...]);\n```\n\n#### 1.4.4 ä½¿ç”¨`findWhere(array $where, array $columns = [])`æ„å»ºå¤æ‚çš„æŸ¥è¯¢\n\n```php\n    $users = $this->userRepository->findWhere([\n        'and',\n        ['or', ['username:auto_like' => 'test'], ['nick_name', 'like', '%test%']],\n        ['level' => 5],\n        ['status', '=', 1],\n    ])->get();\n```\n\nä¸Šé¢æŸ¥è¯¢ç”Ÿæˆçš„SQl\n\n```sql\nselect * from `users` where (\n    (`users`.`username` like '%test%' or `users`.`nick_name` like '%test%') \n    and `users`.`level` = 5 \n    and `users`.`status` = 1\n)\n```\n\n##### 1.4.4.1 ä½¿ç”¨è¯´æ˜\n- åªèƒ½ä½¿ç”¨æ•°ç»„æŸ¥è¯¢\n- æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç¡®å®šæ•°ç»„ä¸­å…¶ä»–æŸ¥è¯¢æ¡ä»¶çš„è¿æ¥æ–¹å¼ `and` æˆ– `or`ï¼› `and`å¯ä»¥å¿½æ‚ ä¸å†™\n\n    ```php\n    $where = [\n        \/\/ ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ˜¯ and æŸ¥è¯¢ï¼Œå¯ä»¥ä¸ç”¨å†™\n        ['level' => 5],\n        ['status' => 1],\n        [\n            \/\/ or è¡¨ç¤º æ•°ç»„ä¸­ï¼Œä¸‹é¢æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ or è¿æ¥ \n            'or', \n            ['username' => 'test'], \n            ['name' => 'test123']\n        ],\n    ];\n    ```\n- æ•°ç»„ä¸­çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¿…é¡»ä½¿ç”¨æ•°ç»„æ–¹å¼ \n    - `['å­—æ®µ', 'è¡¨è¾¾å¼', 'æŸ¥è¯¢å€¼']` \n    - `['å­—æ®µ:è¡¨è¾¾å¼' => 'æŸ¥è¯¢å€¼']` \n    - `['å­—æ®µ' => 'æŸ¥è¯¢å€¼']`\n    \n    >å»ºè®®ä½¿ç”¨`['å­—æ®µ', 'è¡¨è¾¾å¼', 'æŸ¥è¯¢å€¼']` æ¯”è¾ƒç›´è§‚\n    \n### 1.5 æŸ¥è¯¢è¿›é˜¶ä½¿ç”¨\n\n#### 1.5.1 ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢\n\n> ä½¿ç”¨æ–¹å¼\n\n`å­—æ®µ`:`è¡¨è¾¾å¼` => `å¯¹åº”æŸ¥è¯¢çš„å€¼`\n\nä¾‹å¦‚:\n\n```php\n\n$items = $this->repository->findAll([\n    'id:neq'    => 1,\n    'name:like' => '%test%'\n]);\n\n\/\/ å¯¹åº”ç”Ÿæˆçš„sql: `id` != 1 and `name` like '%test%' \n```\n\n##### 1.5.1.1  ç›®å‰æ”¯æŒçš„è¡¨è¾¾å¼\n\n| è¡¨è¾¾å¼ | å«ä¹‰ | ç‰¹åˆ«è¯´æ˜ |\n|:------|:--------------|:-----|\n| eq    | ç­‰äº(=)      | |\n| neq   | ä¸ç­‰äº(!=)   | |\n| ne    | ä¸ç­‰äº(!=)   | |\n| gt    | å¤§äº(>)      | |\n| egt    | å¤§äºç­‰äº(>=) | |\n| gte    | å¤§äºç­‰äº(>=) | |\n| ge     | å¤§äºç­‰äº(>=) | |\n| lt     | å°äº(<)      | |\n| le     | å°äºç­‰äº(<=)  | |\n| lte    | å°äºç­‰äº(<=)  | |\n| elt    | å°äºç­‰äº(<=)  | |\n| in     | IN æŸ¥è¯¢      | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not in | NOT IN æŸ¥è¯¢  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not_in | NOT IN æŸ¥è¯¢  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| between| åŒºé—´æŸ¥è¯¢(between)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not_between| ä¸åœ¨åŒºé—´æŸ¥è¯¢(not between)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not between| ä¸åœ¨åŒºé—´æŸ¥è¯¢(not between)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| like   | æ¨¡ç³ŠæŸ¥è¯¢åŒ…å«(like)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºå­—ç¬¦ä¸² | \n| not_like   | æ¨¡ç³ŠæŸ¥è¯¢ä¸åŒ…å«(not like)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºå­—ç¬¦ä¸² | \n| not like   | æ¨¡ç³ŠæŸ¥è¯¢ä¸åŒ…å«(not like)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºå­—ç¬¦ä¸² | \n| rlike      | æ¨¡ç³ŠæŸ¥è¯¢åŒ…å«(rlike)   |  | \n| <>         | ä¸ç­‰äº(<>)            |  | \n| auto_like  | æ¨¡ç³ŠæŸ¥è¯¢(like)        | ä¼šè‡ªåŠ¨åˆ¤æ–­æ·»åŠ  % æ¨¡ç³ŠæŸ¥è¯¢\n\n##### 1.5.1.2 å…³äº `auto_like` æŸ¥è¯¢è¯´æ˜\n\n```php\n\/\/ æ²¡æœ‰æ·»åŠ å‰åæ¨¡ç³ŠæŸ¥è¯¢ï¼Œä¼šè‡ªåŠ¨åŠ ä¸Š username like '%test%'\n$this->repository->findAll(['username:auto_like' => 'test']); \n\n\/\/ æ·»åŠ äº†å‰ç¼€æˆ–è€…åç¼€æ¨¡ç³ŠæŸ¥è¯¢ï¼Œé‚£ä¹ˆä¸å¤„ç† username like 'test%'\n$this->repository->findAll(['username:auto_like' => 'test%']);\n\n```\n\n##### 1.5.1.3 ä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨è¡¨è¾¾å¼:\n\n```php\n\/\/ æŸ¥è¯¢å¤§äº10çš„è´¦å·\n$this->repository->findAll(['id:gt' => 10]);\n\n\/\/ æŸ¥è¯¢ä¸ç­‰äº10çš„è´¦å·\n$this->repository->findAll(['id:neq' => 10]);\n\n\/\/ æŸ¥è¯¢idæ˜¯1,2,3,4,5çš„è¿™äº›æ•°æ®\n$this->repository->findAll(['id:in' => [1, 2, 3, 4, 5]);\n\/\/ or\n$this->repository->findAll(['id' => [1, 2, 3, 4, 5]])\n\n\/\/ æŸ¥è¯¢åˆ›å»ºæ—¶é—´åœ¨2019å¹´çš„æ•°æ®\n$this->repository->findAll(['created_at:between' => \n    [\n        '2019-01-01 00:00:00', \n        '2020-01-01 00:00:00',\n    ]\n]);\n``` \n\n##### 1.5.1.4 å¦‚æœä½ è®°ä¸ä½è¡¨è¾¾å¼,é‚£ä¹ˆä½ åŒæ ·å¯ä»¥ç›´æ¥ä½¿ç”¨æ“ä½œç¬¦æŸ¥è¯¢ä¹Ÿæ˜¯ä¸€æ ·çš„\n\n```php\n$item = $this->repository->findAll([\n    'id:!='         => 2,\n    'username:like' => '%test%',\n    'status:>='     => 4,\n])\n```\n\n**åŒæ ·æ˜¯ æŸ¥è¯¢å­—æ®µ:æ“ä½œç¬¦ => 'æŸ¥è¯¢çš„å€¼'**\n\n##### 1.5.1.5 å…¶ä»–è¯´æ˜\n\n`update` å’Œ `create` æ–¹æ³•åŒæ ·æ”¯æŒè¡¨è¾¾å¼æŸ¥è¯¢ï¼Œéƒ½æ˜¯ä½¿ç”¨`findCondition($condiitons)` æ–¹æ³•å¤„ç†\n\n1. [update çš„ä½¿ç”¨è¯´æ˜](#12-ç¼–è¾‘æ•°æ®-updateconditions-array-data)\n2. [delete çš„ä½¿ç”¨è¯´æ˜](#13-åˆ é™¤æ•°æ®-deleteconditions)\n\n#### 1.5.2 ä½¿ç”¨ `model` çš„ `scope` æŸ¥è¯¢\n\n>ä¸¾ä¸ªğŸŒ°æ —å­,ä½ æœ‰ä¸€å¼ ç”¨æˆ·è¡¨ users, ç”¨æˆ·è¡¨çš„æ‰©å±•ä¿¡æ¯å­˜åœ¨ user_ext é‡Œ;\nç°åœ¨ä½ æƒ³æŸ¥è¯¢ç”¨æˆ·åœ°å€åœ¨æŒ‡å®šä½ç½®ä¿¡æ¯çš„æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯, é‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨`scope` æŸ¥è¯¢äº†\n\nè¦æ±‚modelå®šä¹‰äº†`scope`æŸ¥è¯¢\n\n##### 1. model \n\n```php\n\nclass User extends Model\n{\n    protected $table      = 'users';\n    protected $primaryKey = 'user_id';\n    public    $columns    = [\n        'user_id',\n        'username',\n        \/\/...\n        'created_at',\n        'updated_at',\n    ];\n \n  \n    \/**\n     * å®šä¹‰å…³è”æ‰©å±•ä¿¡æ¯\n     * \n     * return Illuminate\\Database\\Eloquent\\Relations\\HasOne\n     *\/\n    public function extInfo()\n    {\n      return $this->hasOne(UserExt::class, 'user_id', 'user_id');\n    }\n \n\n    \/**\n     * æ ¹æ®åœ°å€æŸ¥è¯¢\n     *\n     * @param \\Illuminate\\Database\\Eloquent\\Builder $query   æŸ¥è¯¢å¯¹è±¡\n     * @param string                                $address åœ°å€ä¿¡æ¯\n     * @return \\Illuminate\\Database\\Eloquent\\Builder\n     *\/\n    public function scopeAddress($query, $address)\n    {\n        return $query->leftJoin('user_ext', 'user_ext.user_id', '=', 'users.user_id')\n            ->where('user_ext.address', '=', $address);\n    }\n}   \n\n```\n\n##### 2. ä½¿ç”¨ `repository` æŸ¥è¯¢\n\n```php\n\n$this->userRepositoy->findAll([\n    'status'  => 1,\n    'address' => 'åŒ—äº¬'\n]);\n\n```\n\n##### 3. æŸ¥è¯¢çš„SQL\n\n```sql\n\nselect \n    * \nfrom \n    `users` \nleft join \n    `user_ext` on (`user_ext`.`user_id` = `users`.`user_id`) \nwhere \n    `users.status` = 1 and `user_ext`.`address` = 'åŒ—äº¬'\n    \n```\n##### 4 ä½¿ç”¨è¯´æ˜\n\nä»ä¸Šé¢çš„SQLå’Œå®¹æ˜“å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œæ²¡æœ‰æŒ‡å®šæŸ¥è¯¢å­—æ®µï¼Œé»˜è®¤æŸ¥è¯¢çš„ `*` æ‰€æœ‰å­—æ®µï¼Œå¦‚æœ`users`è¡¨å’Œ`user_ext`\nè¡¨çš„å­—æ®µæ²¡æœ‰å†²çªï¼Œé‚£ä¹ˆæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æœæœ‰å†²çªï¼Œé‚£ä¹ˆæŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¯èƒ½å’Œä½ æƒ³è±¡çš„ä¸ä¸€æ ·ï¼Œç‰¹åˆ«åœ¨è¿˜æœ‰\nå…³è”æŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿™ä¸ªé—®é¢˜æ›´å®¹æ˜“å‡¸æ˜¾å‡ºæ¥ï¼Œæ‰€ä»¥å»ºè®®åœ¨æœ‰è¿è¡¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œæœ€å¥½æœ‰åŠ ä¸Šä½ éœ€è¦æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯\n\n```php\n$this->userRepository->findAll([\n    'status'  => 1,\n    'address' => 'åŒ—äº¬',\n], ['users.*'])\n```\n\n#### 1.5.4 è·å– `model` çš„ `relation` å…³è”æ•°æ®ä¿¡æ¯\n\nå½“æˆ‘ä»¬æŸ¥è¯¢æ•°æ®æ—¶å€™ï¼Œä¹Ÿæƒ³æŠŠå…³è”æ•°æ®æŸ¥è¯¢å‡ºæ¥çš„æ—¶å€™ï¼Œå°±ä¼šç”¨åˆ°å…³è”æŸ¥è¯¢\n\nä½¿ç”¨çš„æ˜¯`model`çš„`with`æ–¹æ³•\n\n>ä¸¾ä¸ªğŸŒ°æ —å­,ä½ æœ‰ä¸€å¼ ç”¨æˆ·è¡¨users,ç”¨æˆ·è¡¨çš„æ‰©å±•ä¿¡æ¯å­˜åœ¨user_exté‡Œ \nä¹Ÿè®¸ä½ æƒ³æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™åŒæ—¶æŸ¥å‡ºç”¨æˆ·çš„æ‰©å±•ä¿¡æ¯\n\nè¦æ±‚`model`å®šä¹‰äº†å…³è”\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\n1. ä½¿ç”¨ `repository` è·å–å…³è”æ•°æ®ä¿¡æ¯, é€šè¿‡æŸ¥è¯¢å­—æ®µï¼Œè‡ªåŠ¨å¤„ç†å…³è”\n\n    æŸ¥è¯¢å­—æ®µä¸­æ·»åŠ  `å…³è”å…³ç³»` => [`å…³è”æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯`]\n    \n    ```php\n        $users = $this->repository->findAll(['status' => 1], ['*', 'extInfo' => ['*']]);\n    ```\n\n2. æŸ¥è¯¢SQL \n\n    [è¿™é‡Œä½¿ç”¨é¢„åŠ è½½æ•°æ®](https:\/\/learnku.com\/docs\/laravel\/5.5\/eloquent-relationships\/1333#012e7e), é¿å…N+1é—®é¢˜\n\n    ```sql\n    select * from `users` where `users`.`status` = 1\n    \n    select * from `user_ext` where `user_id` in (1, 2, 3, 4)\n    ```\n\n3. æ•°æ®ä¿¡æ¯\n\n    ![å…³è”çš„æ•°æ®](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/relation.png 'å…³è”çš„æ•°æ®')\n\n##### 1.5.4.1\n    \n1. ä¸Šé¢æœ‰ä¸ªå°çš„é—®é¢˜ï¼Œ`model`å®šä¹‰çš„å…³è”åç§°ä¸º`extInfo`, ä½†æ˜¯å‡ºæ¥æ•°ç»„å¯¹åº”çš„å­—æ®µä¿¡æ¯ä¸º\n `ext_info` , å¹¶ä¸”æŸ¥è¯¢æŒ‡å®šå­—æ®µä¿¡æ¯ä¹Ÿæ˜¯ä¸º`extInfo` (`'extInfo' => ['*']`), æŸ¥è¯¢\n å‡ºæ¥çš„æ•°æ®æ˜¯`laravel` `model` çš„ `toArray()` æ–¹æ³•å¤„ç†çš„ç»“æœ,ä¼šå°†`å°é©¼å³°`å‘½åçš„\n å…³è”ä¿¡æ¯è½¬ä¸º`è›‡å½¢`å‘½åå­—æ®µï¼Œ`repository`æŸ¥è¯¢å­—æ®µæ”¯æŒ`å°é©¼å³°`å’Œ`è›‡å½¢`å‘½åï¼Œä¾‹å¦‚ï¼š\n     \n     ```php\n        $users = $this->repository->findAll(['status' => 1], ['*', 'ext_info' => ['*]])\n     ``` \n       \n     å’Œä¸Šé¢çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä¸ºäº†æ›´å¥½çš„ä¸€è‡´æ€§ï¼Œå»ºè®®`model`åœ¨å®šä¹‰è”æŸ¥è¯¢å‘½åçš„æ—¶å€™ï¼Œä½¿ç”¨å•ä¸ªå•è¯çš„å•å¤æ•°å½¢å¼æ¯”è¾ƒå¥½\n\n2. åœ¨æŸ¥è¯¢æ—¶å€™æŒ‡å®šå­—æ®µï¼Œå¹¶ä¸”æŒ‡å®šæŸ¥è¯¢å…³è”æŸ¥è¯¢å­—æ®µ\n\n    ```php\n    $users = $this->userRepository->findAll(['status' => 1], ['username', 'extInfo' => ['address']]);\n    ```    \n   \n   ä¸Šé¢æŸ¥è¯¢æŒ‡å®šäº†æŸ¥è¯¢çš„å­—æ®µï¼Œä½†æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ²¡æœ‰æŒ‡å®šå‡ºå…³è”è¡¨æŸ¥è¯¢éœ€è¦çš„å­—æ®µ `user_id` å­—æ®µä¿¡æ¯ï¼Œä¼šå¯¼è‡´å…³è”ä¿¡æ¯å…³è”ä¸ä¸Šçš„é—®é¢˜\n   **ä½†`repository`è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¼šè‡ªåŠ¨åŠ ä¸Šå…³è”æŸ¥è¯¢éœ€è¦çš„å­—æ®µä¿¡æ¯**ï¼Œæ‰€ä»¥æœ€ç»ˆæŸ¥è¯¢çš„SQLå’Œæ•°æ®å¦‚ä¸‹:\n   \n   ![å…³è”çš„æ•°æ®](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/relation-1.png 'å…³è”çš„æ•°æ®')\n   \n   >è¿™å¯èƒ½ä¼šè®©äººè®¤ä¸ºæˆ‘æ˜æ˜åªæŸ¥è¯¢äº†`username`å­—æ®µï¼Œæ€ä¹ˆè¿˜æŸ¥å‡ºäº†å…¶ä»–å­—æ®µä¿¡æ¯\n   \n   **åªæœ‰åœ¨å…³è”æŸ¥è¯¢çš„æ—¶å€™ï¼Œæ²¡æœ‰æŒ‡å®šæŸ¥è¯¢å…³è”å­—æ®µï¼Œæ‰ä¼šè‡ªåŠ¨åŠ ä¸Šå…³è”å­—æ®µ**\n   \n#### 1.5.5 è·å– `model` çš„ `relation` å…³è”ç»Ÿè®¡æ•°æ®ä¿¡æ¯\n\nè¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒé€‚åˆä¸€å¯¹å¤šçš„æ—¶å€™ï¼Œæˆ‘æƒ³çŸ¥é“å…³è”çš„å…¶ä»–ä¿¡æ¯æœ‰å¤šå°‘\n\nåªè¦å®šä¹‰äº†`model`çš„å…³è”ä¿¡æ¯ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ï¼Œå…¶å®å°±æ˜¯ `model` çš„ `withCount`\n\n>`model`å®šä¹‰çš„`å…³è”æ–¹æ³•åç§°_count`\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\n```php\n$user = $this->repositoy->find(['status' => 1], ['id', 'username', 'extInfo_count']);\n```\n\næ‰§è¡ŒSQLä»¥åŠæ•°æ®\n\n![å…³è”çš„æ•°æ®](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/relation-2.png 'å…³è”çš„æ•°æ®')\n\n#### 1.5.6 ç»™ `model` çš„ `relation` å…³è”æŸ¥è¯¢åŠ¨æ€æ·»åŠ æŸ¥è¯¢æ¡ä»¶\n\næŸ¥è¯¢æ¡ä»¶ä¸­æ·»åŠ  `modelå®šä¹‰å…³è”æ–¹æ³•åç§°.å­—æ®µ` => 'æŸ¥è¯¢çš„å€¼'\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\nä¾‹å¦‚ï¼š\n\n```php\n\n$users = $this->repository->findAll([\n    'status'                => 1,\n    'extInfo.address'       => 'åŒ—äº¬',\n    'extInfo.created_at:gt' => '2019-02-01 00:00:00', \/\/ åŒæ ·æ”¯æŒè¡¨è¾¾å¼æŸ¥è¯¢\n], ['extInfo' => ['*']])\n\n```\næ‰§è¡Œçš„SQLï¼š\n```sql\nselect * from `users` where `users`.`status` = 1\n\nselect * from `user_ext` where \n    `user_ext`.`address` = 'åŒ—äº¬' and \n    `user_ext`.`created_at` > '2019-02-01 00:00:00' and \n    `user_ext`.`user_id` in (1, 2, 3, 4)\n```\n\n##### 1.5.6.1 model ä¹Ÿå¯ä»¥å®šä¹‰é»˜è®¤å…³è”çš„æŸ¥è¯¢æ¡ä»¶\n\néœ€è¦åœ¨`model`é‡Œé¢å®šä¹‰ `å…³è”æ–¹æ³•åç§°Filters` çš„å±æ€§ä¿¡æ¯\n\n```php\n    class User extends Model\n    {\n        protected $table      = 'users';\n        protected $primaryKey = 'user_id';\n        public    $columns    = [\n            'user_id',\n            'username',\n            \/\/...\n            'created_at',\n            'updated_at',\n        ];\n        \n        \/**\n         * ä¸ºå…³è”å®šä¹‰é»˜è®¤æŸ¥è¯¢æ¡ä»¶\n         *\n         * @var array\n         *\/\n        public $extInfoFilters = [\n            'address' => 'åŒ—äº¬', \n            \/\/ 'ddress:like' => 'åŒ—äº¬', \/\/ å…è®¸ä½¿ç”¨è¡¨è¾¾å¼æ–¹å¼\n        ];\n     \n        \/**\n         * å®šä¹‰å…³è”æ‰©å±•ä¿¡æ¯\n         * \n         * return Illuminate\\Database\\Eloquent\\Relations\\HasOne\n         *\/\n        public function extInfo()\n        {\n          return $this->hasOne(UserExt::class, 'user_id', 'user_id');\n        }\n     \n    \n        \/**\n         * æ ¹æ®åœ°å€æŸ¥è¯¢\n         *\n         * @param \\Illuminate\\Database\\Eloquent\\Builder $query   æŸ¥è¯¢å¯¹è±¡\n         * @param string                                $address åœ°å€ä¿¡æ¯\n         * @return \\Illuminate\\Database\\Eloquent\\Builder\n         *\/\n        public function scopeAddress($query, $address)\n        {\n            return $query->leftJoin('user_ext', 'user_ext.user_id', '=', 'users.user_id')\n                ->where('user_ext.address', '=', $address);\n        }\n    }   \n```\n  \nè¯´æ˜ï¼š å…³è”æŸ¥è¯¢ã€ç»Ÿè®¡æŸ¥è¯¢éƒ½ä¼šæ·»åŠ é»˜è®¤å…³è”æŸ¥è¯¢æ¡ä»¶\n\nä½¿ç”¨å®šä¹‰äº†é»˜è®¤å…³è”æŸ¥è¯¢æ¡ä»¶è¿›è¡ŒæŸ¥è¯¢\n\n```php\n$users = $this->repository->findAll(['status' => 1], ['extInfo' => ['*']])\n```\n\næ‰§è¡Œçš„SQLï¼š\n\n```sql\nselect * from `users` where `users`.`status` = 1\n\nselect * from `user_ext` where \n    `user_ext`.`address` = 'åŒ—äº¬' \n    `user_ext`.`user_id` in (1, 2, 3, 4)\n```\n\n**é»˜è®¤å…³è”æŸ¥è¯¢æ¡ä»¶å’ŒåŠ¨æ€å…³è”æŸ¥è¯¢æ¡ä»¶æ˜¯å åŠ çš„**\n\n#### 1.5.7 è¿‡æ»¤ç©ºå€¼æŸ¥è¯¢\n\n**ç©ºå­—ç¬¦ä¸²ã€ç©ºæ•°ç»„ã€nullä¼šè¢«è®¤ä¸ºç©ºå€¼**\n\n1. æŸ¥è¯¢å•ä¸ª filterFind($conditions, $columns = [])\n\n    ```php\n    $item = $this->repositpry->filterFind([\n        'username:like' => request()->input('username'),\n        'status'        => request()->input('status')\n    ]);\n    ```\n\n2. æŸ¥è¯¢å¤šä¸ª filterFindAll($conditions, $columns = [])\n\n    ```php\n    $items = $this->repositpry->filterFindAll([\n        'username:like' => request()->input('username'),\n        'status'        => request()->input('status')\n    ]);\n    ```\n3. è·å–è¿‡æ»¤ç©ºå€¼æŸ¥è¯¢çš„model getFilterModel($conditions, $columns = [])\n\n    ```php\n    $model = $this->repositpry->getFilterModel([\n        'username:like' => request()->input('username'),\n        'status'        => request()->input('status')\n    ]);\n    ```\n    \n>è¿™å‡ ä¸ªæ–¹æ³•ï¼Œç›¸å½“äº [when æ¡ä»¶æŸ¥è¯¢](https:\/\/learnku.com\/docs\/laravel\/5.5\/queries\/1327#conditional-clauses)\nåœ¨å’Œå‰ç«¯äº¤äº’æ—¶ï¼Œä¸ç¡®å®šå‰ç«¯æ˜¯å¦ä¼ é€’å€¼æ¥è¿›è¡ŒæŸ¥è¯¢æ—¶å€™ï¼Œæ¯”è¾ƒæ–¹ä¾¿\n\n```php\n\/\/ å¹³æ—¶å†™æ³•\n$conditions = [];\n\nif ($username = request()->input('username')) {\n    $conditions['username:like'] = $username;\n}\n\nif ($status = request()->input('status')) {\n    $conditions['status'] = $status;\n}\n\n$items = $this->repository->findAll($conditions);\n\n\/\/ ä½¿ç”¨ filter è¿‡æ»¤æŸ¥è¯¢\n$items = $this->repositpry->filterFindAll([\n    'username:like' => request()->input('username'),\n    'status'        => request()->input('status')\n]);\n```\n\n#### 1.5.8 ä½¿ç”¨ `findWhere` æ„å»ºå¤æ‚æŸ¥è¯¢\n\n> `findWhere(array $where, $array $columns = [])`\n\n```php\n$this->userRespository->findWhere([\n    'and',\n    ['username' => 1, 'name:like' => '%test%'],\n    ['or', ['level' => 10, 'level:eq' => 5]],\n    ['and', ['status' => 1, 'age' => 1]],   \n])->get();\n\n```\n\næ‰§è¡Œçš„SQL\n\n```sql\nselect * from `users` where \n    (`username` = 1 and `name` like '%test%') and \n    (`level` = 10 or `level` = 5) and \n    (`status` = 1 and `age` = 1)\n```\n\n`where`æŸ¥è¯¢æ¡ä»¶è¯´æ˜\n\næ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ å®šä¹‰æŸ¥è¯¢æ¡ä»¶è¿æ¥æ–¹å¼(åé¢æ•°ç»„çš„æŸ¥è¯¢æ¡ä»¶æ€ä¹ˆè¿æ¥`or` æˆ–è€… `and`)ï¼Œå¦‚æœæ˜¯`and`è¿æ¥\nå¯ä»¥å¿½ç•¥ä¸å†™,ä¸€å®šè¦æ˜¯å¤šç»´æ•°ç»„\n\nç¬¬ä¸€ä¸ª`and`å¿½ç•¥ä¸å†™\n```php\n$where = [\n['status' => 1]ï¼Œ\n['name' => 2]\n];\n\n\/\/ where `status` = 1 and `name` = 2 \n```\n\nä½¿ç”¨ `or` è¿æ¥\n```php\n$where = [\n    \/\/ or å®šä¹‰ åé¢çš„æŸ¥è¯¢æ¡ä»¶ é€šè¿‡ or è¿æ¥\n    'or',\n    ['status' => 1],\n    ['age' => 1],\n    \n    \/\/ and å®šä¹‰æ•°ç»„é‡Œé¢åé¢çš„æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ and è¿æ¥\n    ['and', ['name', '=', 123], ['username', 'like', 'test']],\n];\n\n\/\/ where `status` = 1 or `age` = 1 or (`name` = 123 and `username` like 'test')\n```\n\n#### 1.5.9 ä½¿ç”¨ `join` æŸ¥è¯¢\n\n>`leftJoin` å’Œ `rightJoin` å’Œ `join` ä½¿ç”¨ä¸€è‡´\n\n##### 1. ç®€å•`join`\n\n```php\n$this->repository->findAll([\n    'join' => ['users', 'users.school_id', '=', 'school.id']\n]);\n\n```\n\n```sql\nselect `school`.* from `school` inner join `users` on (`users`.`school_id` = `school`.`id`)\n```\n\n##### 2. ä¸€æ¬¡å¤šä¸ª`join`\n```php\n$this->repository->findAll([\n    'join' => [\n        ['users', 'users.school_id', '=', 'school.id'],\n        ['school as s1', 's1.parent_id', '=', 'school.id']\n    ]\n]);\n\n```\n\n```sql\nselect \n    `school`.* \nfrom \n    `school` \ninner join `users` on (`users`.`school_id` = `school`.`id`) \ninner join `school` as `s1` on (`s1`.`parent_id` = `school`.`id`)\n```\n\n##### 3. ä½¿ç”¨å…³è”å…³ç³»å¯¹åº”join\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\n```php\n$users = $this->repository->findAll(['status' => 1, 'joinWith' => 'extInfo']);\n```\n\n```sql\nselect \n    `users`.* \nfrom \n    `users` \ninner join `user_ext` on `user_ext`.`user_id` = `users`.`user_id`\nwhere `users`.`status` = 1\n```\n\n##### 4. ä½¿ç”¨å…³è”å…³ç³»å¯¹åº”joinå¹¶è®¾ç½®åˆ«å\n\n>['åˆ«å' => 'å…³è”æ–¹æ³•åç§°']\n\n```php\n$users = $this->repository->findAll(['status' => 1, 'joinWith' => ['ext' => 'extInfo']]);\n```\n\n```sql\nselect \n    `users`.* \nfrom \n    `users` \ninner join `user_ext` as `ext` on `ext`.`user_id` = `users`.`user_id` \nwhere `users`.`status` = 1\n```\n\n##### 5. ä¸º`join`æ·»åŠ æŸ¥è¯¢æ¡ä»¶\n\n>é€šè¿‡ ['__joinè¡¨åç§°.å­—æ®µ' => 'å¯¹åº”çš„å€¼'], ç›®å‰æ²¡æœ‰æ¯”è¾ƒç›´è§‚çš„æ–¹å¼å¤„ç†ã€å› ä¸º `order.user_id` æ–¹å¼è¢«å…³è”å…³ç³»çš„é™„åŠ æ¡ä»¶å ç”¨äº†\n\n```php\n$users = $this->repository->findAll([\n    'status'        => 1, \n    'joinWith'      => ['ext' => 'extInfo']ï¼Œ\n    '__ext.user_id' => 1,\n]);\n```\n\n```sql\nselect \n    `users`.* \nfrom \n    `users` \ninner join `user_ext` as `ext` on `ext`.`user_id` = `users`.`user_id`\nwhere `users`.`status` = 1 and `ext`.`user_id` = 1\n```\n\n## äºŒ å…³äºæŸ¥è¯¢ä¸­çš„`$conditions`å’Œ`$columns`ä¿¡æ¯è¯´æ˜\n\n>`$conditions`ä¸º`sql`æŸ¥è¯¢å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼Œ`$columns`ä¸º`sql`çš„`select`æ·»åŠ æŒ‡å®šçš„æŸ¥è¯¢å­—æ®µ\n\n### 2.1 `$conditions` æŸ¥è¯¢æ¡ä»¶\n\n1. æ”¯æŒå­—æ®µç²¾å‡†æŸ¥è¯¢(è¡¨ä¸­å­—æ®µçš„æŸ¥è¯¢)\n2. é¢„å®šæœ‰å­—æ®µæŸ¥è¯¢[å‚è€ƒ](#211-é¢„å®šä¹‰çš„å­—æ®µ)\n3. æ”¯æŒè¡¨è¾¾å¼æŸ¥è¯¢[å‚è€ƒ](#15-æŸ¥è¯¢è¿›é˜¶ä½¿ç”¨)\n4. æ”¯æŒå…³è”æ¡ä»¶æŸ¥è¯¢[å‚è€ƒ](#156-ç»™-model-çš„-relation-å…³è”æŸ¥è¯¢åŠ¨æ€æ·»åŠ æŸ¥è¯¢æ¡ä»¶)\n5. æ”¯æŒ`model`çš„`scope`[å‚è€ƒ](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\nä¾‹å¦‚ï¼š\n\n```php\n$conditions = [\n    \/\/ è¡¨ä¸­å­—æ®µç²¾å‡†æŸ¥è¯¢\n    'status' => 1,\n    'id'     => [1, 2, 3, 4], \/\/ å€¼ä¸ºæ•°ç»„ä¼šè‡ªåŠ¨è½¬ä¸ºinæŸ¥è¯¢ `id` in (1, 2, 3, 4)\n    \n    \/\/ é¢„å®šä¹‰å­—æ®µæŸ¥è¯¢\n    'order' => 'id desc' \/\/ æŒ‡å®šæ’åºå­—æ®µå’Œæ–¹å¼\n    'limit' => 10,       \/\/ é™åˆ¶æŸ¥è¯¢æ¡ä»¶\n    'group' => 'id',     \/\/ æŒ‡å®šåˆ†ç»„æ¡ä»¶\n    'force' => 'name',   \/\/ æŒ‡å®šä½¿ç”¨çš„ç´¢å¼•\n  \n    \/\/ join å…³è”æŸ¥è¯¢\n    'join'     => ['users', 'users.user_id', '=', 'orders.user_id'],\n    'leftJoin' => [\n        \/\/ å¤šä¸ªleftJoin\n        ['users as u1', 'u1.user_id', '=', 'orders.user_id'],\n        ['user_image', 'users_image.user_id', '=', 'users.user_id'],\n    ],\n\n    \/\/ è¡¨è¾¾å¼æŸ¥è¯¢\n    'username:like'      => 'test',                                         \/\/ æ¨¡ç³ŠæŸ¥è¯¢\n    'created_at:between' => ['2019-01-02 00:00:00', '2019-01-03 23:59:59'], \/\/ åŒºé—´æŸ¥è¯¢\n    'id:ge'              => 12, \/\/ id > 12\n    ...\n    \n    \/\/ relation å…³è”æŸ¥è¯¢,æŸ¥è¯¢æ¡ä»¶åªå¯¹å½“å‰relationå…³è”æŸ¥è¯¢é™åˆ¶\n    'extInfo.address:like'   => 'åŒ—äº¬',\n    'extInfo.created_at:gte' => '2019-01-01 00:00:00',\n    \n    \/\/ é€šè¿‡ relation å…³è”å…³ç³»ï¼Œæ·»åŠ join æŸ¥è¯¢\n    'joinWith'     => ['extInfo'],\n    \/\/ å…³è”è¡¨å®šä¹‰åˆ«å alias, å¦‚æœæ²¡æœ‰åˆ«åï¼Œå…³è”è¡¨å’Œä¸»è¡¨åŒåï¼Œä½¿ç”¨è‡ªå®šä¹‰åˆ«å `t1`, å¤šä¸ªåŒåä»¥æ­¤åœ°å€ `t2`ã€`t3`\n    'leftJoinWith' => ['alias' => 'children'], \n    \n    \/\/ scope è‡ªå®šä¹‰æŸ¥è¯¢\n    'address'  => 'åŒ—äº¬',     \/\/ æŸ¥æ‰¾`scopeAddress($query, $address)`æ–¹æ³•\n    'children' => [1, 2, 3],  \/\/ æŸ¥æ‰¾`scopeChildren($query, $childrenIds)`æ–¹æ³•\n];\n```\n\n#### 2.1.1 é¢„å®šä¹‰çš„å­—æ®µ\n\n|å­—æ®µåç§°|å­—æ®µå€¼ç±»å‹|è¯´æ˜|\n|-------|---------|----|\n|`force`|`string`|å¼ºåˆ¶èµ°æŒ‡å®šç´¢å¼•|\n|`order`|`string or array`|æŒ‡å®šæ’åºæ¡ä»¶|\n|`limit`|`int`|æŒ‡å®šæŸ¥è¯¢æ¡æ•°|\n|`offset`|`int`|æŒ‡å®šè·³è½¬ä½ç½®|\n|`group`|`string`|æŒ‡å®šåˆ†ç»„å­—æ®µ|\n|`join`|`array`|æŸ¥è¯¢joinçš„å‚æ•°ï¼Œå¤šä¸ªäºŒç»´æ•°ç»„|\n|`leftJoin`|`array`|æŸ¥è¯¢`leftJoin`çš„å‚æ•°ã€å¤šä¸ªäºŒç»´æ•°ç»„|\n|`rightJoin`|`array`|æŸ¥è¯¢`rightJoin`çš„å‚æ•°ã€å¤šä¸ªäºŒç»´æ•°ç»„|\n|`joinWith`|`string or array`| é€šè¿‡å…³è”å…³ç³»å¯¹åº”joinæŸ¥è¯¢|\n|`leftJoinWith`|`string or array`| é€šè¿‡å…³è”å…³ç³»å¯¹åº”leftJoinæŸ¥è¯¢|\n|`rightJoinWith`|`string or array`| é€šè¿‡å…³è”å…³ç³»å¯¹åº”rightJoinæŸ¥è¯¢|\n\n### 2.2 `$columns` æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯\n\n1. æ”¯æŒæœ¬è¡¨å­—æ®µæŸ¥è¯¢\n2. æ”¯æŒå…³è”ç»Ÿè®¡å­—æ®µæŸ¥è¯¢\n3. æ”¯æŒå…³è”æ•°æ®å­—æ®µæŸ¥è¯¢\n\n```php\n$columns = [\n\n    \/\/ æœ¬è¡¨çš„å­—æ®µæŸ¥è¯¢\n    'id',\n    'username',\n\n    \/\/ å…³è”è¡¨çš„å­—æ®µæŸ¥è¯¢\n    'users.username',\n    'users.age',\n    \n    \/\/ ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢\n    DB::raw('SUM(`users`.`age`) AS `sum_age`'),\n    \n    \/\/ å…³è”ç»Ÿè®¡å­—æ®µæŸ¥è¯¢\n    'extInfo_count',  \/\/ å¯¹åº”`model`å®šä¹‰çš„ extInfo å…³è”\n    'children_count', \/\/ å¯¹åº”`model`å®šä¹‰çš„ children å…³è”\n    \n    \/\/ å…³è”è¡¨å­—æ®µæŸ¥è¯¢\n    'extInfo'  => ['*'], \/\/ å¯¹åº”`model`å®šä¹‰çš„ extInfo å…³è”\n    'children' => ['*'], \/\/ å¯¹åº”`model`å®šä¹‰çš„ children å…³è”\n];\n```\n\n## ä¸‰ æ–¹æ³•åˆ—è¡¨\n\n### 3.1 æ–¹æ³•åˆ—è¡¨\n\n>repositoryæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¯¹å¤–çš„ï¼Œè¿™é‡Œåªåˆ—å‡ºå¸¸ç”¨æ–¹æ³•\n\n|æ–¹æ³•åç§°|è¿”å›å€¼|æ–¹æ³•è¯´æ˜|\n|-------|-----|-------|\n|`find($conditions, $columns = [])`|`array or false`|æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n|`findBy($conditions, $column)`|`mixed`|æŸ¥è¯¢å•æ¡æ•°æ®çš„å•ä¸ªå­—æ®µ|\n|`findAll($conditions, $columns = [])`|`array`|æŸ¥è¯¢å¤šæ¡æ•°æ®|\n|`findAllBy($conditions, $column)`|`array`|æŸ¥è¯¢å¤šæ¡æ•°ç»„çš„å•ä¸ªå­—æ®µæ•°ç»„|\n|`filterFind($conditions, $columns = [])`|`array or false`|è¿‡æ»¤æŸ¥è¯¢æ¡ä»¶ä¸­çš„ç©ºå€¼æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n|`filterFindAll($condtions, $columns = [])`|`array`|è¿‡æ»¤æŸ¥è¯¢æ¡ä»¶ä¸­çš„ç©ºå€¼æŸ¥è¯¢å¤šæ¡æ•°æ®|\n|`paginate($conditions = [], $columns = [], $size = 10, $current = null)`|`array`|åˆ†é¡µæŸ¥è¯¢æ•°æ®|\n|`filterPaginate($conditions = [], $columns = [], $size = 10, $current = null)`|`array`|è¿‡æ»¤æŸ¥è¯¢æ¡ä»¶ä¸­çš„ç©ºå€¼åˆ†é¡µæŸ¥è¯¢æ•°æ®|\n|`getFilterModel($conditions, $columns = [])`|`Illuminate\\Database\\Eloquent\\Model`|è·å–å·²ç»è¿‡æ»¤å¤„ç†æŸ¥è¯¢æ¡ä»¶çš„`model`|\n|`findCondition($conditions = [], $columns = [])`|`Illuminate\\Database\\Eloquent\\Model`|è·å–å·²ç»å¤„ç†æŸ¥è¯¢æ¡ä»¶çš„`model`(**ä¸Šé¢æ‰€æœ‰æŸ¥è¯¢æ–¹æ³•éƒ½åŸºäºè¿™ä¸ªæ–¹æ³•**)|\n|`create(array $data)`|`array`|æ·»åŠ æ•°æ®|\n|`update($conditions, array $data)`|`array`|ä¿®æ”¹æ•°æ®(ä½¿ç”¨çš„æ˜¯æ‰¹é‡ä¿®æ”¹)|\n|`delete($conditions)`|`array`|åˆ é™¤æ•°æ®(ä½¿ç”¨çš„æ˜¯æ‰¹é‡åˆ é™¤)|\n|`findWhere(array $where, $columns = [])`|`Illuminate\\Database\\Eloquent\\Model`|è·å–é€šè¿‡æ•°ç»„æŸ¥è¯¢çš„`model`\n\n#### å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array or string or int`|æŸ¥è¯¢æ¡ä»¶(`string or int or ç´¢å¼•æ•°ç»„[1, 2, 3, 4]`ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºä¸»é”®æŸ¥è¯¢)|\n|`$columns`|`array`|æŸ¥è¯¢çš„å­—æ®µæ•°ç»„|\n|`$column`|`string`|æŸ¥è¯¢çš„å­—æ®µåç§°|\n|`$data`|`array`|åˆ›å»ºæˆ–è€…ä¿®æ”¹çš„æ•°ç»„æ•°æ®ä¿¡æ¯|\n|`$where`|`array`|æŸ¥è¯¢æ¡ä»¶|\n\n### 3.2 æ”¯æŒ`model`è‡ªå¸¦æ–¹æ³•\n\n|æ–¹æ³•åç§°    |è¿”å›å€¼| æ–¹æ³•è¯´æ˜ |\n|---------------|-------------|----------|\n|`getConnection()`|`Illuminate\\Database\\Connection`|è·å–è¿æ¥ä¿¡æ¯|\n|`insert(array $values)`|`boolean`|æ–°å¢æ•°æ®(æ”¯æŒæ‰¹é‡æ–°å¢)|\n|`insertGetId(array $values)`|`int`|æ–°å¢æ•°æ®å¹¶è·å–æ–°å¢ID|\n|`firstOrCreate(array $attributes, array $value = [])`|`Illuminate\\Database\\Eloquent\\Model`|æŸ¥è¯¢æ•°æ®ï¼Œä¸å­˜åœ¨é‚£ä¹ˆæ–°å¢ä¸€æ¡æ•°æ®|\n|`firstOrNew(array $attributes, array $value = [])`|`Illuminate\\Database\\Eloquent\\Model`|æŸ¥è¯¢æ•°æ®ã€ä¸å­˜åœ¨é‚£ä¹ˆ`new`å‡ºæ¥|\n|`updateOrCreate(array $attributes, array $value = [])`|`Illuminate\\Database\\Eloquent\\Model`|ä¿®æ”¹æ•°æ®ï¼Œä¸å­˜åœ¨é‚£ä¹ˆæ–°å¢ä¸€æ¡æ•°æ®|\n|`findOrFail($id, $columns = ['*'])`|`Illuminate\\Database\\Eloquent\\Model`|é€šè¿‡ä¸»é”®æŸ¥è¯¢æ•°æ®ï¼Œä¸å­˜åœ¨æŠ›å‡ºé”™è¯¯|\n|`findOrNew($id, $columns = ['*'])` |`Illuminate\\Database\\Eloquent\\Model`|é€šè¿‡ä¸»é”®æŸ¥è¯¢æ•°æ®ï¼Œä¸å­˜åœ¨`new`å‡ºæ¥|\n|`findMany($ids, $columns = ['*'])`|`\\Illuminate\\Database\\Eloquent\\Collection`|é€šè¿‡ä¸»é”®æ•°ç»„æŸ¥è¯¢å¤šæ¡æ•°æ®|\n\n#### å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$attributes`|`array`|`model`çš„å­—æ®µä¿¡æ¯(æŸ¥è¯¢æ¡ä»¶)|\n|`$value`|`array or null`|`model`çš„å…¶ä»–å­—æ®µä¿¡æ¯(ä¸å‚ä¸æŸ¥è¯¢ã€å‚ä¸æ–°å¢å’Œ`new`)\n|`$values`|`array`|æ–°å¢æ•°æ®éœ€è¦çš„å­—æ®µ => å€¼ æ•°ç»„ä¿¡æ¯\n|`$id`|`int or string`|ä¸»é”®IDå€¼|\n|`$ids`|`array`|ä¸»é”®IDæ•°ç»„|\n|`$columns`|`array`|æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯|\n\n### 3.3 é€šè¿‡`findCondition($conditions)`æŸ¥è¯¢åè½¬æ¢ä¸º`model`æŸ¥è¯¢æ–¹æ³•\n\n|æ–¹æ³•åç§°|è¿”å›å€¼|æ–¹æ³•è¯´æ˜|\n|---------------|-------------|----------|\n|`first($conditions, $columns = ['*'])`|`Illuminate\\Database\\Eloquent\\Model or null`|æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n|`get($conditions, $columns = ['*'])`|`Illuminate\\Database\\Eloquent\\Collection`|æŸ¥è¯¢å¤šæ¡æ•°æ®|\n|`pluck($conditions, $column, $key = null)`|`Illuminate\\Support\\Collection`|æŸ¥è¯¢å•ä¸ªå­—æ®µä¿¡æ¯|\n|`firstOrFail($conditions)`|`Illuminate\\Database\\Eloquent\\Model`|æŸ¥è¯¢ä¸€æ¡æ•°æ®ã€æ²¡æœ‰é‚£ä¹ˆæŠ›å‡ºé”™è¯¯|\n|`count($conditions = [])`|`int`|ç»Ÿè®¡æŸ¥è¯¢|\n|`max($conditions, $column)`|`int or mixed`|æœ€å¤§å€¼æŸ¥è¯¢|\n|`min($conditions, $column)`|`int or mixed`|æœ€å°å€¼æŸ¥è¯¢|\n|`avg($conditions, $column)`|`int or mixed`|å¹³å‡å€¼æŸ¥è¯¢|\n|`sum($conditions, $column)`|`int or mixed`|æ±‚å’ŒæŸ¥è¯¢|\n|`toSql($conditions)`|`string`|è·å–æ‰§è¡Œçš„`SQL`|\n|`getBindings($conditions = [])`|`array or mixed`|è·å–æŸ¥è¯¢ç»‘å®šçš„å‚æ•°|\n|`increment($conditions, $column, $amount = 1)`|`int`|æŒ‡å®šå­—æ®µç´¯åŠ |\n|`decrement($conditions, $column, $amount = 1)`|`int`|æŒ‡å®šå­—æ®µç´¯å‡|\n\n#### å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array or string or int`|æŸ¥è¯¢æ¡ä»¶(`string or int or ç´¢å¼•æ•°ç»„[1, 2, 3, 4]`ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºä¸»é”®æŸ¥è¯¢)|\n|`$columns`|`array`|æŸ¥è¯¢çš„å­—æ®µæ•°ç»„|\n|`$column`|`string`|æŸ¥è¯¢çš„å­—æ®µåç§°|\n|`$key`|`string or null`|æŸ¥è¯¢å•ä¸ªå­—æ®µç»„æˆæ•°ç»„çš„`key`(ç´¢å¼•ä¸‹æ ‡ä½¿ç”¨å­—æ®µ)|\n\n## å›› å¢åˆ æ”¹çš„äº‹ä»¶æ–¹æ³•\n\n>å­ç±»å®šä¹‰äº†è¿™äº›æ–¹æ³•ï¼Œæ‰ä¼šæ‰§è¡Œï¼Œå¦‚æœæƒ³é˜»æ­¢ä¸»æ–¹æ³•æ‰§è¡Œï¼Œå¹¶èƒ½è®©ä¸»æ–¹æ³•è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œç›´æ¥æŠ›å‡ºé”™è¯¯å°±å¯ä»¥\n\n### 4.1 æ–°å¢çš„äº‹ä»¶ åœ¨`create($data)` æ‰§è¡Œçš„æ—¶å€™è§¦å‘\n\n1. `beforeCreate($data)` æ–°å¢ä¹‹å‰\n\n2. `afterCreate($data, $news)`  æ–°å¢ä¹‹å\n\n#### 4.1.1 å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$data`|`array`|è¿‡æ»¤æ‰å¹²æ‰°æ•°æ®(éè¡¨ä¸­å­—æ®µçš„æ•°æ®)çš„æ•°ç»„|\n|`$news`|`array`|æ–°å¢æˆåŠŸè°ƒç”¨ `model->toArray()` æ•°ç»„|\n\n### 4.2 ä¿®æ”¹çš„äº‹ä»¶ åœ¨`update($conditions, array $data)` æ‰§è¡Œçš„æ—¶å€™è§¦å‘\n\n1. `beforeUpdate($conditions, $data)` ä¿®æ”¹ä¹‹å‰\n \n2. `afterUpdate($conditions, $data, $row)` ä¿®æ”¹ä¹‹å\n\n#### 4.2.1 å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array`|å¤„ç†äº†ä¸»é”®æŸ¥è¯¢åçš„æŸ¥è¯¢æ¡ä»¶æ•°ç»„|\n|`$data`|`array`|è¿‡æ»¤æ‰å¹²æ‰°æ•°æ®(éè¡¨ä¸­å­—æ®µçš„æ•°æ®)çš„æ•°ç»„|\n|`$row`|`int`|ä¿®æ”¹å—å½±å“çš„è¡Œæ•°|\n\n### 4.3 åˆ é™¤çš„äº‹ä»¶ åœ¨`delete($conditions)` æ‰§è¡Œçš„æ—¶å€™è§¦å‘\n\n1. `beforeDelete($conditions)` åˆ é™¤ä¹‹å‰\n\n2. `afterDelete($conditions, $row)` åˆ é™¤ä¹‹å\n\n#### 4.3.1 å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array`|å¤„ç†äº†ä¸»é”®æŸ¥è¯¢åçš„æŸ¥è¯¢æ¡ä»¶æ•°ç»„|\n|`$row`       |`int`  |åˆ é™¤å—å½±å“çš„è¡Œæ•°|\n\n### 4.4 å…³äº`$conditions` å¤„ç†ä¸ºä¸»é”®æŸ¥è¯¢\n\nä¸ä¸ºç©ºçš„ å­—ç¬¦ä¸²ã€æ•´æ•°ã€æµ®ç‚¹æ•°ã€ç´¢å¼•æ•°ç»„ éƒ½ä¼šè¢«è½¬ä¸ºä¸»é”®æŸ¥è¯¢\n\n```php\n\/\/ å‡è®¾è¡¨çš„ä¸»é”®ä¸ºid\n\n$conditions = 1;            \/\/ ä¼šè¢«è½¬ä¸º ['id' => 1]\n$conditions = '1';          \/\/ ä¼šè¢«è½¬ä¸º ['id' => '1']\n$conditions = [1, 2, 3];    \/\/ ä¼šè¢«è½¬ä¸º ['id' => [1, 2, 3, 4]]\n\n\/\/ å…³è”æ•°ç»„ä¸­ï¼Œåªè¦æœ‰ä¸€ä¸ªå…ƒç´ ä¸ºç´¢å¼•ä¸‹æ ‡çš„ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯ ç´¢å¼•æ•°ç»„\n\n$conditions = ['id' => 1, 'name' => '123', '789']\n\nåŒæ ·ä¼šè¢«è®¤ä¸ºæ˜¯ç´¢å¼•æ•°ç»„ï¼Œä¼šè½¬ä¸º\n\n$conditions = ['id' => [1, '123', '789']]\n\n```\n\n## äº” å…¶ä»–è¯´æ˜\n\n### 5.1 å…³äº`repository`çš„`create`ã€`update`ã€`delete` çš„è¿”å›\n\nè¿™ä¸‰ä¸ªå‡½æ•°ä¸ç®¡å¤„ç†æˆåŠŸå’Œå¤±è´¥ï¼Œè¿”å›çš„éƒ½æ˜¯æ•°ç»„ä¿¡æ¯ã€‚å› ä¸º`php`ä¸èƒ½åƒ`golang`é‚£æ ·,\nå¯ä»¥å¤šè¿”å›ï¼Œè€Œåœ¨æˆ‘ä»¬é€»è¾‘ä¸­ï¼Œç»å¸¸éœ€è¦çŸ¥é“æ‰§è¡Œé”™è¯¯äº†ï¼Œæ˜¯ä»€ä¹ˆæ ·çš„é”™è¯¯ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œ\néƒ½æ˜¯é€šè¿‡æ•°ç»„çš„æ–¹å¼è¿”å›ï¼Œè¿™æ ·å°±è§£å†³å¤šå€¼è¿”å›é—®é¢˜ã€‚è¿™ä¹Ÿæ˜¯å—`golang`çš„å½±å“ï¼ä¸è¿‡\n`laravel`å…¶å®æ›´æ¨èæ˜¯é€šè¿‡æŠ›å‡ºé”™è¯¯æ–¹å¼ï¼Œå»ç»Ÿä¸€ç®¡ç†æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯ã€‚æ‰€ä»¥å¦‚æœä¸å–œæ¬¢\nç°åœ¨æ•°ç»„çš„è¿”å›æ–¹å¼çš„è¯ï¼Œåªéœ€è¦é‡å†™ `success($data, $message === 'ok')` \nå’Œ `error($message, $data = [])` è¿™ä¸¤ä¸ªæ–¹æ³•å°±å¥½äº†\n\n### 5.2 `repository` æŸ¥è¯¢ `find`, `findAll` æŸ¥è¯¢ç»“æœéƒ½æ˜¯ `model->toArray()` çš„æ•°ç»„ï¼Œå¹¶ä¸æ˜¯ `model` å¯¹è±¡\n\n### 5.3 å¯¹äº`model`çš„è¦æ±‚\n\n1. `create` å’Œ `update` éƒ½æ˜¯æ‰¹é‡èµ‹å€¼ï¼Œéœ€è¦`model`å®šä¹‰æ‰¹é‡èµ‹å€¼çš„ç™½åå•`$fillable` æˆ–è€… é»‘åå• `$guarded`\n2. éœ€è¦å®šä¹‰ `$columns` å­—æ®µä¿¡æ¯ï¼Œè¡¨ç¤ºè¡¨ä¸­éƒ½æœ‰å“ªäº›å­—æ®µ\n\n    ```php\n    public $columns = ['id', 'title', 'content', 'created_at', 'updated_at'];\n    ```\n    \n    >è™½ç„¶è¿™ä¸€æ­¥æ˜¯éå¿…é¡»çš„ï¼Œä½†å®šä¹‰äº†`$columns`ä¼šå‡å°‘ä¸€æ¬¡`SQL`æŸ¥è¯¢çš„ä»£ä»·\n\næ˜¯ä¸æ˜¯éå¸¸ç®€æ´æ–¹ä¾¿ ^_^ ğŸ˜‹\nåé¢ä¼šç»§ç»­è¡¥å……",
        "v1.0.*.zh-CN": "Repository åŸºæœ¬ä½¿ç”¨\n==================\n\n[TOC]\n\n## ä¸€ å¢åˆ æ”¹æŸ¥\n\n### 1.1 æ–°å¢æ•°æ® `create(array $data)`\n\n```php\n\/**\n * è¿”å›å€¼è¯´æ˜\n * @param boolean $ok   true è¡¨ç¤ºæˆåŠŸ\n * @param string  $msg  æ“ä½œçš„æç¤ºä¿¡æ¯\n * @param array   $data æ–°å¢æˆåŠŸåè°ƒç”¨ model->toArray() è¿”å›çš„æ•°æ®ï¼Œ å¤±è´¥ä¸ºnull \n *\/\nlist($ok, $msg, $data) = $this->repository->create([\n    'user_name' => 'Tony',\n    'age'       => 18,\n    'sex'       => 1,\n    'address    => 'America'\n]);\n\n```\n\n### 1.2 ç¼–è¾‘æ•°æ® `update($conditions, array $data)`\n\n```php\n\/**\n * è¿”å›å€¼è¯´æ˜\n * @param boolean $ok   true è¡¨ç¤ºæˆåŠŸ\n * @param string  $msg  æ“ä½œçš„æç¤ºä¿¡æ¯\n * @param int     $rows è¡¨ç¤ºä¿®æ”¹æ•°æ®æ¡æ•°\n *\/\nlist($ok, $msg, $rows) = $this->repository->update(1, ['type' => 3, 'money' => 9999]); \/\/ ä¸»é”®ä¿®æ”¹ pk = 1\n\n\/\/ $this->repository->update(['id:gt' => 10], ['type' => 3, 'money' => 9999]);  \/\/ æ¡ä»¶ä¿®æ”¹ id > 10\n\n\/\/ $this->repository->update([1, 2, 3, 4], ['type' => 3, 'money' => 9999]); \/\/ ä¸»é”®ä¿®æ”¹ pk in (1, 2, 3, 4)\n```\n\n#### ä½¿ç”¨çš„æ˜¯æ‰¹é‡åˆ é™¤ï¼Œæ¨¡å‹çš„äº‹ä»¶æ˜¯ä¸ä¼šè§¦å‘çš„ï¼›ä½†æ˜¯ä¿®æ”¹æ•°æ®èƒ½å¤Ÿä½¿ç”¨ä¸Šæ¨¡å‹çš„ä¿®æ”¹å™¨\n\n### 1.3 åˆ é™¤æ•°æ® `delete($conditions)`\n\n```php\n\/**\n * è¿”å›å€¼è¯´æ˜\n * @param boolean $ok   true è¡¨ç¤ºæˆåŠŸ\n * @param string  $msg  æ“ä½œçš„æç¤ºä¿¡æ¯\n * @param int     $rows è¡¨ç¤ºåˆ é™¤æ•°æ®æ¡æ•°\n *\/\nlist($ok, $msg, $rows) = $this->repository->delete(1); \/\/ ä¸»é”®åˆ é™¤ pk = 1\n\n\/\/ $this->repository->delete(['id:gt' => 10]);  \/\/ æ¡ä»¶åˆ é™¤ id > 10\n\n\/\/ $this->>repository->delete([1, 2, 3, 4, 5]); \/\/ ä¸»é”®åˆ é™¤ pk in (1, 2, 3, 4)\n``` \n\n### 1.4 æŸ¥è¯¢æ•°æ®\n\n#### 1.4.1 æŸ¥è¯¢å•æ¡æ•°æ®\n\n1. æŸ¥è¯¢å•æ¡æ•°æ® find($conditions, $columns = [])\n\n    ```php\n    $item = $this->repository->find(1);  \/\/ ä¸»é”®æŸ¥è¯¢ pk = 1\n    ```\n\n2. æŸ¥è¯¢å•ä¸ªå­—æ®µ findBy($conditions, $column)\n\n    ```php\n    $name = $this->repository->findBy(1, 'name'); \/\/ æŸ¥æŸä¸ªå­—æ®µ\n    ```\n\n#### 1.4.2 æŸ¥è¯¢å¤šæ¡æ•°æ®\n\n1. æŸ¥è¯¢å¤šæ¡æ•°æ® findAll($conditions, $columns = [])\n\n    ```php\n    $items = $this->repository->findAll([1, 2, 3, 4]); \/\/ ä¸»é”®æŸ¥è¯¢ pk in (1, 2, 3, 4)\n    ```\n\n2. æŸ¥è¯¢å¤šæ¡æ•°æ®çš„å•ä¸ªå­—æ®µ findAllBy($conditions, $column)\n\n    ```php\n    $usernames = $this->repository->findAllBy([1, 2, 3], 'username'); \/\/ æŸ¥è¯¢æŸä¸ªå­—æ®µçš„æ‰€æœ‰å€¼\n    ```\n\n#### 1.4.3 åˆ†é¡µæŸ¥è¯¢\n\nåˆ†é¡µæŸ¥è¯¢ paginate($conditions = [], $columns = [], $size = 10, $current = null)\n\n```php\n$list = $this->repository->paginate(['status' => 1], ['id', 'name', ...]);\n```\n\n#### 1.4.4 ä½¿ç”¨`findWhere(array $where, array $columns = [])`æ„å»ºå¤æ‚çš„æŸ¥è¯¢\n\n```php\n    $users = $this->userRepository->findWhere([\n        'and',\n        ['or', ['username:auto_like' => 'test'], ['nick_name', 'like', '%test%']],\n        ['level' => 5],\n        ['status', '=', 1],\n    ])->get();\n```\n\nä¸Šé¢æŸ¥è¯¢ç”Ÿæˆçš„SQl\n\n```sql\nselect * from `users` where (\n    (`users`.`username` like '%test%' or `users`.`nick_name` like '%test%') \n    and `users`.`level` = 5 \n    and `users`.`status` = 1\n)\n```\n\n##### 1.4.4.1 ä½¿ç”¨è¯´æ˜\n- åªèƒ½ä½¿ç”¨æ•°ç»„æŸ¥è¯¢\n- æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç¡®å®šæ•°ç»„ä¸­å…¶ä»–æŸ¥è¯¢æ¡ä»¶çš„è¿æ¥æ–¹å¼ `and` æˆ– `or`ï¼› `and`å¯ä»¥å¿½æ‚ ä¸å†™\n\n    ```php\n    $where = [\n        \/\/ ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ˜¯ and æŸ¥è¯¢ï¼Œå¯ä»¥ä¸ç”¨å†™\n        ['level' => 5],\n        ['status' => 1],\n        [\n            \/\/ or è¡¨ç¤º æ•°ç»„ä¸­ï¼Œä¸‹é¢æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ or è¿æ¥ \n            'or', \n            ['username' => 'test'], \n            ['name' => 'test123']\n        ],\n    ];\n    ```\n- æ•°ç»„ä¸­çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¿…é¡»ä½¿ç”¨æ•°ç»„æ–¹å¼ \n    - `['å­—æ®µ', 'è¡¨è¾¾å¼', 'æŸ¥è¯¢å€¼']` \n    - `['å­—æ®µ:è¡¨è¾¾å¼' => 'æŸ¥è¯¢å€¼']` \n    - `['å­—æ®µ' => 'æŸ¥è¯¢å€¼']`\n    \n    >å»ºè®®ä½¿ç”¨`['å­—æ®µ', 'è¡¨è¾¾å¼', 'æŸ¥è¯¢å€¼']` æ¯”è¾ƒç›´è§‚\n    \n### 1.5 æŸ¥è¯¢è¿›é˜¶ä½¿ç”¨\n\n#### 1.5.1 ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢\n\n> ä½¿ç”¨æ–¹å¼\n\n`å­—æ®µ`:`è¡¨è¾¾å¼` => `å¯¹åº”æŸ¥è¯¢çš„å€¼`\n\nä¾‹å¦‚:\n\n```php\n\n$items = $this->repository->findAll([\n    'id:neq'    => 1,\n    'name:like' => '%test%'\n]);\n\n\/\/ å¯¹åº”ç”Ÿæˆçš„sql: `id` != 1 and `name` like '%test%' \n```\n\n##### 1.5.1.1  ç›®å‰æ”¯æŒçš„è¡¨è¾¾å¼\n\n| è¡¨è¾¾å¼ | å«ä¹‰ | ç‰¹åˆ«è¯´æ˜ |\n|:------|:--------------|:-----|\n| eq    | ç­‰äº(=)      | |\n| neq   | ä¸ç­‰äº(!=)   | |\n| ne    | ä¸ç­‰äº(!=)   | |\n| gt    | å¤§äº(>)      | |\n| egt    | å¤§äºç­‰äº(>=) | |\n| gte    | å¤§äºç­‰äº(>=) | |\n| ge     | å¤§äºç­‰äº(>=) | |\n| lt     | å°äº(<)      | |\n| le     | å°äºç­‰äº(<=)  | |\n| lte    | å°äºç­‰äº(<=)  | |\n| elt    | å°äºç­‰äº(<=)  | |\n| in     | IN æŸ¥è¯¢      | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not in | NOT IN æŸ¥è¯¢  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not_in | NOT IN æŸ¥è¯¢  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| between| åŒºé—´æŸ¥è¯¢(between)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not_between| ä¸åœ¨åŒºé—´æŸ¥è¯¢(not between)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| not between| ä¸åœ¨åŒºé—´æŸ¥è¯¢(not between)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºæ•°ç»„| \n| like   | æ¨¡ç³ŠæŸ¥è¯¢åŒ…å«(like)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºå­—ç¬¦ä¸² | \n| not_like   | æ¨¡ç³ŠæŸ¥è¯¢ä¸åŒ…å«(not like)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºå­—ç¬¦ä¸² | \n| not like   | æ¨¡ç³ŠæŸ¥è¯¢ä¸åŒ…å«(not like)  | ä¼ å…¥æ•°æ®ä¼šå¼ºè½¬ä¸ºå­—ç¬¦ä¸² | \n| rlike      | æ¨¡ç³ŠæŸ¥è¯¢åŒ…å«(rlike)   |  | \n| <>         | ä¸ç­‰äº(<>)            |  | \n| auto_like  | æ¨¡ç³ŠæŸ¥è¯¢(like)        | ä¼šè‡ªåŠ¨åˆ¤æ–­æ·»åŠ  % æ¨¡ç³ŠæŸ¥è¯¢\n\n##### 1.5.1.2 å…³äº `auto_like` æŸ¥è¯¢è¯´æ˜\n\n```php\n\/\/ æ²¡æœ‰æ·»åŠ å‰åæ¨¡ç³ŠæŸ¥è¯¢ï¼Œä¼šè‡ªåŠ¨åŠ ä¸Š username like '%test%'\n$this->repository->findAll(['username:auto_like' => 'test']); \n\n\/\/ æ·»åŠ äº†å‰ç¼€æˆ–è€…åç¼€æ¨¡ç³ŠæŸ¥è¯¢ï¼Œé‚£ä¹ˆä¸å¤„ç† username like 'test%'\n$this->repository->findAll(['username:auto_like' => 'test%']);\n\n```\n\n##### 1.5.1.3 ä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨è¡¨è¾¾å¼:\n\n```php\n\/\/ æŸ¥è¯¢å¤§äº10çš„è´¦å·\n$this->repository->findAll(['id:gt' => 10]);\n\n\/\/ æŸ¥è¯¢ä¸ç­‰äº10çš„è´¦å·\n$this->repository->findAll(['id:neq' => 10]);\n\n\/\/ æŸ¥è¯¢idæ˜¯1,2,3,4,5çš„è¿™äº›æ•°æ®\n$this->repository->findAll(['id:in' => [1, 2, 3, 4, 5]);\n\/\/ or\n$this->repository->findAll(['id' => [1, 2, 3, 4, 5]])\n\n\/\/ æŸ¥è¯¢åˆ›å»ºæ—¶é—´åœ¨2019å¹´çš„æ•°æ®\n$this->repository->findAll(['created_at:between' => \n    [\n        '2019-01-01 00:00:00', \n        '2020-01-01 00:00:00',\n    ]\n]);\n``` \n\n##### 1.5.1.4 å¦‚æœä½ è®°ä¸ä½è¡¨è¾¾å¼,é‚£ä¹ˆä½ åŒæ ·å¯ä»¥ç›´æ¥ä½¿ç”¨æ“ä½œç¬¦æŸ¥è¯¢ä¹Ÿæ˜¯ä¸€æ ·çš„\n\n```php\n$item = $this->repository->findAll([\n    'id:!='         => 2,\n    'username:like' => '%test%',\n    'status:>='     => 4,\n])\n```\n\n**åŒæ ·æ˜¯ æŸ¥è¯¢å­—æ®µ:æ“ä½œç¬¦ => 'æŸ¥è¯¢çš„å€¼'**\n\n##### 1.5.1.5 å…¶ä»–è¯´æ˜\n\n`update` å’Œ `create` æ–¹æ³•åŒæ ·æ”¯æŒè¡¨è¾¾å¼æŸ¥è¯¢ï¼Œéƒ½æ˜¯ä½¿ç”¨`findCondition($condiitons)` æ–¹æ³•å¤„ç†\n\n1. [update çš„ä½¿ç”¨è¯´æ˜](#12-ç¼–è¾‘æ•°æ®-updateconditions-array-data)\n2. [delete çš„ä½¿ç”¨è¯´æ˜](#13-åˆ é™¤æ•°æ®-deleteconditions)\n\n#### 1.5.2 ä½¿ç”¨ `model` çš„ `scope` æŸ¥è¯¢\n\n>ä¸¾ä¸ªğŸŒ°æ —å­,ä½ æœ‰ä¸€å¼ ç”¨æˆ·è¡¨ users, ç”¨æˆ·è¡¨çš„æ‰©å±•ä¿¡æ¯å­˜åœ¨ user_ext é‡Œ;\nç°åœ¨ä½ æƒ³æŸ¥è¯¢ç”¨æˆ·åœ°å€åœ¨æŒ‡å®šä½ç½®ä¿¡æ¯çš„æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯, é‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨`scope` æŸ¥è¯¢äº†\n\nè¦æ±‚modelå®šä¹‰äº†`scope`æŸ¥è¯¢\n\n##### 1. model \n\n```php\n\nclass User extends Model\n{\n    protected $table      = 'users';\n    protected $primaryKey = 'user_id';\n    public    $columns    = [\n        'user_id',\n        'username',\n        \/\/...\n        'created_at',\n        'updated_at',\n    ];\n \n  \n    \/**\n     * å®šä¹‰å…³è”æ‰©å±•ä¿¡æ¯\n     * \n     * return Illuminate\\Database\\Eloquent\\Relations\\HasOne\n     *\/\n    public function extInfo()\n    {\n      return $this->hasOne(UserExt::class, 'user_id', 'user_id');\n    }\n \n\n    \/**\n     * æ ¹æ®åœ°å€æŸ¥è¯¢\n     *\n     * @param \\Illuminate\\Database\\Eloquent\\Builder $query   æŸ¥è¯¢å¯¹è±¡\n     * @param string                                $address åœ°å€ä¿¡æ¯\n     * @return \\Illuminate\\Database\\Eloquent\\Builder\n     *\/\n    public function scopeAddress($query, $address)\n    {\n        return $query->leftJoin('user_ext', 'user_ext.user_id', '=', 'users.user_id')\n            ->where('user_ext.address', '=', $address);\n    }\n}   \n\n```\n\n##### 2. ä½¿ç”¨ `repository` æŸ¥è¯¢\n\n```php\n\n$this->userRepositoy->findAll([\n    'status'  => 1,\n    'address' => 'åŒ—äº¬'\n]);\n\n```\n\n##### 3. æŸ¥è¯¢çš„SQL\n\n```sql\n\nselect \n    * \nfrom \n    `users` \nleft join \n    `user_ext` on (`user_ext`.`user_id` = `users`.`user_id`) \nwhere \n    `users.status` = 1 and `user_ext`.`address` = 'åŒ—äº¬'\n    \n```\n##### 4 ä½¿ç”¨è¯´æ˜\n\nä»ä¸Šé¢çš„SQLå’Œå®¹æ˜“å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œæ²¡æœ‰æŒ‡å®šæŸ¥è¯¢å­—æ®µï¼Œé»˜è®¤æŸ¥è¯¢çš„ `*` æ‰€æœ‰å­—æ®µï¼Œå¦‚æœ`users`è¡¨å’Œ`user_ext`\nè¡¨çš„å­—æ®µæ²¡æœ‰å†²çªï¼Œé‚£ä¹ˆæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æœæœ‰å†²çªï¼Œé‚£ä¹ˆæŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¯èƒ½å’Œä½ æƒ³è±¡çš„ä¸ä¸€æ ·ï¼Œç‰¹åˆ«åœ¨è¿˜æœ‰\nå…³è”æŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿™ä¸ªé—®é¢˜æ›´å®¹æ˜“å‡¸æ˜¾å‡ºæ¥ï¼Œæ‰€ä»¥å»ºè®®åœ¨æœ‰è¿è¡¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œæœ€å¥½æœ‰åŠ ä¸Šä½ éœ€è¦æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯\n\n```php\n$this->userRepository->findAll([\n    'status'  => 1,\n    'address' => 'åŒ—äº¬',\n], ['users.*'])\n```\n\n#### 1.5.4 è·å– `model` çš„ `relation` å…³è”æ•°æ®ä¿¡æ¯\n\nå½“æˆ‘ä»¬æŸ¥è¯¢æ•°æ®æ—¶å€™ï¼Œä¹Ÿæƒ³æŠŠå…³è”æ•°æ®æŸ¥è¯¢å‡ºæ¥çš„æ—¶å€™ï¼Œå°±ä¼šç”¨åˆ°å…³è”æŸ¥è¯¢\n\nä½¿ç”¨çš„æ˜¯`model`çš„`with`æ–¹æ³•\n\n>ä¸¾ä¸ªğŸŒ°æ —å­,ä½ æœ‰ä¸€å¼ ç”¨æˆ·è¡¨users,ç”¨æˆ·è¡¨çš„æ‰©å±•ä¿¡æ¯å­˜åœ¨user_exté‡Œ \nä¹Ÿè®¸ä½ æƒ³æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™åŒæ—¶æŸ¥å‡ºç”¨æˆ·çš„æ‰©å±•ä¿¡æ¯\n\nè¦æ±‚`model`å®šä¹‰äº†å…³è”\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\n1. ä½¿ç”¨ `repository` è·å–å…³è”æ•°æ®ä¿¡æ¯, é€šè¿‡æŸ¥è¯¢å­—æ®µï¼Œè‡ªåŠ¨å¤„ç†å…³è”\n\n    æŸ¥è¯¢å­—æ®µä¸­æ·»åŠ  `å…³è”å…³ç³»` => [`å…³è”æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯`]\n    \n    ```php\n        $users = $this->repository->findAll(['status' => 1], ['*', 'extInfo' => ['*']]);\n    ```\n\n2. æŸ¥è¯¢SQL \n\n    [è¿™é‡Œä½¿ç”¨é¢„åŠ è½½æ•°æ®](https:\/\/learnku.com\/docs\/laravel\/5.5\/eloquent-relationships\/1333#012e7e), é¿å…N+1é—®é¢˜\n\n    ```sql\n    select * from `users` where `users`.`status` = 1\n    \n    select * from `user_ext` where `user_id` in (1, 2, 3, 4)\n    ```\n\n3. æ•°æ®ä¿¡æ¯\n\n    ![å…³è”çš„æ•°æ®](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/relation.png 'å…³è”çš„æ•°æ®')\n\n##### 1.5.4.1\n    \n1. ä¸Šé¢æœ‰ä¸ªå°çš„é—®é¢˜ï¼Œ`model`å®šä¹‰çš„å…³è”åç§°ä¸º`extInfo`, ä½†æ˜¯å‡ºæ¥æ•°ç»„å¯¹åº”çš„å­—æ®µä¿¡æ¯ä¸º\n `ext_info` , å¹¶ä¸”æŸ¥è¯¢æŒ‡å®šå­—æ®µä¿¡æ¯ä¹Ÿæ˜¯ä¸º`extInfo` (`'extInfo' => ['*']`), æŸ¥è¯¢\n å‡ºæ¥çš„æ•°æ®æ˜¯`laravel` `model` çš„ `toArray()` æ–¹æ³•å¤„ç†çš„ç»“æœ,ä¼šå°†`å°é©¼å³°`å‘½åçš„\n å…³è”ä¿¡æ¯è½¬ä¸º`è›‡å½¢`å‘½åå­—æ®µï¼Œ`repository`æŸ¥è¯¢å­—æ®µæ”¯æŒ`å°é©¼å³°`å’Œ`è›‡å½¢`å‘½åï¼Œä¾‹å¦‚ï¼š\n     \n     ```php\n        $users = $this->repository->findAll(['status' => 1], ['*', 'ext_info' => ['*]])\n     ``` \n       \n     å’Œä¸Šé¢çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä¸ºäº†æ›´å¥½çš„ä¸€è‡´æ€§ï¼Œå»ºè®®`model`åœ¨å®šä¹‰è”æŸ¥è¯¢å‘½åçš„æ—¶å€™ï¼Œä½¿ç”¨å•ä¸ªå•è¯çš„å•å¤æ•°å½¢å¼æ¯”è¾ƒå¥½\n\n2. åœ¨æŸ¥è¯¢æ—¶å€™æŒ‡å®šå­—æ®µï¼Œå¹¶ä¸”æŒ‡å®šæŸ¥è¯¢å…³è”æŸ¥è¯¢å­—æ®µ\n\n    ```php\n    $users = $this->userRepository->findAll(['status' => 1], ['username', 'extInfo' => ['address']]);\n    ```    \n   \n   ä¸Šé¢æŸ¥è¯¢æŒ‡å®šäº†æŸ¥è¯¢çš„å­—æ®µï¼Œä½†æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ²¡æœ‰æŒ‡å®šå‡ºå…³è”è¡¨æŸ¥è¯¢éœ€è¦çš„å­—æ®µ `user_id` å­—æ®µä¿¡æ¯ï¼Œä¼šå¯¼è‡´å…³è”ä¿¡æ¯å…³è”ä¸ä¸Šçš„é—®é¢˜\n   **ä½†`repository`è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¼šè‡ªåŠ¨åŠ ä¸Šå…³è”æŸ¥è¯¢éœ€è¦çš„å­—æ®µä¿¡æ¯**ï¼Œæ‰€ä»¥æœ€ç»ˆæŸ¥è¯¢çš„SQLå’Œæ•°æ®å¦‚ä¸‹:\n   \n   ![å…³è”çš„æ•°æ®](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/relation-1.png 'å…³è”çš„æ•°æ®')\n   \n   >è¿™å¯èƒ½ä¼šè®©äººè®¤ä¸ºæˆ‘æ˜æ˜åªæŸ¥è¯¢äº†`username`å­—æ®µï¼Œæ€ä¹ˆè¿˜æŸ¥å‡ºäº†å…¶ä»–å­—æ®µä¿¡æ¯\n   \n   **åªæœ‰åœ¨å…³è”æŸ¥è¯¢çš„æ—¶å€™ï¼Œæ²¡æœ‰æŒ‡å®šæŸ¥è¯¢å…³è”å­—æ®µï¼Œæ‰ä¼šè‡ªåŠ¨åŠ ä¸Šå…³è”å­—æ®µ**\n   \n#### 1.5.5 è·å– `model` çš„ `relation` å…³è”ç»Ÿè®¡æ•°æ®ä¿¡æ¯\n\nè¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒé€‚åˆä¸€å¯¹å¤šçš„æ—¶å€™ï¼Œæˆ‘æƒ³çŸ¥é“å…³è”çš„å…¶ä»–ä¿¡æ¯æœ‰å¤šå°‘\n\nåªè¦å®šä¹‰äº†`model`çš„å…³è”ä¿¡æ¯ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ï¼Œå…¶å®å°±æ˜¯ `model` çš„ `withCount`\n\n>`model`å®šä¹‰çš„`å…³è”æ–¹æ³•åç§°_count`\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\n```php\n$user = $this->repositoy->find(['status' => 1], ['id', 'username', 'extInfo_count']);\n```\n\næ‰§è¡ŒSQLä»¥åŠæ•°æ®\n\n![å…³è”çš„æ•°æ®](https:\/\/wanchaochao.github.io\/laravel-repository\/docs\/images\/relation-2.png 'å…³è”çš„æ•°æ®')\n\n#### 1.5.6 ç»™ `model` çš„ `relation` å…³è”æŸ¥è¯¢åŠ¨æ€æ·»åŠ æŸ¥è¯¢æ¡ä»¶\n\næŸ¥è¯¢æ¡ä»¶ä¸­æ·»åŠ  `modelå®šä¹‰å…³è”æ–¹æ³•åç§°.å­—æ®µ` => 'æŸ¥è¯¢çš„å€¼'\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\nä¾‹å¦‚ï¼š\n\n```php\n\n$users = $this->repository->findAll([\n    'status'                => 1,\n    'extInfo.address'       => 'åŒ—äº¬',\n    'extInfo.created_at:gt' => '2019-02-01 00:00:00', \/\/ åŒæ ·æ”¯æŒè¡¨è¾¾å¼æŸ¥è¯¢\n], ['extInfo' => ['*']])\n\n```\næ‰§è¡Œçš„SQLï¼š\n```sql\nselect * from `users` where `users`.`status` = 1\n\nselect * from `user_ext` where \n    `user_ext`.`address` = 'åŒ—äº¬' and \n    `user_ext`.`created_at` > '2019-02-01 00:00:00' and \n    `user_ext`.`user_id` in (1, 2, 3, 4)\n```\n\n##### 1.5.6.1 model ä¹Ÿå¯ä»¥å®šä¹‰é»˜è®¤å…³è”çš„æŸ¥è¯¢æ¡ä»¶\n\néœ€è¦åœ¨`model`é‡Œé¢å®šä¹‰ `å…³è”æ–¹æ³•åç§°Filters` çš„å±æ€§ä¿¡æ¯\n\n```php\n    class User extends Model\n    {\n        protected $table      = 'users';\n        protected $primaryKey = 'user_id';\n        public    $columns    = [\n            'user_id',\n            'username',\n            \/\/...\n            'created_at',\n            'updated_at',\n        ];\n        \n        \/**\n         * ä¸ºå…³è”å®šä¹‰é»˜è®¤æŸ¥è¯¢æ¡ä»¶\n         *\n         * @var array\n         *\/\n        public $extInfoFilters = [\n            'address' => 'åŒ—äº¬', \n            \/\/ 'ddress:like' => 'åŒ—äº¬', \/\/ å…è®¸ä½¿ç”¨è¡¨è¾¾å¼æ–¹å¼\n        ];\n     \n        \/**\n         * å®šä¹‰å…³è”æ‰©å±•ä¿¡æ¯\n         * \n         * return Illuminate\\Database\\Eloquent\\Relations\\HasOne\n         *\/\n        public function extInfo()\n        {\n          return $this->hasOne(UserExt::class, 'user_id', 'user_id');\n        }\n     \n    \n        \/**\n         * æ ¹æ®åœ°å€æŸ¥è¯¢\n         *\n         * @param \\Illuminate\\Database\\Eloquent\\Builder $query   æŸ¥è¯¢å¯¹è±¡\n         * @param string                                $address åœ°å€ä¿¡æ¯\n         * @return \\Illuminate\\Database\\Eloquent\\Builder\n         *\/\n        public function scopeAddress($query, $address)\n        {\n            return $query->leftJoin('user_ext', 'user_ext.user_id', '=', 'users.user_id')\n                ->where('user_ext.address', '=', $address);\n        }\n    }   \n```\n  \nè¯´æ˜ï¼š å…³è”æŸ¥è¯¢ã€ç»Ÿè®¡æŸ¥è¯¢éƒ½ä¼šæ·»åŠ é»˜è®¤å…³è”æŸ¥è¯¢æ¡ä»¶\n\nä½¿ç”¨å®šä¹‰äº†é»˜è®¤å…³è”æŸ¥è¯¢æ¡ä»¶è¿›è¡ŒæŸ¥è¯¢\n\n```php\n$users = $this->repository->findAll(['status' => 1], ['extInfo' => ['*']])\n```\n\næ‰§è¡Œçš„SQLï¼š\n\n```sql\nselect * from `users` where `users`.`status` = 1\n\nselect * from `user_ext` where \n    `user_ext`.`address` = 'åŒ—äº¬' \n    `user_ext`.`user_id` in (1, 2, 3, 4)\n```\n\n**é»˜è®¤å…³è”æŸ¥è¯¢æ¡ä»¶å’ŒåŠ¨æ€å…³è”æŸ¥è¯¢æ¡ä»¶æ˜¯å åŠ çš„**\n\n#### 1.5.7 è¿‡æ»¤ç©ºå€¼æŸ¥è¯¢\n\n**ç©ºå­—ç¬¦ä¸²ã€ç©ºæ•°ç»„ã€nullä¼šè¢«è®¤ä¸ºç©ºå€¼**\n\n1. æŸ¥è¯¢å•ä¸ª filterFind($conditions, $columns = [])\n\n    ```php\n    $item = $this->repositpry->filterFind([\n        'username:like' => request()->input('username'),\n        'status'        => request()->input('status')\n    ]);\n    ```\n\n2. æŸ¥è¯¢å¤šä¸ª filterFindAll($conditions, $columns = [])\n\n    ```php\n    $items = $this->repositpry->filterFindAll([\n        'username:like' => request()->input('username'),\n        'status'        => request()->input('status')\n    ]);\n    ```\n3. è·å–è¿‡æ»¤ç©ºå€¼æŸ¥è¯¢çš„model getFilterModel($conditions, $columns = [])\n\n    ```php\n    $model = $this->repositpry->getFilterModel([\n        'username:like' => request()->input('username'),\n        'status'        => request()->input('status')\n    ]);\n    ```\n    \n>è¿™å‡ ä¸ªæ–¹æ³•ï¼Œç›¸å½“äº [when æ¡ä»¶æŸ¥è¯¢](https:\/\/learnku.com\/docs\/laravel\/5.5\/queries\/1327#conditional-clauses)\nåœ¨å’Œå‰ç«¯äº¤äº’æ—¶ï¼Œä¸ç¡®å®šå‰ç«¯æ˜¯å¦ä¼ é€’å€¼æ¥è¿›è¡ŒæŸ¥è¯¢æ—¶å€™ï¼Œæ¯”è¾ƒæ–¹ä¾¿\n\n```php\n\/\/ å¹³æ—¶å†™æ³•\n$conditions = [];\n\nif ($username = request()->input('username')) {\n    $conditions['username:like'] = $username;\n}\n\nif ($status = request()->input('status')) {\n    $conditions['status'] = $status;\n}\n\n$items = $this->repository->findAll($conditions);\n\n\/\/ ä½¿ç”¨ filter è¿‡æ»¤æŸ¥è¯¢\n$items = $this->repositpry->filterFindAll([\n    'username:like' => request()->input('username'),\n    'status'        => request()->input('status')\n]);\n```\n\n#### 1.5.8 ä½¿ç”¨ `findWhere` æ„å»ºå¤æ‚æŸ¥è¯¢\n\n> `findWhere(array $where, $array $columns = [])`\n\n```php\n$this->userRespository->findWhere([\n    'and',\n    ['username' => 1, 'name:like' => '%test%'],\n    ['or', ['level' => 10, 'level:eq' => 5]],\n    ['and', ['status' => 1, 'age' => 1]],   \n])->get();\n\n```\n\næ‰§è¡Œçš„SQL\n\n```sql\nselect * from `users` where \n    (`username` = 1 and `name` like '%test%') and \n    (`level` = 10 or `level` = 5) and \n    (`status` = 1 and `age` = 1)\n```\n\n`where`æŸ¥è¯¢æ¡ä»¶è¯´æ˜\n\næ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ å®šä¹‰æŸ¥è¯¢æ¡ä»¶è¿æ¥æ–¹å¼(åé¢æ•°ç»„çš„æŸ¥è¯¢æ¡ä»¶æ€ä¹ˆè¿æ¥`or` æˆ–è€… `and`)ï¼Œå¦‚æœæ˜¯`and`è¿æ¥\nå¯ä»¥å¿½ç•¥ä¸å†™,ä¸€å®šè¦æ˜¯å¤šç»´æ•°ç»„\n\nç¬¬ä¸€ä¸ª`and`å¿½ç•¥ä¸å†™\n```php\n$where = [\n['status' => 1]ï¼Œ\n['name' => 2]\n];\n\n\/\/ where `status` = 1 and `name` = 2 \n```\n\nä½¿ç”¨ `or` è¿æ¥\n```php\n$where = [\n    \/\/ or å®šä¹‰ åé¢çš„æŸ¥è¯¢æ¡ä»¶ é€šè¿‡ or è¿æ¥\n    'or',\n    ['status' => 1],\n    ['age' => 1],\n    \n    \/\/ and å®šä¹‰æ•°ç»„é‡Œé¢åé¢çš„æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ and è¿æ¥\n    ['and', ['name', '=', 123], ['username', 'like', 'test']],\n];\n\n\/\/ where `status` = 1 or `age` = 1 or (`name` = 123 and `username` like 'test')\n```\n\n#### 1.5.9 ä½¿ç”¨ `join` æŸ¥è¯¢\n\n>`leftJoin` å’Œ `rightJoin` å’Œ `join` ä½¿ç”¨ä¸€è‡´\n\n##### 1. ç®€å•`join`\n\n```php\n$this->repository->findAll([\n    'join' => ['users', 'users.school_id', '=', 'school.id']\n]);\n\n```\n\n```sql\nselect `school`.* from `school` inner join `users` on (`users`.`school_id` = `school`.`id`)\n```\n\n##### 2. ä¸€æ¬¡å¤šä¸ª`join`\n```php\n$this->repository->findAll([\n    'join' => [\n        ['users', 'users.school_id', '=', 'school.id'],\n        ['school as s1', 's1.parent_id', '=', 'school.id']\n    ]\n]);\n\n```\n\n```sql\nselect \n    `school`.* \nfrom \n    `school` \ninner join `users` on (`users`.`school_id` = `school`.`id`) \ninner join `school` as `s1` on (`s1`.`parent_id` = `school`.`id`)\n```\n\n##### 3. ä½¿ç”¨å…³è”å…³ç³»å¯¹åº”join\n\n`model` ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ [`User`](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\n```php\n$users = $this->repository->findAll(['status' => 1, 'joinWith' => 'extInfo']);\n```\n\n```sql\nselect \n    `users`.* \nfrom \n    `users` \ninner join `user_ext` on `user_ext`.`user_id` = `users`.`user_id`\nwhere `users`.`status` = 1\n```\n\n##### 4. ä½¿ç”¨å…³è”å…³ç³»å¯¹åº”joinå¹¶è®¾ç½®åˆ«å\n\n>['åˆ«å' => 'å…³è”æ–¹æ³•åç§°']\n\n```php\n$users = $this->repository->findAll(['status' => 1, 'joinWith' => ['ext' => 'extInfo']]);\n```\n\n```sql\nselect \n    `users`.* \nfrom \n    `users` \ninner join `user_ext` as `ext` on `ext`.`user_id` = `users`.`user_id` \nwhere `users`.`status` = 1\n```\n\n##### 5. ä¸º`join`æ·»åŠ æŸ¥è¯¢æ¡ä»¶\n\n>é€šè¿‡ ['__joinè¡¨åç§°.å­—æ®µ' => 'å¯¹åº”çš„å€¼'], ç›®å‰æ²¡æœ‰æ¯”è¾ƒç›´è§‚çš„æ–¹å¼å¤„ç†ã€å› ä¸º `order.user_id` æ–¹å¼è¢«å…³è”å…³ç³»çš„é™„åŠ æ¡ä»¶å ç”¨äº†\n\n```php\n$users = $this->repository->findAll([\n    'status'        => 1, \n    'joinWith'      => ['ext' => 'extInfo']ï¼Œ\n    '__ext.user_id' => 1,\n]);\n```\n\n```sql\nselect \n    `users`.* \nfrom \n    `users` \ninner join `user_ext` as `ext` on `ext`.`user_id` = `users`.`user_id`\nwhere `users`.`status` = 1 and `ext`.`user_id` = 1\n```\n\n## äºŒ å…³äºæŸ¥è¯¢ä¸­çš„`$conditions`å’Œ`$columns`ä¿¡æ¯è¯´æ˜\n\n>`$conditions`ä¸º`sql`æŸ¥è¯¢å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼Œ`$columns`ä¸º`sql`çš„`select`æ·»åŠ æŒ‡å®šçš„æŸ¥è¯¢å­—æ®µ\n\n### 2.1 `$conditions` æŸ¥è¯¢æ¡ä»¶\n\n1. æ”¯æŒå­—æ®µç²¾å‡†æŸ¥è¯¢(è¡¨ä¸­å­—æ®µçš„æŸ¥è¯¢)\n2. é¢„å®šæœ‰å­—æ®µæŸ¥è¯¢[å‚è€ƒ](#211-é¢„å®šä¹‰çš„å­—æ®µ)\n3. æ”¯æŒè¡¨è¾¾å¼æŸ¥è¯¢[å‚è€ƒ](#15-æŸ¥è¯¢è¿›é˜¶ä½¿ç”¨)\n4. æ”¯æŒå…³è”æ¡ä»¶æŸ¥è¯¢[å‚è€ƒ](#156-ç»™-model-çš„-relation-å…³è”æŸ¥è¯¢åŠ¨æ€æ·»åŠ æŸ¥è¯¢æ¡ä»¶)\n5. æ”¯æŒ`model`çš„`scope`[å‚è€ƒ](#152-ä½¿ç”¨-model-çš„-scope-æŸ¥è¯¢)\n\nä¾‹å¦‚ï¼š\n\n```php\n$conditions = [\n    \/\/ è¡¨ä¸­å­—æ®µç²¾å‡†æŸ¥è¯¢\n    'status' => 1,\n    'id'     => [1, 2, 3, 4], \/\/ å€¼ä¸ºæ•°ç»„ä¼šè‡ªåŠ¨è½¬ä¸ºinæŸ¥è¯¢ `id` in (1, 2, 3, 4)\n    \n    \/\/ é¢„å®šä¹‰å­—æ®µæŸ¥è¯¢\n    'order' => 'id desc' \/\/ æŒ‡å®šæ’åºå­—æ®µå’Œæ–¹å¼\n    'limit' => 10,       \/\/ é™åˆ¶æŸ¥è¯¢æ¡ä»¶\n    'group' => 'id',     \/\/ æŒ‡å®šåˆ†ç»„æ¡ä»¶\n    'force' => 'name',   \/\/ æŒ‡å®šä½¿ç”¨çš„ç´¢å¼•\n  \n    \/\/ join å…³è”æŸ¥è¯¢\n    'join'     => ['users', 'users.user_id', '=', 'orders.user_id'],\n    'leftJoin' => [\n        \/\/ å¤šä¸ªleftJoin\n        ['users as u1', 'u1.user_id', '=', 'orders.user_id'],\n        ['user_image', 'users_image.user_id', '=', 'users.user_id'],\n    ],\n\n    \/\/ è¡¨è¾¾å¼æŸ¥è¯¢\n    'username:like'      => 'test',                                         \/\/ æ¨¡ç³ŠæŸ¥è¯¢\n    'created_at:between' => ['2019-01-02 00:00:00', '2019-01-03 23:59:59'], \/\/ åŒºé—´æŸ¥è¯¢\n    'id:ge'              => 12, \/\/ id > 12\n    ...\n    \n    \/\/ relation å…³è”æŸ¥è¯¢,æŸ¥è¯¢æ¡ä»¶åªå¯¹å½“å‰relationå…³è”æŸ¥è¯¢é™åˆ¶\n    'extInfo.address:like'   => 'åŒ—äº¬',\n    'extInfo.created_at:gte' => '2019-01-01 00:00:00',\n    \n    \/\/ é€šè¿‡ relation å…³è”å…³ç³»ï¼Œæ·»åŠ join æŸ¥è¯¢\n    'joinWith'     => ['extInfo'],\n    \/\/ å…³è”è¡¨å®šä¹‰åˆ«å alias, å¦‚æœæ²¡æœ‰åˆ«åï¼Œå…³è”è¡¨å’Œä¸»è¡¨åŒåï¼Œä½¿ç”¨è‡ªå®šä¹‰åˆ«å `t1`, å¤šä¸ªåŒåä»¥æ­¤åœ°å€ `t2`ã€`t3`\n    'leftJoinWith' => ['alias' => 'children'], \n    \n    \/\/ scope è‡ªå®šä¹‰æŸ¥è¯¢\n    'address'  => 'åŒ—äº¬',     \/\/ æŸ¥æ‰¾`scopeAddress($query, $address)`æ–¹æ³•\n    'children' => [1, 2, 3],  \/\/ æŸ¥æ‰¾`scopeChildren($query, $childrenIds)`æ–¹æ³•\n];\n```\n\n#### 2.1.1 é¢„å®šä¹‰çš„å­—æ®µ\n\n|å­—æ®µåç§°|å­—æ®µå€¼ç±»å‹|è¯´æ˜|\n|-------|---------|----|\n|`force`|`string`|å¼ºåˆ¶èµ°æŒ‡å®šç´¢å¼•|\n|`order`|`string or array`|æŒ‡å®šæ’åºæ¡ä»¶|\n|`limit`|`int`|æŒ‡å®šæŸ¥è¯¢æ¡æ•°|\n|`offset`|`int`|æŒ‡å®šè·³è½¬ä½ç½®|\n|`group`|`string`|æŒ‡å®šåˆ†ç»„å­—æ®µ|\n|`join`|`array`|æŸ¥è¯¢joinçš„å‚æ•°ï¼Œå¤šä¸ªäºŒç»´æ•°ç»„|\n|`leftJoin`|`array`|æŸ¥è¯¢`leftJoin`çš„å‚æ•°ã€å¤šä¸ªäºŒç»´æ•°ç»„|\n|`rightJoin`|`array`|æŸ¥è¯¢`rightJoin`çš„å‚æ•°ã€å¤šä¸ªäºŒç»´æ•°ç»„|\n|`joinWith`|`string or array`| é€šè¿‡å…³è”å…³ç³»å¯¹åº”joinæŸ¥è¯¢|\n|`leftJoinWith`|`string or array`| é€šè¿‡å…³è”å…³ç³»å¯¹åº”leftJoinæŸ¥è¯¢|\n|`rightJoinWith`|`string or array`| é€šè¿‡å…³è”å…³ç³»å¯¹åº”rightJoinæŸ¥è¯¢|\n\n### 2.2 `$columns` æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯\n\n1. æ”¯æŒæœ¬è¡¨å­—æ®µæŸ¥è¯¢\n2. æ”¯æŒå…³è”ç»Ÿè®¡å­—æ®µæŸ¥è¯¢\n3. æ”¯æŒå…³è”æ•°æ®å­—æ®µæŸ¥è¯¢\n\n```php\n$columns = [\n\n    \/\/ æœ¬è¡¨çš„å­—æ®µæŸ¥è¯¢\n    'id',\n    'username',\n\n    \/\/ å…³è”è¡¨çš„å­—æ®µæŸ¥è¯¢\n    'users.username',\n    'users.age',\n    \n    \/\/ ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢\n    DB::raw('SUM(`users`.`age`) AS `sum_age`'),\n    \n    \/\/ å…³è”ç»Ÿè®¡å­—æ®µæŸ¥è¯¢\n    'extInfo_count',  \/\/ å¯¹åº”`model`å®šä¹‰çš„ extInfo å…³è”\n    'children_count', \/\/ å¯¹åº”`model`å®šä¹‰çš„ children å…³è”\n    \n    \/\/ å…³è”è¡¨å­—æ®µæŸ¥è¯¢\n    'extInfo'  => ['*'], \/\/ å¯¹åº”`model`å®šä¹‰çš„ extInfo å…³è”\n    'children' => ['*'], \/\/ å¯¹åº”`model`å®šä¹‰çš„ children å…³è”\n];\n```\n\n## ä¸‰ æ–¹æ³•åˆ—è¡¨\n\n### 3.1 æ–¹æ³•åˆ—è¡¨\n\n>repositoryæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¯¹å¤–çš„ï¼Œè¿™é‡Œåªåˆ—å‡ºå¸¸ç”¨æ–¹æ³•\n\n|æ–¹æ³•åç§°|è¿”å›å€¼|æ–¹æ³•è¯´æ˜|\n|-------|-----|-------|\n|`find($conditions, $columns = [])`|`array or false`|æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n|`findBy($conditions, $column)`|`mixed`|æŸ¥è¯¢å•æ¡æ•°æ®çš„å•ä¸ªå­—æ®µ|\n|`findAll($conditions, $columns = [])`|`array`|æŸ¥è¯¢å¤šæ¡æ•°æ®|\n|`findAllBy($conditions, $column)`|`array`|æŸ¥è¯¢å¤šæ¡æ•°ç»„çš„å•ä¸ªå­—æ®µæ•°ç»„|\n|`filterFind($conditions, $columns = [])`|`array or false`|è¿‡æ»¤æŸ¥è¯¢æ¡ä»¶ä¸­çš„ç©ºå€¼æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n|`filterFindAll($condtions, $columns = [])`|`array`|è¿‡æ»¤æŸ¥è¯¢æ¡ä»¶ä¸­çš„ç©ºå€¼æŸ¥è¯¢å¤šæ¡æ•°æ®|\n|`paginate($conditions = [], $columns = [], $size = 10, $current = null)`|`array`|åˆ†é¡µæŸ¥è¯¢æ•°æ®|\n|`filterPaginate($conditions = [], $columns = [], $size = 10, $current = null)`|`array`|è¿‡æ»¤æŸ¥è¯¢æ¡ä»¶ä¸­çš„ç©ºå€¼åˆ†é¡µæŸ¥è¯¢æ•°æ®|\n|`getFilterModel($conditions, $columns = [])`|`Illuminate\\Database\\Eloquent\\Model`|è·å–å·²ç»è¿‡æ»¤å¤„ç†æŸ¥è¯¢æ¡ä»¶çš„`model`|\n|`findCondition($conditions = [], $columns = [])`|`Illuminate\\Database\\Eloquent\\Model`|è·å–å·²ç»å¤„ç†æŸ¥è¯¢æ¡ä»¶çš„`model`(**ä¸Šé¢æ‰€æœ‰æŸ¥è¯¢æ–¹æ³•éƒ½åŸºäºè¿™ä¸ªæ–¹æ³•**)|\n|`create(array $data)`|`array`|æ·»åŠ æ•°æ®|\n|`update($conditions, array $data)`|`array`|ä¿®æ”¹æ•°æ®(ä½¿ç”¨çš„æ˜¯æ‰¹é‡ä¿®æ”¹)|\n|`delete($conditions)`|`array`|åˆ é™¤æ•°æ®(ä½¿ç”¨çš„æ˜¯æ‰¹é‡åˆ é™¤)|\n|`findWhere(array $where, $columns = [])`|`Illuminate\\Database\\Eloquent\\Model`|è·å–é€šè¿‡æ•°ç»„æŸ¥è¯¢çš„`model`\n\n#### å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array or string or int`|æŸ¥è¯¢æ¡ä»¶(`string or int or ç´¢å¼•æ•°ç»„[1, 2, 3, 4]`ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºä¸»é”®æŸ¥è¯¢)|\n|`$columns`|`array`|æŸ¥è¯¢çš„å­—æ®µæ•°ç»„|\n|`$column`|`string`|æŸ¥è¯¢çš„å­—æ®µåç§°|\n|`$data`|`array`|åˆ›å»ºæˆ–è€…ä¿®æ”¹çš„æ•°ç»„æ•°æ®ä¿¡æ¯|\n|`$where`|`array`|æŸ¥è¯¢æ¡ä»¶|\n\n### 3.2 æ”¯æŒ`model`è‡ªå¸¦æ–¹æ³•\n\n|æ–¹æ³•åç§°    |è¿”å›å€¼| æ–¹æ³•è¯´æ˜ |\n|---------------|-------------|----------|\n|`getConnection()`|`Illuminate\\Database\\Connection`|è·å–è¿æ¥ä¿¡æ¯|\n|`insert(array $values)`|`boolean`|æ–°å¢æ•°æ®(æ”¯æŒæ‰¹é‡æ–°å¢)|\n|`insertGetId(array $values)`|`int`|æ–°å¢æ•°æ®å¹¶è·å–æ–°å¢ID|\n|`firstOrCreate(array $attributes, array $value = [])`|`Illuminate\\Database\\Eloquent\\Model`|æŸ¥è¯¢æ•°æ®ï¼Œä¸å­˜åœ¨é‚£ä¹ˆæ–°å¢ä¸€æ¡æ•°æ®|\n|`firstOrNew(array $attributes, array $value = [])`|`Illuminate\\Database\\Eloquent\\Model`|æŸ¥è¯¢æ•°æ®ã€ä¸å­˜åœ¨é‚£ä¹ˆ`new`å‡ºæ¥|\n|`updateOrCreate(array $attributes, array $value = [])`|`Illuminate\\Database\\Eloquent\\Model`|ä¿®æ”¹æ•°æ®ï¼Œä¸å­˜åœ¨é‚£ä¹ˆæ–°å¢ä¸€æ¡æ•°æ®|\n|`findOrFail($id, $columns = ['*'])`|`Illuminate\\Database\\Eloquent\\Model`|é€šè¿‡ä¸»é”®æŸ¥è¯¢æ•°æ®ï¼Œä¸å­˜åœ¨æŠ›å‡ºé”™è¯¯|\n|`findOrNew($id, $columns = ['*'])` |`Illuminate\\Database\\Eloquent\\Model`|é€šè¿‡ä¸»é”®æŸ¥è¯¢æ•°æ®ï¼Œä¸å­˜åœ¨`new`å‡ºæ¥|\n|`findMany($ids, $columns = ['*'])`|`\\Illuminate\\Database\\Eloquent\\Collection`|é€šè¿‡ä¸»é”®æ•°ç»„æŸ¥è¯¢å¤šæ¡æ•°æ®|\n\n#### å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$attributes`|`array`|`model`çš„å­—æ®µä¿¡æ¯(æŸ¥è¯¢æ¡ä»¶)|\n|`$value`|`array or null`|`model`çš„å…¶ä»–å­—æ®µä¿¡æ¯(ä¸å‚ä¸æŸ¥è¯¢ã€å‚ä¸æ–°å¢å’Œ`new`)\n|`$values`|`array`|æ–°å¢æ•°æ®éœ€è¦çš„å­—æ®µ => å€¼ æ•°ç»„ä¿¡æ¯\n|`$id`|`int or string`|ä¸»é”®IDå€¼|\n|`$ids`|`array`|ä¸»é”®IDæ•°ç»„|\n|`$columns`|`array`|æŸ¥è¯¢çš„å­—æ®µä¿¡æ¯|\n\n### 3.3 é€šè¿‡`findCondition($conditions)`æŸ¥è¯¢åè½¬æ¢ä¸º`model`æŸ¥è¯¢æ–¹æ³•\n\n|æ–¹æ³•åç§°|è¿”å›å€¼|æ–¹æ³•è¯´æ˜|\n|---------------|-------------|----------|\n|`first($conditions, $columns = ['*'])`|`Illuminate\\Database\\Eloquent\\Model or null`|æŸ¥è¯¢ä¸€æ¡æ•°æ®|\n|`get($conditions, $columns = ['*'])`|`Illuminate\\Database\\Eloquent\\Collection`|æŸ¥è¯¢å¤šæ¡æ•°æ®|\n|`pluck($conditions, $column, $key = null)`|`Illuminate\\Support\\Collection`|æŸ¥è¯¢å•ä¸ªå­—æ®µä¿¡æ¯|\n|`firstOrFail($conditions)`|`Illuminate\\Database\\Eloquent\\Model`|æŸ¥è¯¢ä¸€æ¡æ•°æ®ã€æ²¡æœ‰é‚£ä¹ˆæŠ›å‡ºé”™è¯¯|\n|`count($conditions = [])`|`int`|ç»Ÿè®¡æŸ¥è¯¢|\n|`max($conditions, $column)`|`int or mixed`|æœ€å¤§å€¼æŸ¥è¯¢|\n|`min($conditions, $column)`|`int or mixed`|æœ€å°å€¼æŸ¥è¯¢|\n|`avg($conditions, $column)`|`int or mixed`|å¹³å‡å€¼æŸ¥è¯¢|\n|`sum($conditions, $column)`|`int or mixed`|æ±‚å’ŒæŸ¥è¯¢|\n|`toSql($conditions)`|`string`|è·å–æ‰§è¡Œçš„`SQL`|\n|`getBindings($conditions = [])`|`array or mixed`|è·å–æŸ¥è¯¢ç»‘å®šçš„å‚æ•°|\n|`increment($conditions, $column, $amount = 1)`|`int`|æŒ‡å®šå­—æ®µç´¯åŠ |\n|`decrement($conditions, $column, $amount = 1)`|`int`|æŒ‡å®šå­—æ®µç´¯å‡|\n\n#### å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array or string or int`|æŸ¥è¯¢æ¡ä»¶(`string or int or ç´¢å¼•æ•°ç»„[1, 2, 3, 4]`ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºä¸»é”®æŸ¥è¯¢)|\n|`$columns`|`array`|æŸ¥è¯¢çš„å­—æ®µæ•°ç»„|\n|`$column`|`string`|æŸ¥è¯¢çš„å­—æ®µåç§°|\n|`$key`|`string or null`|æŸ¥è¯¢å•ä¸ªå­—æ®µç»„æˆæ•°ç»„çš„`key`(ç´¢å¼•ä¸‹æ ‡ä½¿ç”¨å­—æ®µ)|\n\n## å›› å¢åˆ æ”¹çš„äº‹ä»¶æ–¹æ³•\n\n>å­ç±»å®šä¹‰äº†è¿™äº›æ–¹æ³•ï¼Œæ‰ä¼šæ‰§è¡Œï¼Œå¦‚æœæƒ³é˜»æ­¢ä¸»æ–¹æ³•æ‰§è¡Œï¼Œå¹¶èƒ½è®©ä¸»æ–¹æ³•è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œç›´æ¥æŠ›å‡ºé”™è¯¯å°±å¯ä»¥\n\n### 4.1 æ–°å¢çš„äº‹ä»¶ åœ¨`create($data)` æ‰§è¡Œçš„æ—¶å€™è§¦å‘\n\n1. `beforeCreate($data)` æ–°å¢ä¹‹å‰\n\n2. `afterCreate($data, $news)`  æ–°å¢ä¹‹å\n\n#### 4.1.1 å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$data`|`array`|è¿‡æ»¤æ‰å¹²æ‰°æ•°æ®(éè¡¨ä¸­å­—æ®µçš„æ•°æ®)çš„æ•°ç»„|\n|`$news`|`array`|æ–°å¢æˆåŠŸè°ƒç”¨ `model->toArray()` æ•°ç»„|\n\n### 4.2 ä¿®æ”¹çš„äº‹ä»¶ åœ¨`update($conditions, array $data)` æ‰§è¡Œçš„æ—¶å€™è§¦å‘\n\n1. `beforeUpdate($conditions, $data)` ä¿®æ”¹ä¹‹å‰\n \n2. `afterUpdate($conditions, $data, $row)` ä¿®æ”¹ä¹‹å\n\n#### 4.2.1 å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array`|å¤„ç†äº†ä¸»é”®æŸ¥è¯¢åçš„æŸ¥è¯¢æ¡ä»¶æ•°ç»„|\n|`$data`|`array`|è¿‡æ»¤æ‰å¹²æ‰°æ•°æ®(éè¡¨ä¸­å­—æ®µçš„æ•°æ®)çš„æ•°ç»„|\n|`$row`|`int`|ä¿®æ”¹å—å½±å“çš„è¡Œæ•°|\n\n### 4.3 åˆ é™¤çš„äº‹ä»¶ åœ¨`delete($conditions)` æ‰§è¡Œçš„æ—¶å€™è§¦å‘\n\n1. `beforeDelete($conditions)` åˆ é™¤ä¹‹å‰\n\n2. `afterDelete($conditions, $row)` åˆ é™¤ä¹‹å\n\n#### 4.3.1 å‚æ•°è¯´æ˜\n\n|å‚æ•°åç§°    |å‚æ•°ç±»å‹| å‚æ•°è¯´æ˜ |\n|---------------|-------------|----------|\n|`$conditions`|`array`|å¤„ç†äº†ä¸»é”®æŸ¥è¯¢åçš„æŸ¥è¯¢æ¡ä»¶æ•°ç»„|\n|`$row`       |`int`  |åˆ é™¤å—å½±å“çš„è¡Œæ•°|\n\n### 4.4 å…³äº`$conditions` å¤„ç†ä¸ºä¸»é”®æŸ¥è¯¢\n\nä¸ä¸ºç©ºçš„ å­—ç¬¦ä¸²ã€æ•´æ•°ã€æµ®ç‚¹æ•°ã€ç´¢å¼•æ•°ç»„ éƒ½ä¼šè¢«è½¬ä¸ºä¸»é”®æŸ¥è¯¢\n\n```php\n\/\/ å‡è®¾è¡¨çš„ä¸»é”®ä¸ºid\n\n$conditions = 1;            \/\/ ä¼šè¢«è½¬ä¸º ['id' => 1]\n$conditions = '1';          \/\/ ä¼šè¢«è½¬ä¸º ['id' => '1']\n$conditions = [1, 2, 3];    \/\/ ä¼šè¢«è½¬ä¸º ['id' => [1, 2, 3, 4]]\n\n\/\/ å…³è”æ•°ç»„ä¸­ï¼Œåªè¦æœ‰ä¸€ä¸ªå…ƒç´ ä¸ºç´¢å¼•ä¸‹æ ‡çš„ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯ ç´¢å¼•æ•°ç»„\n\n$conditions = ['id' => 1, 'name' => '123', '789']\n\nåŒæ ·ä¼šè¢«è®¤ä¸ºæ˜¯ç´¢å¼•æ•°ç»„ï¼Œä¼šè½¬ä¸º\n\n$conditions = ['id' => [1, '123', '789']]\n\n```\n\n## äº” å…¶ä»–è¯´æ˜\n\n### 5.1 å…³äº`repository`çš„`create`ã€`update`ã€`delete` çš„è¿”å›\n\nè¿™ä¸‰ä¸ªå‡½æ•°ä¸ç®¡å¤„ç†æˆåŠŸå’Œå¤±è´¥ï¼Œè¿”å›çš„éƒ½æ˜¯æ•°ç»„ä¿¡æ¯ã€‚å› ä¸º`php`ä¸èƒ½åƒ`golang`é‚£æ ·,\nå¯ä»¥å¤šè¿”å›ï¼Œè€Œåœ¨æˆ‘ä»¬é€»è¾‘ä¸­ï¼Œç»å¸¸éœ€è¦çŸ¥é“æ‰§è¡Œé”™è¯¯äº†ï¼Œæ˜¯ä»€ä¹ˆæ ·çš„é”™è¯¯ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œ\néƒ½æ˜¯é€šè¿‡æ•°ç»„çš„æ–¹å¼è¿”å›ï¼Œè¿™æ ·å°±è§£å†³å¤šå€¼è¿”å›é—®é¢˜ã€‚è¿™ä¹Ÿæ˜¯å—`golang`çš„å½±å“ï¼ä¸è¿‡\n`laravel`å…¶å®æ›´æ¨èæ˜¯é€šè¿‡æŠ›å‡ºé”™è¯¯æ–¹å¼ï¼Œå»ç»Ÿä¸€ç®¡ç†æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯ã€‚æ‰€ä»¥å¦‚æœä¸å–œæ¬¢\nç°åœ¨æ•°ç»„çš„è¿”å›æ–¹å¼çš„è¯ï¼Œåªéœ€è¦é‡å†™ `success($data, $message === 'ok')` \nå’Œ `error($message, $data = [])` è¿™ä¸¤ä¸ªæ–¹æ³•å°±å¥½äº†\n\n### 5.2 `repository` æŸ¥è¯¢ `find`, `findAll` æŸ¥è¯¢ç»“æœéƒ½æ˜¯ `model->toArray()` çš„æ•°ç»„ï¼Œå¹¶ä¸æ˜¯ `model` å¯¹è±¡\n\n### 5.3 å¯¹äº`model`çš„è¦æ±‚\n\n1. `create` å’Œ `update` éƒ½æ˜¯æ‰¹é‡èµ‹å€¼ï¼Œéœ€è¦`model`å®šä¹‰æ‰¹é‡èµ‹å€¼çš„ç™½åå•`$fillable` æˆ–è€… é»‘åå• `$guarded`\n2. éœ€è¦å®šä¹‰ `$columns` å­—æ®µä¿¡æ¯ï¼Œè¡¨ç¤ºè¡¨ä¸­éƒ½æœ‰å“ªäº›å­—æ®µ\n\n    ```php\n    public $columns = ['id', 'title', 'content', 'created_at', 'updated_at'];\n    ```\n    \n    >è™½ç„¶è¿™ä¸€æ­¥æ˜¯éå¿…é¡»çš„ï¼Œä½†å®šä¹‰äº†`$columns`ä¼šå‡å°‘ä¸€æ¬¡`SQL`æŸ¥è¯¢çš„ä»£ä»·\n\næ˜¯ä¸æ˜¯éå¸¸ç®€æ´æ–¹ä¾¿ ^_^ ğŸ˜‹\nåé¢ä¼šç»§ç»­è¡¥å……"
    },
    "msg": "ok"
}